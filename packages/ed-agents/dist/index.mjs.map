{"version":3,"sources":["../src/types/index.ts","../src/index.ts"],"sourcesContent":["/**\r\n * Core types for Ed Agent Framework\r\n */\r\n\r\n// ============================================================================\r\n// Domain Types\r\n// ============================================================================\r\n\r\nexport type Domain =\r\n  | 'estates'\r\n  | 'hr'\r\n  | 'send'\r\n  | 'data'\r\n  | 'curriculum'\r\n  | 'it-tech'\r\n  | 'procurement'\r\n  | 'governance'\r\n  | 'communications'\r\n  | 'general';\r\n\r\nexport type SpecialistId =\r\n  | 'estates-specialist'\r\n  | 'hr-specialist'\r\n  | 'send-specialist'\r\n  | 'data-specialist'\r\n  | 'curriculum-specialist'\r\n  | 'it-tech-specialist'\r\n  | 'procurement-specialist'\r\n  | 'governance-specialist'\r\n  | 'communications-specialist'\r\n  | 'ed-general';\r\n\r\n// ============================================================================\r\n// Confidence Levels\r\n// ============================================================================\r\n\r\nexport type ConfidenceLevel = 'HIGH' | 'MEDIUM' | 'LOW';\r\n\r\nexport interface FreshnessInfo {\r\n  lastVerified: Date;\r\n  sourceUrl?: string;\r\n  confidence: ConfidenceLevel;\r\n  nextReviewDue?: Date;\r\n}\r\n\r\n// ============================================================================\r\n// Agent Types\r\n// ============================================================================\r\n\r\nexport interface AgentDefinition {\r\n  id: SpecialistId;\r\n  name: string;\r\n  domain: Domain;\r\n  qualifications: string[];\r\n  capabilities: string[];\r\n  systemPrompt: string;\r\n}\r\n\r\nexport interface AgentResponse {\r\n  agentId: SpecialistId;\r\n  content: string;\r\n  sources?: SourceInfo[];\r\n  confidence: ConfidenceLevel;\r\n  requiresHuman?: boolean;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface SourceInfo {\r\n  name: string;\r\n  url?: string;\r\n  type: string; // 'HSE', 'DfE', 'ACAS', etc.\r\n  lastVerified?: Date;\r\n}\r\n\r\n// ============================================================================\r\n// App Context\r\n// ============================================================================\r\n\r\nexport type AppSlug =\r\n  | 'estates-compliance'\r\n  | 'hr'\r\n  | 'send'\r\n  | 'data'\r\n  | 'schoolgle-platform'\r\n  | 'unknown';\r\n\r\nexport type UserRole = 'admin' | 'staff' | 'viewer';\r\n\r\nexport type SubscriptionPlan = 'free' | 'schools' | 'trusts';\r\n\r\nexport interface SubscriptionContext {\r\n  plan: SubscriptionPlan;\r\n  features: string[];\r\n  creditsRemaining: number;\r\n  creditsUsed: number;\r\n}\r\n\r\nexport interface AppContext {\r\n  userId: string;\r\n  orgId: string;\r\n  userRole: UserRole;\r\n  subscription: SubscriptionContext;\r\n  activeApp?: AppSlug;\r\n  currentTask?: string;\r\n  schoolData?: SchoolContext;\r\n  sessionId: string;\r\n}\r\n\r\nexport interface SchoolContext {\r\n  urn: number;\r\n  name: string;\r\n  address: string[];\r\n  phone?: string;\r\n  email?: string;\r\n  typeName: string;\r\n  phaseName: string;\r\n  laCode?: number;\r\n  laName?: string;\r\n  trustName?: string;\r\n  ofstedRating?: string;\r\n  ofstedLastInspection?: Date;\r\n  imdDecile?: number;\r\n  isIndependent?: boolean;\r\n}\r\n\r\n// ============================================================================\r\n// Intent Classification\r\n// ============================================================================\r\n\r\nexport interface IntentClassification {\r\n  domain: Domain;\r\n  specialist: SpecialistId;\r\n  confidence: number;\r\n  reasoning?: string;\r\n  requiresMultiPerspective?: boolean;\r\n  isWorkRelated: boolean;\r\n}\r\n\r\n// ============================================================================\r\n// Knowledge Base\r\n// ============================================================================\r\n\r\nexport interface KnowledgeEntry {\r\n  id: string;\r\n  domain: Domain;\r\n  topic: string;\r\n  question: string;\r\n  answer: string;\r\n  sourceUrl?: string;\r\n  sourceName: string;\r\n  sourceType: string;\r\n  confidence: ConfidenceLevel;\r\n  lastVerified: Date;\r\n  nextReviewDue?: Date;\r\n  version: number;\r\n  rank?: number;\r\n}\r\n\r\nexport interface KnowledgeQueryOptions {\r\n  domain?: Domain;\r\n  confidence?: ConfidenceLevel;\r\n  limit?: number;\r\n}\r\n\r\n// ============================================================================\r\n// Perspective Types\r\n// ============================================================================\r\n\r\nexport type PerspectiveType = 'optimist' | 'critic' | 'neutral';\r\n\r\nexport interface PerspectiveResponse {\r\n  optimist: string;\r\n  critic: string;\r\n  neutral: string;\r\n}\r\n\r\n// ============================================================================\r\n// Guardrail Types\r\n// ============================================================================\r\n\r\nexport interface GuardrailResult {\r\n  passed: boolean;\r\n  response?: string;\r\n  warning?: string;\r\n  requiresHuman?: boolean;\r\n  reason?: string;\r\n  metadata?: Record<string, unknown>;\r\n}\r\n\r\nexport interface GuardrailCheck {\r\n  name: string;\r\n  check: (response: string, context: AppContext) => Promise<GuardrailResult>;\r\n}\r\n\r\n// ============================================================================\r\n// Model Types\r\n// ============================================================================\r\n\r\nexport type ModelProvider = 'anthropic' | 'openai' | 'openrouter' | 'google';\r\n\r\nexport type TaskType =\r\n  | 'intent-classification'\r\n  | 'work-focus-check'\r\n  | 'specialist-response'\r\n  | 'perspective-generation'\r\n  | 'synthesis'\r\n  | 'ui-analysis'\r\n  | 'action-planning';\r\n\r\nexport interface ModelConfig {\r\n  id: string;\r\n  provider: ModelProvider;\r\n  model: string;\r\n  costPerMillionTokens: number;\r\n  capabilities: {\r\n    vision: boolean;\r\n    streaming: boolean;\r\n    jsonMode: boolean;\r\n  };\r\n}\r\n\r\nexport interface TokenUsage {\r\n  input: number;\r\n  output: number;\r\n  total: number;\r\n  cost: number;\r\n}\r\n\r\n// ============================================================================\r\n// Ed Response Types\r\n// ============================================================================\r\n\r\nexport interface EdResponse {\r\n  response: string;\r\n  specialist: SpecialistId;\r\n  confidence: ConfidenceLevel;\r\n  sources: SourceInfo[];\r\n  requiresHuman: boolean;\r\n  perspectives?: {\r\n    optimist?: string;\r\n    critic?: string;\r\n    neutral?: string;\r\n  };\r\n  warnings?: string[];\r\n  metadata: {\r\n    domain: Domain;\r\n    tokensUsed?: TokenUsage;\r\n    cached?: boolean;\r\n    processedAt: Date;\r\n  };\r\n}\r\n\r\n// ============================================================================\r\n// Browser Automation Types\r\n// ============================================================================\r\n\r\nexport interface BrowserAction {\r\n  type: 'navigate' | 'click' | 'fill' | 'select' | 'scroll' | 'screenshot' | 'wait';\r\n  selector?: string;\r\n  value?: string;\r\n  url?: string;\r\n  timeout?: number;\r\n}\r\n\r\nexport interface BrowserAutomationResult {\r\n  success: boolean;\r\n  actionsTaken: BrowserAction[];\r\n  screenshot?: string;\r\n  error?: string;\r\n}\r\n\r\n// ============================================================================\r\n// Error Types\r\n// ============================================================================\r\n\r\nexport class EdAgentError extends Error {\r\n  constructor(\r\n    message: string,\r\n    public code: string,\r\n    public details?: Record<string, unknown>\r\n  ) {\r\n    super(message);\r\n    this.name = 'EdAgentError';\r\n  }\r\n}\r\n\r\nexport class SpecialistNotFoundError extends EdAgentError {\r\n  constructor(specialistId: string) {\r\n    super(`Specialist not found: ${specialistId}`, 'SPECIALIST_NOT_FOUND');\r\n    this.name = 'SpecialistNotFoundError';\r\n  }\r\n}\r\n\r\nexport class GuardrailFailedError extends EdAgentError {\r\n  constructor(reason: string, public result: GuardrailResult) {\r\n    super(`Guardrail failed: ${reason}`, 'GUARDRAIL_FAILED');\r\n    this.name = 'GuardrailFailedError';\r\n  }\r\n}\r\n\r\nexport class InsufficientCreditsError extends EdAgentError {\r\n  constructor(required: number, available: number) {\r\n    super(\r\n      `Insufficient credits: ${available} available, ${required} required`,\r\n      'INSUFFICIENT_CREDITS'\r\n    );\r\n    this.name = 'InsufficientCreditsError';\r\n  }\r\n}\r\n\r\nexport class KnowledgeNotFoundError extends EdAgentError {\r\n  constructor(query: string) {\r\n    super(`No knowledge found for query: ${query}`, 'KNOWLEDGE_NOT_FOUND');\r\n    this.name = 'KnowledgeNotFoundError';\r\n  }\r\n}\r\n\r\n// ============================================================================\r\n// Orchestrator Config\r\n// ============================================================================\r\n\r\nexport interface OrchestratorConfig {\r\n  supabase: any; // SupabaseClient\r\n  userId: string;\r\n  orgId: string;\r\n  userRole: UserRole;\r\n  subscription: SubscriptionContext;\r\n  schoolData?: SchoolContext;\r\n  activeApp?: AppSlug;\r\n  enableMultiPerspective?: boolean;\r\n  enableBrowserAutomation?: boolean;\r\n  debug?: boolean;\r\n}\r\n","/**\r\n * @schoolgle/ed-agents\r\n *\r\n * Agentic framework for Ed chatbot - specialist personas with qualified expertise\r\n *\r\n * @example\r\n * ```typescript\r\n * import { createOrchestrator } from '@schoolgle/ed-agents';\r\n *\r\n * const orchestrator = await createOrchestrator({\r\n *   supabase,\r\n *   userId: 'user-123',\r\n *   orgId: 'org-456',\r\n *   userRole: 'staff',\r\n *   subscription: { plan: 'schools', features: [], creditsRemaining: 10000, creditsUsed: 0 },\r\n * });\r\n *\r\n * const response = await orchestrator.processQuestion(\r\n *   'What temperature should legionella water be?'\r\n * );\r\n * ```\r\n */\r\n\r\n// Core types\r\nexport * from './types';\r\n\r\n// Agent registry and definitions\r\nexport * from './agents';\r\n\r\n// Orchestrator (main entry point)\r\nexport * from './orchestrator';\r\n\r\n// Guardrails\r\nexport * from './guardrails';\r\n\r\n// Perspectives\r\nexport * from './perspectives';\r\n\r\n// Skills\r\nexport * from './skills';\r\n\r\n// Knowledge base\r\nexport * from './knowledge-base';\r\n\r\n// Models (OpenRouter integration)\r\nexport * from './models';\r\n\r\n// Credit management\r\nexport * from './credit';\r\n\r\n// Re-export commonly used OpenRouter types for convenience\r\nexport type {\r\n  ChatMessage,\r\n  ChatOptions,\r\n  ChatResponse,\r\n  OpenRouterConfig,\r\n} from './models';\r\n\r\n// Re-export OpenRouter utilities\r\nexport {\r\n  OpenRouterClient,\r\n  OpenRouterError,\r\n  MODEL_ALIASES,\r\n  OPENROUTER_MODELS,\r\n  ModelRouter,\r\n  getModelRouter,\r\n} from './models';\r\n\r\n// Version\r\nexport const VERSION = '0.1.0';\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmRO,IAAM,eAAN,cAA2B,MAAM;AAAA,EACtC,YACE,SACO,MACA,SACP;AACA,UAAM,OAAO;AAHN;AACA;AAGP,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,0BAAN,cAAsC,aAAa;AAAA,EACxD,YAAY,cAAsB;AAChC,UAAM,yBAAyB,YAAY,IAAI,sBAAsB;AACrE,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,uBAAN,cAAmC,aAAa;AAAA,EACrD,YAAY,QAAuB,QAAyB;AAC1D,UAAM,qBAAqB,MAAM,IAAI,kBAAkB;AADtB;AAEjC,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,2BAAN,cAAuC,aAAa;AAAA,EACzD,YAAY,UAAkB,WAAmB;AAC/C;AAAA,MACE,yBAAyB,SAAS,eAAe,QAAQ;AAAA,MACzD;AAAA,IACF;AACA,SAAK,OAAO;AAAA,EACd;AACF;AAEO,IAAM,yBAAN,cAAqC,aAAa;AAAA,EACvD,YAAY,OAAe;AACzB,UAAM,iCAAiC,KAAK,IAAI,qBAAqB;AACrE,SAAK,OAAO;AAAA,EACd;AACF;;;ACtPO,IAAM,UAAU;","names":[]}