(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34702,e=>{"use strict";var t=e.i(43476),s=e.i(44747),a=e.i(18566),i=e.i(71645),r=e.i(75254);let n=(0,r.default)("layout-dashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);var o=e.i(26912),l=e.i(10980),d=e.i(56272),c=e.i(39616),m=e.i(86536),u=e.i(87951),p=e.i(55436),h=e.i(94918),g=e.i(69970),x=e.i(9556);let b={exceptional:{label:"Exceptional",color:"bg-purple-500",textColor:"text-purple-700",description:"Highest quality provision",score:5},strong_standard:{label:"Strong Standard",color:"bg-green-500",textColor:"text-green-700",description:"Above expected standards",score:4},expected_standard:{label:"Expected Standard",color:"bg-blue-500",textColor:"text-blue-700",description:"Meets all required standards",score:3},needs_attention:{label:"Needs Attention",color:"bg-yellow-500",textColor:"text-yellow-700",description:"Some aspects inconsistent or limited",score:2},urgent_improvement:{label:"Urgent Improvement",color:"bg-red-500",textColor:"text-red-700",description:"Requires immediate action",score:1},not_assessed:{label:"Not Assessed",color:"bg-gray-400",textColor:"text-gray-600",description:"Awaiting assessment",score:0}},f=[{id:"inclusion",name:"Inclusion",description:"How well the school ensures all pupils, including those with SEND and disadvantaged pupils, receive the support they need",color:"teal",guidanceSummary:"Inspectors evaluate how effectively the school identifies and supports pupils with additional needs, including those with SEND, disadvantaged pupils, and those with mental health needs. This includes the quality of the graduated approach and how well the curriculum is adapted.",guidanceLink:"https://www.gov.uk/government/publications/education-inspection-framework",subcategories:[{id:"inclusion-send",name:"SEND Provision",description:"Support for pupils with special educational needs and disabilities",evidenceRequired:[{id:"send-1",name:"SEND Policy",description:"Current SEND policy and information report"},{id:"send-2",name:"Graduated Approach",description:"Evidence of assess, plan, do, review cycle"},{id:"send-3",name:"Provision Map",description:"Mapping of interventions and support"},{id:"send-4",name:"EHCP Reviews",description:"Annual review documentation"},{id:"send-5",name:"SENCO Role",description:"Evidence of SENCO leadership and impact"}],keyIndicators:["Pupils with SEND achieve well from their starting points","Early identification of needs is effective","High-quality targeted support is in place","Staff have appropriate training for SEND","Parents are engaged as partners"],inspectionFocus:["How quickly are needs identified?","Is the graduated approach implemented effectively?","Do pupils with SEND access the full curriculum?","What is the impact of interventions?"]},{id:"inclusion-disadvantaged",name:"Disadvantaged Pupils",description:"Support and outcomes for disadvantaged pupils including those eligible for Pupil Premium",evidenceRequired:[{id:"pp-1",name:"Pupil Premium Strategy",description:"Current PP strategy statement"},{id:"pp-2",name:"PP Outcomes",description:"Progress and attainment data for PP pupils"},{id:"pp-3",name:"Intervention Impact",description:"Evidence of impact of PP spending"},{id:"pp-4",name:"Attendance Data",description:"Attendance comparison for PP pupils"}],keyIndicators:["Disadvantaged pupils achieve as well as others nationally","Gaps are closing over time","PP strategy is evidence-based (EEF)","Barriers to learning are addressed effectively"],inspectionFocus:["What are the barriers for disadvantaged pupils?","How is PP funding used to address barriers?","What is the impact on outcomes?","How are attendance gaps addressed?"]},{id:"inclusion-mental-health",name:"Mental Health & Wellbeing Support",description:"Support for pupils with mental health needs and promotion of wellbeing",evidenceRequired:[{id:"mh-1",name:"Mental Health Lead",description:"Trained senior mental health lead"},{id:"mh-2",name:"Wellbeing Curriculum",description:"How wellbeing is taught"},{id:"mh-3",name:"Support Systems",description:"Referral pathways and support available"},{id:"mh-4",name:"Staff Training",description:"Mental health awareness training"}],keyIndicators:["Pupils mental health needs are identified early","Effective support systems are in place","Staff are trained to recognise signs of mental ill health","Pupils know how to access support"],inspectionFocus:["How are mental health needs identified?","What support is available?","How is pupil wellbeing promoted?","Is there a whole-school approach?"]}]},{id:"curriculum-teaching",name:"Curriculum and Teaching",description:"The quality, breadth and ambition of the curriculum and how effectively it is taught",color:"rose",guidanceSummary:"Inspectors evaluate how well the curriculum is designed, sequenced and taught. This includes whether it is ambitious for all pupils, how well it builds knowledge over time, and the quality of pedagogy.",guidanceLink:"https://www.gov.uk/government/publications/education-inspection-framework",subcategories:[{id:"curriculum-intent",name:"Curriculum Intent",description:"The design and ambition of the curriculum",evidenceRequired:[{id:"intent-1",name:"Curriculum Overview",description:"Whole-school curriculum map"},{id:"intent-2",name:"Subject Policies",description:"Intent statements for each subject"},{id:"intent-3",name:"Progression Maps",description:"How knowledge builds over time"},{id:"intent-4",name:"Cultural Capital",description:"How curriculum builds cultural capital"}],keyIndicators:["Curriculum is ambitious for all pupils including SEND","Clear progression of knowledge and skills","National Curriculum coverage is secure","Local context is reflected appropriately"],inspectionFocus:["What is the curriculum intent?","How is the curriculum sequenced?","How does it build cultural capital?","Is it ambitious for all?"]},{id:"curriculum-implementation",name:"Teaching Quality",description:"How effectively the curriculum is taught",evidenceRequired:[{id:"teach-1",name:"Lesson Observations",description:"Recent observation evidence"},{id:"teach-2",name:"Work Scrutiny",description:"Analysis of pupil work over time"},{id:"teach-3",name:"Assessment Policy",description:"How assessment informs teaching"},{id:"teach-4",name:"CPD Records",description:"Staff development and impact"},{id:"teach-5",name:"Feedback Policy",description:"Approach to feedback"}],keyIndicators:["Teachers have strong subject knowledge","Effective pedagogical approaches are used","Assessment is used to adapt teaching","Feedback helps pupils improve","Teaching is adapted for different learners"],inspectionFocus:["How is the curriculum taught?","Do teachers have secure subject knowledge?","How is assessment used?","Is teaching adapted for all learners?"]},{id:"curriculum-reading",name:"Reading and Literacy",description:"The teaching of reading including phonics",evidenceRequired:[{id:"read-1",name:"Phonics Programme",description:"DfE validated SSP programme"},{id:"read-2",name:"Reading Curriculum",description:"Approach to reading across school"},{id:"read-3",name:"Book Matching",description:"How books are matched to phonics stage"},{id:"read-4",name:"Intervention Data",description:"Keep-up/catch-up intervention impact"},{id:"read-5",name:"Phonics Results",description:"Phonics screening check outcomes"}],keyIndicators:["Validated SSP programme implemented with fidelity","Books are matched to pupils phonics knowledge","Rapid intervention for those falling behind","Reading for pleasure is promoted","Strong phonics outcomes"],inspectionFocus:["What phonics programme is used?","Are books decodable and matched?","How quickly are struggling readers supported?","Do pupils read fluently and with comprehension?"]}]},{id:"achievement",name:"Achievement",description:"The outcomes pupils achieve and the progress they make",color:"blue",guidanceSummary:"Inspectors evaluate the outcomes pupils achieve, including national test and examination results, and the progress pupils make from their starting points. This includes outcomes for different groups of pupils.",guidanceLink:"https://www.gov.uk/government/publications/education-inspection-framework",subcategories:[{id:"achievement-outcomes",name:"Academic Outcomes",description:"Attainment and progress in national assessments",evidenceRequired:[{id:"out-1",name:"KS2 Results",description:"End of KS2 outcomes and progress"},{id:"out-2",name:"Phonics Results",description:"Year 1 phonics screening outcomes"},{id:"out-3",name:"EYFS Outcomes",description:"GLD and prime area data"},{id:"out-4",name:"Progress Data",description:"In-year progress tracking"},{id:"out-5",name:"Group Analysis",description:"Outcomes by pupil group"}],keyIndicators:["Outcomes are at least in line with national","Progress is strong from starting points","All groups achieve well","Outcomes are improving over time"],inspectionFocus:["What are the outcomes in national tests?","How do outcomes compare to national?","Are all groups achieving well?","What is the trend over time?"]},{id:"achievement-progress",name:"Progress from Starting Points",description:"How well pupils progress relative to their starting points",evidenceRequired:[{id:"prog-1",name:"Baseline Data",description:"Starting point assessments"},{id:"prog-2",name:"Progress Measures",description:"How progress is tracked"},{id:"prog-3",name:"Value Added",description:"Progress scores where available"},{id:"prog-4",name:"Cohort Analysis",description:"Tracking cohorts over time"}],keyIndicators:["Pupils make strong progress from their starting points","Progress is consistent across the curriculum","Lower attainers catch up","Higher attainers are stretched"],inspectionFocus:["What progress do pupils make?","Is progress consistent across subjects?","Do all groups make expected progress?","How is progress measured?"]},{id:"achievement-destinations",name:"Preparation for Next Stage",description:"How well pupils are prepared for the next stage of education",evidenceRequired:[{id:"dest-1",name:"Transition Data",description:"Outcomes at transition points"},{id:"dest-2",name:"Secondary Ready",description:"Preparation for secondary school"},{id:"dest-3",name:"Careers Guidance",description:"Where applicable"}],keyIndicators:["Pupils are well-prepared for next stage","Transition arrangements are effective","Academic and personal readiness"],inspectionFocus:["Are pupils ready for secondary school?","What transition support is provided?","Do pupils have appropriate skills and knowledge?"]}]},{id:"attendance-behaviour",name:"Attendance and Behaviour",description:"Pupils attendance, behaviour, attitudes to learning and conduct",color:"orange",guidanceSummary:"Inspectors evaluate attendance levels including persistent absence, the effectiveness of strategies to improve attendance, behaviour in lessons and around school, and pupils attitudes to learning.",guidanceLink:"https://www.gov.uk/government/publications/education-inspection-framework",subcategories:[{id:"attendance-overall",name:"Attendance",description:"Overall attendance and persistent absence rates",evidenceRequired:[{id:"att-1",name:"Attendance Data",description:"Current attendance rates"},{id:"att-2",name:"PA Data",description:"Persistent absence rates and trends"},{id:"att-3",name:"Attendance Policy",description:"School attendance policy"},{id:"att-4",name:"Intervention Evidence",description:"Impact of attendance strategies"},{id:"att-5",name:"Group Breakdown",description:"Attendance by pupil group"}],keyIndicators:["Attendance is at least in line with national (96%+)","Persistent absence is reducing","Same-day response to absence","Gaps for disadvantaged are closing","Strong attendance culture"],inspectionFocus:["What is overall attendance?","What is the PA rate?","How quickly does the school respond to absence?","Are there gaps between groups?"]},{id:"behaviour-conduct",name:"Behaviour and Conduct",description:"Behaviour in lessons and around school",evidenceRequired:[{id:"beh-1",name:"Behaviour Policy",description:"Behaviour and relationships policy"},{id:"beh-2",name:"Exclusion Data",description:"Fixed term and permanent exclusions"},{id:"beh-3",name:"Behaviour Logs",description:"Incident recording and trends"},{id:"beh-4",name:"Restorative Approaches",description:"How relationships are repaired"}],keyIndicators:["High expectations consistently applied","Behaviour is at least good","Low-level disruption is rare","Exclusions are low and reducing","Bullying is rare and dealt with effectively"],inspectionFocus:["What is behaviour like in lessons?","How is behaviour managed?","Are expectations consistently applied?","What is the exclusion rate?"]},{id:"behaviour-attitudes",name:"Attitudes to Learning",description:"Pupils engagement and attitudes in lessons",evidenceRequired:[{id:"atl-1",name:"Pupil Voice",description:"What pupils say about learning"},{id:"atl-2",name:"Lesson Observations",description:"Evidence of engagement"},{id:"atl-3",name:"Work Scrutiny",description:"Evidence of effort and pride"}],keyIndicators:["Pupils are engaged and focused","Positive attitudes to learning","Pupils take pride in their work","Resilience when facing challenges"],inspectionFocus:["Are pupils engaged in lessons?","Do pupils want to succeed?","How do pupils respond to challenge?"]}]},{id:"personal-development",name:"Personal Development and Well-being",description:"The broader development of pupils as individuals and citizens",color:"violet",guidanceSummary:"Inspectors evaluate how well the school develops pupils character, resilience, confidence and independence. This includes PSHE, RSE, British Values, and enrichment opportunities.",guidanceLink:"https://www.gov.uk/government/publications/education-inspection-framework",subcategories:[{id:"pd-character",name:"Character and Resilience",description:"Development of character, confidence and resilience",evidenceRequired:[{id:"char-1",name:"Character Education",description:"How character is developed"},{id:"char-2",name:"PSHE Curriculum",description:"Personal development curriculum"},{id:"char-3",name:"Pupil Leadership",description:"Opportunities for leadership"}],keyIndicators:["Character is explicitly developed","Pupils show resilience","Confidence is built","Pupils can self-regulate"],inspectionFocus:["How is character developed?","Do pupils show resilience?","Are pupils confident?"]},{id:"pd-citizenship",name:"Citizenship and British Values",description:"Preparation for life in modern Britain",evidenceRequired:[{id:"bv-1",name:"British Values Mapping",description:"How BV are taught"},{id:"bv-2",name:"Democracy",description:"Understanding of democracy"},{id:"bv-3",name:"Rule of Law",description:"Understanding of rules and laws"},{id:"bv-4",name:"Tolerance",description:"Respect for diversity"}],keyIndicators:["British Values are embedded","Pupils understand democracy","Respect for diversity","Prepared for life in modern Britain"],inspectionFocus:["How are British Values taught?","Do pupils understand diversity?","Are pupils prepared for modern Britain?"]},{id:"pd-enrichment",name:"Enrichment and Wider Opportunities",description:"Extra-curricular and enrichment provision",evidenceRequired:[{id:"enrich-1",name:"Enrichment Offer",description:"Clubs, trips, experiences"},{id:"enrich-2",name:"Participation Data",description:"Who accesses enrichment"},{id:"enrich-3",name:"Cultural Capital",description:"Experiences offered"}],keyIndicators:["Rich enrichment offer","All pupils can access","Builds cultural capital","Develops talents and interests"],inspectionFocus:["What enrichment is offered?","Do all pupils access it?","How does it build cultural capital?"]},{id:"pd-rse",name:"RSE and Health Education",description:"Relationships, sex and health education",evidenceRequired:[{id:"rse-1",name:"RSE Policy",description:"Current RSE policy"},{id:"rse-2",name:"RSE Curriculum",description:"Coverage and progression"},{id:"rse-3",name:"Parent Consultation",description:"Evidence of consultation"}],keyIndicators:["Statutory RSE is delivered","Age-appropriate content","Parents consulted","Pupils understand healthy relationships"],inspectionFocus:["Is RSE delivered effectively?","Is content age-appropriate?","Have parents been consulted?"]}]},{id:"leadership-governance",name:"Leadership and Governance",description:"The effectiveness of leadership at all levels including governance",color:"gray",guidanceSummary:"Inspectors evaluate how effectively leaders and governors ensure the school provides a high quality education, how they develop staff, manage workload and wellbeing, and engage with parents and the community.",guidanceLink:"https://www.gov.uk/government/publications/education-inspection-framework",subcategories:[{id:"leadership-vision",name:"Vision and Strategy",description:"Clarity and ambition of school vision",evidenceRequired:[{id:"vis-1",name:"Vision Statement",description:"School vision and values"},{id:"vis-2",name:"School Development Plan",description:"Strategic improvement priorities"},{id:"vis-3",name:"Self-Evaluation",description:"Accurate self-knowledge"}],keyIndicators:["Clear and ambitious vision","Staff understand and share the vision","Accurate self-evaluation","Strategic priorities are right"],inspectionFocus:["What is the school vision?","Is self-evaluation accurate?","Are priorities appropriate?"]},{id:"leadership-governance",name:"Governance",description:"Effectiveness of governance and oversight",evidenceRequired:[{id:"gov-1",name:"Governor Minutes",description:"Evidence of support and challenge"},{id:"gov-2",name:"Governor Training",description:"Training and development"},{id:"gov-3",name:"Monitoring Visits",description:"Governor monitoring activity"}],keyIndicators:["Governors know the school well","Effective support and challenge","Hold leaders to account","Statutory duties fulfilled"],inspectionFocus:["How do governors know the school?","Do governors challenge effectively?","Are statutory duties met?"]},{id:"leadership-staff",name:"Staff Development and Wellbeing",description:"How leaders develop staff and manage workload",evidenceRequired:[{id:"staff-1",name:"CPD Programme",description:"Staff development offer"},{id:"staff-2",name:"Workload Policy",description:"How workload is managed"},{id:"staff-3",name:"Staff Voice",description:"What staff say"}],keyIndicators:["Effective professional development","Workload is manageable","Staff wellbeing prioritised","High staff morale"],inspectionFocus:["How is CPD quality assured?","Is workload reasonable?","How is staff wellbeing supported?"]},{id:"leadership-engagement",name:"Parent and Community Engagement",description:"Relationships with parents and the wider community",evidenceRequired:[{id:"parent-1",name:"Parent Survey",description:"Parent views and feedback"},{id:"parent-2",name:"Communication",description:"How parents are kept informed"},{id:"parent-3",name:"Complaints",description:"Complaints handling"}],keyIndicators:["Strong parent partnerships","Effective communication","Parents engaged in learning","Complaints handled well"],inspectionFocus:["What do parents think?","How are parents engaged?","Is communication effective?"]}]}];function y(e,t){let s=f.find(t=>t.id===e);if(!s)return{userScore:0,aiScore:0};let a=0,i=0;for(let e of s.subcategories){let s=t[e.id];if(s?.schoolRating&&"not_assessed"!==s.schoolRating){i++;let e=b[s.schoolRating];a+=20*(e?.score||0)}}return{userScore:i>0?Math.round(a/i):0,aiScore:0}}var v=e.i(64659),j=e.i(78894),w=e.i(69638),N=e.i(78583),k=e.i(16715),S=e.i(7233);let C=(0,r.default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]),P=(0,r.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);var E=e.i(84614);let A=(0,r.default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var R=e.i(25652),D=e.i(55711);let T=(0,r.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),I=(0,r.default)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var $=e.i(37727);let M=(0,r.default)("graduation-cap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);var q=e.i(83086);let L=(0,r.default)("text-align-start",[["path",{d:"M21 5H3",key:"1fi0y6"}],["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 19H3",key:"z6ezky"}]]);var z=e.i(3116);let F=(0,r.default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);var O=e.i(86311);let H={rose:"bg-white border-rose-200 text-rose-700",teal:"bg-white border-teal-200 text-teal-700",orange:"bg-white border-orange-200 text-orange-700",violet:"bg-white border-violet-200 text-violet-700",blue:"bg-white border-blue-200 text-blue-700",gray:"bg-white border-gray-200 text-gray-700"};function _({isOpen:e,onClose:s,onSave:a,categoryName:r,subCategoryName:n,evidenceItem:o,initialData:l}){let d,[c,m]=(0,i.useState)(""),[u,p]=(0,i.useState)(""),[h,g]=(0,i.useState)(""),[x,b]=(0,i.useState)(""),[y,v]=(0,i.useState)(""),[j,N]=(0,i.useState)("medium"),[k,S]=(0,i.useState)("open"),[C,R]=(0,i.useState)([]),[D,T]=(0,i.useState)("");return((0,i.useEffect)(()=>{e&&(l?(m(l.description),p(l.rationale||""),g(l.assignee||""),b(l.startDate||""),v(l.dueDate||""),N(l.priority),S(l.status),R(l.notes||[])):(m(o?`Address gap: ${o}`:""),p(""),g(""),b(new Date().toISOString().split("T")[0]),v(""),N("medium"),S("open"),R([])),T(""))},[e,l,o]),e)?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col animate-in fade-in zoom-in duration-200",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:l?"Update Action":"Create New Action"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[r&&(0,t.jsx)("span",{className:`text-xs px-2 py-0.5 rounded border font-bold ${(d=f.find(e=>e.name===r),H[d?.color||"gray"]||H.gray)}`,children:r}),(0,t.jsxs)("span",{className:"text-sm text-gray-500 flex items-center gap-1",children:[(0,t.jsx)("span",{className:"text-gray-300",children:"/"})," ",n]})]})]}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 p-1 rounded-full hover:bg-gray-200 transition-colors",children:(0,t.jsx)($.X,{size:20})})]}),(0,t.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,t.jsxs)("form",{id:"action-form",onSubmit:e=>{e.preventDefault();let t=[...C];D.trim()&&t.push({id:crypto.randomUUID(),userId:"current-user",userName:"You",message:D,timestamp:new Date,type:"user_note"});let s={id:l?.id||crypto.randomUUID(),description:c,rationale:u,assignee:h,startDate:x,dueDate:y,priority:j,status:k,category:r||l?.category,createdAt:l?.createdAt||new Date().toISOString(),updatedAt:new Date().toISOString(),notes:t};a(s)},className:"space-y-8",children:[(0,t.jsx)("div",{className:"bg-blue-50/50 p-4 rounded-xl border border-blue-100",children:(0,t.jsxs)("div",{className:"flex flex-col md:flex-row gap-6",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-2 flex items-center gap-1",children:[(0,t.jsx)(w.CheckCircle,{size:16,className:"text-blue-600"})," Current Status"]}),(0,t.jsx)("div",{className:"flex gap-2",children:["open","in_progress","completed"].map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>S(e),className:`flex-1 px-3 py-2 rounded-lg text-sm font-medium border transition-all capitalize ${k===e?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:e.replace("_"," ")},e))})]}),(0,t.jsxs)("div",{className:"w-full md:w-1/3",children:[(0,t.jsxs)("label",{className:"block text-sm font-bold text-gray-700 mb-2 flex items-center gap-1",children:[(0,t.jsx)(A,{size:16,className:"text-amber-600"})," Priority"]}),(0,t.jsxs)("select",{value:j,onChange:e=>N(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm bg-white h-[38px]",children:[(0,t.jsx)("option",{value:"high",children:"High Priority"}),(0,t.jsx)("option",{value:"medium",children:"Medium Priority"}),(0,t.jsx)("option",{value:"low",children:"Low Priority"})]})]})]})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-bold text-gray-800 mb-2 flex items-center gap-2",children:[(0,t.jsx)(O.MessageSquare,{size:16,className:"text-purple-600"}),"Progress Update / Notes",(0,t.jsx)("span",{className:"text-xs font-normal text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full",children:"Required for updates"})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("textarea",{value:D,onChange:e=>T(e.target.value),placeholder:"What's the latest progress on this action? Add your update here...",className:"w-full p-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-purple-500 outline-none min-h-[100px] shadow-sm"}),C.length>0&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3 max-h-40 overflow-y-auto space-y-3 border border-gray-200",children:[(0,t.jsx)("h4",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2",children:"History"}),C.map(e=>(0,t.jsxs)("div",{className:"text-sm bg-white p-3 rounded border border-gray-200 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mb-1",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.userName}),(0,t.jsxs)("span",{children:[new Date(e.timestamp).toLocaleDateString()," ",new Date(e.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]}),(0,t.jsx)("p",{className:"text-gray-700",children:e.message})]},e.id))]})]})]}),(0,t.jsxs)("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Action Description"}),(0,t.jsx)("input",{type:"text",required:!0,value:c,onChange:e=>m(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-medium",placeholder:"What needs to be done?"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[(0,t.jsx)(L,{size:14})," Rationale / Context"]}),(0,t.jsx)("textarea",{value:u,onChange:e=>p(e.target.value),rows:2,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none resize-none text-sm text-gray-600",placeholder:"Why is this action needed?"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4 border-t border-gray-100",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[(0,t.jsx)(E.User,{size:14})," Assignee"]}),(0,t.jsx)("input",{type:"text",value:h,onChange:e=>g(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm",placeholder:"e.g. John Smith"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[(0,t.jsx)(P,{size:14})," Start Date"]}),(0,t.jsx)("input",{type:"date",value:x,onChange:e=>b(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[(0,t.jsx)(z.Clock,{size:14})," Due Date"]}),(0,t.jsx)("input",{type:"date",value:y,onChange:e=>v(e.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none text-sm"})]})]})]})}),(0,t.jsxs)("div",{className:"px-6 py-4 border-t border-gray-100 bg-gray-50 flex justify-end gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 hover:text-gray-900 transition-colors",children:"Cancel"}),(0,t.jsxs)("button",{type:"submit",form:"action-form",className:"px-6 py-2 bg-blue-600 text-white text-sm font-bold rounded-lg hover:bg-blue-700 shadow-sm transition-all flex items-center gap-2",children:[(0,t.jsx)(F,{size:16}),"Save & Update"]})]})]})}):null}let U=(0,r.default)("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);function B({isOpen:e,onClose:s,categoryName:a,subcategoryName:i,evidenceItem:r,matches:n}){return e?(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 backdrop-blur-sm animate-in fade-in duration-200",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[85vh] flex flex-col animate-in zoom-in-95 duration-200",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-100 flex justify-between items-start bg-gray-50/50 rounded-t-xl",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 mb-1",children:[(0,t.jsx)("span",{children:a}),(0,t.jsx)("span",{children:"â€¢"}),(0,t.jsx)("span",{children:i})]}),(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[(0,t.jsx)(N.FileText,{className:"text-blue-600",size:24}),"Evidence Details"]}),(0,t.jsxs)("p",{className:"text-gray-600 mt-1 font-medium",children:['"',r,'"']})]}),(0,t.jsx)("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 p-2 rounded-full transition-colors",children:(0,t.jsx)($.X,{size:20})})]}),(0,t.jsx)("div",{className:"p-6 overflow-y-auto custom-scrollbar",children:0===n.length?(0,t.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[(0,t.jsx)(A,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,t.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"No Evidence Found Yet"}),(0,t.jsx)("p",{className:"text-gray-500 mt-1 max-w-sm mx-auto",children:"The AI scanner hasn't found any documents that strongly match this requirement. Try scanning more folders or uploading relevant documents."})]}):(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-900",children:["Found ",n.length," Document",1!==n.length?"s":""]}),(0,t.jsx)("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:"Sorted by relevance"})]}),n.map((e,s)=>{var a;return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-all shadow-sm hover:shadow-md bg-white",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"p-2 bg-blue-50 rounded-lg text-blue-600 mt-1",children:(0,t.jsx)(N.FileText,{size:20})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold text-gray-900 text-lg hover:text-blue-600 transition-colors",children:e.documentLink?(0,t.jsxs)("a",{href:e.documentLink,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2",children:[e.documentName,(0,t.jsx)(I,{size:14})]}):e.documentName}),e.folderPath&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-gray-500 mt-1",children:[(0,t.jsx)(U,{size:12}),(0,t.jsx)("span",{className:"truncate max-w-md",title:e.folderPath,children:e.folderPath})]})]})]}),(0,t.jsxs)("div",{className:`px-3 py-1 rounded-full text-xs font-bold border ${(a=e.confidence)>=.8?"text-green-600 bg-green-50 border-green-200":a>=.6?"text-blue-600 bg-blue-50 border-blue-200":"text-amber-600 bg-amber-50 border-amber-200"}`,children:[Math.round(100*e.confidence),"% Match"]})]}),(0,t.jsxs)("div",{className:"ml-12 space-y-3",children:[(0,t.jsxs)("div",{className:"bg-gray-50 p-3 rounded-md text-sm text-gray-700 border border-gray-100",children:[(0,t.jsx)("span",{className:"font-semibold text-gray-900 block mb-1",children:"Why it matches:"}),e.relevanceExplanation]}),e.keyQuotes&&e.keyQuotes.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wider mb-2 block",children:"Key Excerpts"}),(0,t.jsx)("div",{className:"space-y-2",children:e.keyQuotes.map((e,s)=>(0,t.jsxs)("div",{className:"flex gap-2 text-sm text-gray-600 italic bg-yellow-50/50 p-2 rounded border-l-2 border-yellow-300",children:[(0,t.jsx)("span",{className:"text-yellow-400 font-serif text-lg leading-none",children:'"'}),e,(0,t.jsx)("span",{className:"text-yellow-400 font-serif text-lg leading-none",children:'"'})]},s))})]})]})]},s)})]})}),(0,t.jsx)("div",{className:"p-4 border-t border-gray-100 bg-gray-50 rounded-b-xl flex justify-end",children:(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 bg-white border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 font-medium transition-colors shadow-sm",children:"Close"})})]})}):null}let W=(0,r.default)("circle-check",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var G=e.i(20278),V=e.i(41240),Y=e.i(91741);let Q=(0,r.default)("thumbs-up",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]]),K=(0,r.default)("thumbs-down",[["path",{d:"M17 14V2",key:"8ymqnk"}],["path",{d:"M9 18.12 10 14H4.17a2 2 0 0 1-1.92-2.56l2.33-8A2 2 0 0 1 6.5 2H20a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2h-2.76a2 2 0 0 0-1.79 1.11L12 22a3.13 3.13 0 0 1-3-3.88Z",key:"m61m77"}]]),J=(0,r.default)("pen-line",[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);var X=e.i(72520);let Z=[{id:"feedback",name:"Feedback",monthsProgress:6,costRating:1,evidenceStrength:5,category:"teaching",description:"Providing information to learners about their performance relative to learning goals, helping redirect actions to achieve the goal.",implementationTips:["Focus on task, not the student personally","Be specific about what was done well and what needs improvement","Ensure students have time to act on feedback","Train students to give peer feedback effectively"],commonMistakes:["Feedback given too late to be actionable","Too much focus on grades, not improvement","Students not given time to respond to feedback","Feedback not linked to success criteria"],ofstedLinks:["Quality of Education","Assessment"],keywords:["marking","assessment","feedback","progress","improvement"]},{id:"metacognition",name:"Metacognition and Self-Regulation",monthsProgress:7,costRating:1,evidenceStrength:5,category:"teaching",description:"Teaching pupils specific strategies to set goals, monitor and evaluate their own learning.",implementationTips:["Explicitly teach planning, monitoring, and evaluation strategies","Model your own thinking processes aloud","Provide structured opportunities for self-assessment","Use graphic organisers to support planning"],commonMistakes:["Assuming students will develop these skills naturally","Not modelling the thinking process explicitly","Focusing only on content, not learning strategies","Not giving time for reflection"],ofstedLinks:["Quality of Education","Personal Development"],keywords:["thinking","reflection","self-assessment","planning","evaluation","independence"]},{id:"reading-comprehension",name:"Reading Comprehension Strategies",monthsProgress:6,costRating:1,evidenceStrength:5,category:"teaching",description:"Teaching specific techniques to help students understand what they read, including inference, summarisation, and questioning.",implementationTips:["Use reciprocal reading with clear roles","Teach inference explicitly with think-alouds","Connect reading to prior knowledge","Use graphic organisers for text structure"],commonMistakes:["Moving on before comprehension is secured","Not teaching vocabulary alongside comprehension","Over-reliance on comprehension worksheets","Not modelling skilled reading behaviours"],ofstedLinks:["Quality of Education","Reading"],keywords:["reading","comprehension","inference","vocabulary","phonics","literacy"]},{id:"collaborative-learning",name:"Collaborative Learning",monthsProgress:5,costRating:1,evidenceStrength:5,category:"teaching",description:"Students working together on activities or learning tasks in a group small enough for everyone to participate.",implementationTips:["Structure tasks so collaboration is necessary","Assign clear roles within groups","Train students in collaboration skills","Mix ability groups for some tasks"],commonMistakes:["Groups too large (optimal is 3-4)","No individual accountability","One student does all the work","Task could be done individually"],ofstedLinks:["Quality of Education","Behaviour and Attitudes"],keywords:["group work","collaboration","teamwork","discussion","talk"]},{id:"oral-language",name:"Oral Language Interventions",monthsProgress:6,costRating:1,evidenceStrength:5,category:"targeted",description:"Approaches that emphasise the importance of spoken language and verbal interaction in the classroom.",implementationTips:["Create talk-rich classrooms","Explicitly teach academic vocabulary","Use structured talk activities (e.g., think-pair-share)","Target early years and disadvantaged pupils"],commonMistakes:["Not allowing enough talk time","Accepting one-word answers","Not scaffolding academic language","Talking at students, not with them"],ofstedLinks:["Quality of Education","Early Years","SEND"],keywords:["speaking","listening","vocabulary","oracy","communication","language","EYFS"]},{id:"mastery-learning",name:"Mastery Learning",monthsProgress:5,costRating:1,evidenceStrength:4,category:"teaching",description:"Breaking subject matter into units with clear objectives, students must demonstrate mastery before moving on.",implementationTips:["Define clear success criteria for each unit","Provide immediate corrective feedback","Allow time for re-teaching and practice","Use diagnostic assessments"],commonMistakes:["Moving on before mastery achieved","Not providing enough practice time","Assessment not matched to objectives","One-size-fits-all pacing"],ofstedLinks:["Quality of Education","Assessment"],keywords:["mastery","maths","White Rose","fluency","practice","assessment"]},{id:"small-group-tuition",name:"Small Group Tuition",monthsProgress:4,costRating:3,evidenceStrength:4,category:"targeted",description:"A teacher or professional educator working with two to five pupils together in a group.",implementationTips:["Keep groups to 3-5 students maximum","Target specific gaps in knowledge","Use qualified teachers where possible","Link to classroom learning"],commonMistakes:["Groups too large to be effective","Intervention not linked to class curriculum","Using untrained staff","Same students always withdrawn"],ofstedLinks:["Quality of Education","SEND","Pupil Premium"],keywords:["intervention","small group","catch-up","PP","disadvantaged","tuition"]},{id:"one-to-one-tuition",name:"One to One Tuition",monthsProgress:5,costRating:5,evidenceStrength:4,category:"targeted",description:"Intensive individual support for struggling learners.",implementationTips:["Target specific learning needs","Use trained tutors","Short, focused sessions (30-45 mins)","Connect to classroom curriculum"],commonMistakes:["Sessions too long or unfocused","Not addressing root cause of difficulty","Tutor not connected to class teacher","Over-reliance on withdrawal from class"],ofstedLinks:["Quality of Education","SEND","Pupil Premium"],keywords:["1:1","tutor","intervention","SEND","EHC","individual"]},{id:"peer-tutoring",name:"Peer Tutoring",monthsProgress:5,costRating:1,evidenceStrength:5,category:"teaching",description:"Learners working in pairs or small groups to provide each other with explicit teaching support.",implementationTips:["Train both tutors and tutees","Provide structured materials","Cross-age tutoring can be effective","Monitor and support pairs regularly"],commonMistakes:["No training for peer tutors","Unstructured pairing time","Always same students tutoring","Not monitoring interactions"],ofstedLinks:["Quality of Education","Personal Development"],keywords:["peer","paired","buddy","mentoring","tutoring"]},{id:"homework",name:"Homework",monthsProgress:5,costRating:1,evidenceStrength:4,category:"teaching",description:"Tasks given to pupils by teachers to complete outside of usual lessons.",implementationTips:["Secondary: link to learning, not busy work","Primary: keep short, focus on reading","Provide feedback on homework","Consider homework clubs for disadvantaged"],commonMistakes:["Homework for homeworks sake","Too much homework in primary","No feedback given","Widens disadvantage gap"],ofstedLinks:["Quality of Education","Pupil Premium"],keywords:["homework","home learning","independent","practice"]},{id:"phonics",name:"Phonics",monthsProgress:5,costRating:1,evidenceStrength:5,category:"teaching",description:"Systematic teaching of the relationship between sounds and spelling patterns.",implementationTips:["Use a validated systematic synthetic phonics programme","Daily, focused sessions","Match books to phonics stage","Rapid intervention for those falling behind"],commonMistakes:["Not following programme with fidelity","Books not matched to phonics knowledge","Mixed methods confusing children","Slow pace for struggling readers"],ofstedLinks:["Quality of Education","Reading","Early Years"],keywords:["phonics","reading","decoding","Little Wandle","RWI","sounds"]},{id:"teaching-assistants",name:"Teaching Assistant Interventions",monthsProgress:4,costRating:3,evidenceStrength:4,category:"targeted",description:"Using TAs to deliver structured interventions to individuals or small groups.",implementationTips:["Train TAs in specific interventions","Link interventions to class learning","TAs should supplement, not replace teacher input","Regular liaison between teacher and TA"],commonMistakes:["TAs always work with lowest attainers","No training on interventions","TA work not connected to lessons","Over-scaffolding reducing independence"],ofstedLinks:["Quality of Education","SEND","Leadership"],keywords:["TA","teaching assistant","LSA","support","intervention"]},{id:"behaviour-interventions",name:"Behaviour Interventions",monthsProgress:4,costRating:3,evidenceStrength:4,category:"wider",description:"Approaches to reduce challenging behaviour and support positive engagement.",implementationTips:["Focus on prevention, not just response","Teach social and emotional skills explicitly","Consistent whole-school approach","Address underlying causes"],commonMistakes:["Reactive rather than proactive","Inconsistent application of policy","Not addressing root causes","Over-reliance on exclusion"],ofstedLinks:["Behaviour and Attitudes","Personal Development","SEND"],keywords:["behaviour","SEMH","exclusion","suspension","attitude","engagement"]},{id:"social-emotional-learning",name:"Social and Emotional Learning",monthsProgress:4,costRating:1,evidenceStrength:4,category:"wider",description:"Interventions targeting social and emotional learning, including self-awareness and relationship skills.",implementationTips:["Embed in whole-school culture","Explicit teaching of SEL skills","Staff training and modelling","Target universal and targeted approaches"],commonMistakes:["Bolt-on PSHE lessons only","Not modelled by adults","No whole-school approach","Ignoring the classroom environment"],ofstedLinks:["Personal Development","Behaviour and Attitudes","Safeguarding"],keywords:["PSHE","wellbeing","mental health","resilience","relationships","character"]},{id:"parental-engagement",name:"Parental Engagement",monthsProgress:4,costRating:2,evidenceStrength:4,category:"wider",description:"Strategies to improve parental involvement in their childrens learning.",implementationTips:["Focus on learning activities, not just communication","Train parents in how to support at home","Target hard-to-reach families","Regular, accessible communication"],commonMistakes:["One-way communication only","Not reaching disadvantaged families","Parents unsure how to help","Homework battles at home"],ofstedLinks:["Quality of Education","Personal Development","Pupil Premium"],keywords:["parents","carers","engagement","communication","home learning"]},{id:"early-years-intervention",name:"Early Years Intervention",monthsProgress:6,costRating:4,evidenceStrength:5,category:"targeted",description:"Approaches that focus on improving outcomes for children in the early years (3-5).",implementationTips:["Focus on communication and language","High-quality adult-child interactions","Rich learning environment","Target vocabulary gaps early"],commonMistakes:["Over-formal too early","Not enough talk and interaction","Missing early signs of difficulty","Poor transition to Year 1"],ofstedLinks:["Early Years","SEND","Pupil Premium"],keywords:["EYFS","reception","nursery","early years","communication","language"]},{id:"extending-school-time",name:"Extending School Time",monthsProgress:3,costRating:3,evidenceStrength:3,category:"wider",description:"Additional time spent in school, including before/after school programmes, summer schools, and extended days.",implementationTips:["Target those who need it most","High-quality provision, not just supervision","Focus on academic and enrichment","Consider breakfast clubs for attendance"],commonMistakes:["More time but same quality teaching","Not targeted at disadvantaged","Just childcare, not learning","Staff burnout"],ofstedLinks:["Quality of Education","Personal Development","Pupil Premium"],keywords:["after school","breakfast club","holiday","extended","enrichment"]},{id:"arts-participation",name:"Arts Participation",monthsProgress:3,costRating:2,evidenceStrength:3,category:"wider",description:"Participation in artistic and creative activities.",implementationTips:["Link arts to academic outcomes","Ensure quality instruction","Target disadvantaged pupils","Connect to cultural capital"],commonMistakes:["Arts squeezed out of curriculum","Only for the talented","Not linked to wider learning","Poor quality provision"],ofstedLinks:["Personal Development","Cultural Capital"],keywords:["art","music","drama","creative","cultural capital","enrichment"]},{id:"sports-participation",name:"Sports Participation",monthsProgress:2,costRating:2,evidenceStrength:3,category:"wider",description:"Participation in sports and physical activity programmes.",implementationTips:["Focus on engagement, not just competition","Target inactive pupils","Link to health and wellbeing","Use PE premium effectively"],commonMistakes:["Only competitive sports","Same pupils always picked","Not reaching inactive children","PE premium not evidenced"],ofstedLinks:["Personal Development","Physical Development"],keywords:["PE","sport","physical","health","active","PE premium"]},{id:"digital-technology",name:"Digital Technology",monthsProgress:4,costRating:4,evidenceStrength:4,category:"teaching",description:"Using technology to support and enhance teaching and learning.",implementationTips:["Technology should support pedagogy, not replace it","Train teachers effectively","Consider access for disadvantaged","Use for feedback and assessment"],commonMistakes:["Tech for techs sake","Replacing, not supporting teaching","Digital divide for disadvantaged","Poor staff confidence"],ofstedLinks:["Quality of Education","Pupil Premium"],keywords:["technology","digital","iPad","computer","online","software"]},{id:"reducing-class-size",name:"Reducing Class Size",monthsProgress:2,costRating:5,evidenceStrength:3,category:"teaching",description:"Reducing the number of pupils in a teaching group.",implementationTips:["Only effective if teaching changes","Very expensive for limited gain","Consider targeted small groups instead","Focus on quality, not just quantity"],commonMistakes:["Smaller classes but same teaching","Very high cost, low impact","Resources better spent elsewhere","Assuming smaller = better"],ofstedLinks:["Quality of Education"],keywords:["class size","pupil ratio","teacher ratio"]},{id:"setting-streaming",name:"Setting and Streaming",monthsProgress:-1,costRating:1,evidenceStrength:4,category:"teaching",description:"Grouping pupils by ability for all or some lessons.",implementationTips:["Consider alternatives like mixed-ability with targeted support","If setting, ensure movement between sets","Avoid labelling and low expectations","Monitor impact on disadvantaged"],commonMistakes:["Fixed sets with no movement","Lower sets have weaker teaching","Self-fulfilling prophecy","PP pupils over-represented in lower sets"],ofstedLinks:["Quality of Education","Pupil Premium"],keywords:["setting","streaming","ability groups","differentiation"]},{id:"repeating-year",name:"Repeating a Year",monthsProgress:-4,costRating:5,evidenceStrength:4,category:"targeted",description:"Holding a student back to repeat a year of schooling.",implementationTips:["Avoid if possible - evidence shows harm","Address specific learning gaps instead","Consider targeted interventions","Social and emotional impact significant"],commonMistakes:["Assuming more time = better outcomes","Not addressing root causes","Ignoring social/emotional impact","Delaying rather than solving"],ofstedLinks:["Quality of Education","SEND"],keywords:["repeat","held back","retention"]},{id:"within-class-grouping",name:"Within-Class Attainment Grouping",monthsProgress:2,costRating:1,evidenceStrength:3,category:"teaching",description:"Grouping pupils within their class based on current attainment.",implementationTips:["Flexible groups that change","High expectations for all groups","Teacher works with all groups","Avoid permanent groupings"],commonMistakes:["Fixed groups all year","Teacher always with same group","Lower groups have lower expectations","PP pupils always in lower groups"],ofstedLinks:["Quality of Education","Pupil Premium"],keywords:["grouping","table groups","ability","differentiation"]},{id:"individualised-instruction",name:"Individualised Instruction",monthsProgress:4,costRating:2,evidenceStrength:4,category:"teaching",description:"Tailoring teaching and learning to individual pupils needs.",implementationTips:["Use assessment to identify specific needs","Adaptive teaching within whole-class approach","Technology can support personalisation","Balance individual and whole-class"],commonMistakes:["Three-way differentiation for every lesson","Workload becomes unsustainable","Lowering expectations","Too much individual work, not enough teaching"],ofstedLinks:["Quality of Education","SEND","Adaptive Teaching"],keywords:["differentiation","individual","adaptive","personalised","SEND"]}],ee=[{id:"scheme-validated",question:"Is your phonics/reading scheme DfE validated?",area:"reading",ifNo:"Consider switching to a validated systematic synthetic phonics programme (e.g., Little Wandle, Read Write Inc)",ifYes:"Scheme is appropriate - check implementation"},{id:"staff-trained",question:"Have all staff delivering reading had recent CPD on the scheme?",area:"reading",ifNo:"Book CPD session for staff on phonics/reading scheme delivery",ifYes:"Training is in place - check classroom practice"},{id:"lessons-observed",question:"Have SLT observed reading lessons this term?",area:"reading",ifNo:"Schedule lesson observations focused on reading delivery",ifYes:"Observations done - review findings"},{id:"books-matched",question:"Are reading books matched to children's phonics stage?",area:"reading",ifNo:"Audit reading books and implement book-banding system",ifYes:"Books are matched - check home reading consistency"},{id:"interventions-place",question:"Are rapid interventions in place for children falling behind?",area:"reading",ifNo:"Implement same-day keep-up interventions for struggling readers",ifYes:"Interventions exist - check impact data"}],et=[{id:"mastery-approach",question:"Are you using a mastery approach (e.g., White Rose, Power Maths)?",area:"maths",ifNo:"Consider adopting a mastery curriculum approach",ifYes:"Mastery in place - check implementation fidelity"},{id:"fluency-practice",question:"Do children get daily fluency practice (times tables, number bonds)?",area:"maths",ifNo:"Implement daily fluency sessions (e.g., Times Tables Rock Stars)",ifYes:"Fluency in place - check coverage"},{id:"concrete-resources",question:"Do teachers use concrete manipulatives before abstract?",area:"maths",ifNo:"CPD needed on concrete-pictorial-abstract approach",ifYes:"CPA used - check reasoning opportunities"}],es=[{id:"policy-clear",question:"Is your behaviour policy clear and consistently applied?",area:"behaviour",ifNo:"Review and relaunch behaviour policy with all staff",ifYes:"Policy exists - check consistency"},{id:"routines-embedded",question:"Are routines and expectations explicitly taught to pupils?",area:"behaviour",ifNo:"Implement explicit teaching of school routines",ifYes:"Routines taught - check reinforcement"},{id:"root-causes",question:"Do you investigate root causes of behaviour incidents?",area:"behaviour",ifNo:"Implement behaviour analysis process (ABC approach)",ifYes:"Root causes explored - check support plans"}],ea=[{id:"identify-early",question:"Do you identify SEND needs early (within first term)?",area:"send",ifNo:"Implement early identification screening system",ifYes:"Early ID in place - check provision"},{id:"provision-map",question:"Do you have a clear provision map showing interventions?",area:"send",ifNo:"Create provision map linked to SEND register",ifYes:"Provision mapped - check impact tracking"},{id:"ta-trained",question:"Are TAs trained on specific SEND interventions?",area:"send",ifNo:"Book targeted CPD for TAs on intervention delivery",ifYes:"TAs trained - check deployment"}],ei=[{id:"teaching-observed",question:"Have all teachers been observed this half-term?",area:"teaching",ifNo:"Schedule lesson observations for all staff",ifYes:"Observations done - review quality"},{id:"feedback-given",question:"Do teachers receive specific, developmental feedback?",area:"teaching",ifNo:"Implement coaching/mentoring conversations post-observation",ifYes:"Feedback given - check follow-up"},{id:"underperformance-addressed",question:"Is underperformance addressed promptly with support plans?",area:"teaching",ifNo:"Create support plan process for struggling teachers",ifYes:"Support in place - monitor progress"}];function er({selectedCategory:e,selectedSubcategory:s,currentRating:a,evidenceCount:r=0,gaps:n=[],onCreateAction:o,onClose:d}){let c,[m,u]=(0,i.useState)("analysis"),[p,h]=(0,i.useState)({}),[g,x]=(0,i.useState)([]),[b,f]=(0,i.useState)(!1),[y,v]=(0,i.useState)(!1),[w,k]=(0,i.useState)(null),[S,C]=(0,i.useState)([]),P=(c=e?.toLowerCase()||"").includes("reading")||c.includes("phonics")?ee:c.includes("maths")||c.includes("mathematics")?et:c.includes("behaviour")?es:c.includes("send")||c.includes("inclusion")?ea:ei;(0,i.useEffect)(()=>{let e=Object.entries(p);if(e.length>=3){let t=e.filter(([e,t])=>!1===t);if(t.length>0){let e=t[0],s=P.find(t=>t.id===e[0]);s&&(k(s.ifNo),A(s))}else k("Implementation appears sound. Consider reviewing outcome data for specific cohorts or groups.");v(!0)}},[p]),(0,i.useEffect)(()=>{if(e){let t;C((t=e.toLowerCase().split(" "),Z.map(e=>({strategy:e,score:e.keywords.filter(e=>t.some(t=>e.includes(t)||t.includes(e))).length})).filter(e=>e.score>0).sort((e,t)=>t.score-e.score).map(e=>e.strategy)).slice(0,3))}},[e]);let A=e=>{let t=[];if(t.push({id:`action-${Date.now()}-1`,title:e.ifNo.split(".")[0],description:e.ifNo,priority:"high",status:"draft",dueDate:R(14),suggestedOwner:"Subject Lead"}),t.push({id:`action-${Date.now()}-2`,title:"SLT Monitoring Visit",description:`Conduct focused monitoring visit to assess implementation of ${e.area} improvements`,priority:"medium",status:"draft",dueDate:R(28),suggestedOwner:"Deputy Head"}),t.push({id:`action-${Date.now()}-3`,title:"Review Impact Data",description:"Review progress data to measure impact of interventions after 6 weeks",priority:"medium",status:"draft",dueDate:R(42),suggestedOwner:"Assessment Lead"}),S.length>0){let e=S[0];t.push({id:`action-${Date.now()}-4`,title:`Implement: ${e.name}`,description:`EEF research shows +${e.monthsProgress} months progress. ${e.description}`,eefStrategy:e.name,eefImpact:e.monthsProgress,priority:"high",status:"draft",dueDate:R(21),suggestedOwner:"Class Teachers"})}x(t)},R=e=>{let t=new Date;return t.setDate(t.getDate()+e),t.toISOString().split("T")[0]},D=(e,t)=>{h(s=>({...s,[e]:t}))};return(0,t.jsxs)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 text-white p-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:(0,t.jsx)(M,{size:22})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold",children:"Ed's Analysis"}),(0,t.jsx)("p",{className:"text-sm text-white/80",children:e||"Select an area to analyze"})]})]}),d&&(0,t.jsx)("button",{onClick:d,className:"p-1 hover:bg-white/20 rounded",children:(0,t.jsx)($.X,{size:20})})]})}),(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsxs)("nav",{className:"flex",children:[(0,t.jsx)("button",{onClick:()=>u("analysis"),className:`flex-1 py-3 text-sm font-medium border-b-2 ${"analysis"===m?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500"}`,children:"ðŸ“Š Analysis"}),(0,t.jsx)("button",{onClick:()=>u("questions"),className:`flex-1 py-3 text-sm font-medium border-b-2 ${"questions"===m?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500"}`,children:"â“ Root Cause"}),(0,t.jsxs)("button",{onClick:()=>u("actions"),className:`flex-1 py-3 text-sm font-medium border-b-2 relative ${"actions"===m?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500"}`,children:["ðŸŽ¯ Actions",g.filter(e=>"draft"===e.status).length>0&&(0,t.jsx)("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs rounded-full flex items-center justify-center",children:g.filter(e=>"draft"===e.status).length})]})]})}),(0,t.jsxs)("div",{className:"p-4 max-h-[400px] overflow-y-auto",children:["analysis"===m&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Current Status"}),(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${"Outstanding"===a?"bg-green-100 text-green-700":"Good"===a?"bg-blue-100 text-blue-700":"Requires Improvement"===a?"bg-yellow-100 text-yellow-700":"Inadequate"===a?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:a||"Not Assessed"})]}),(0,t.jsx)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(N.FileText,{size:14}),r," evidence items"]})})]}),n.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[(0,t.jsx)(j.AlertTriangle,{size:16,className:"text-yellow-500"}),"Identified Gaps"]}),(0,t.jsx)("div",{className:"space-y-2",children:n.map(e=>(0,t.jsxs)("div",{className:`p-3 rounded-lg ${(e=>{switch(e){case"critical":return"text-red-600 bg-red-50";case"moderate":return"text-yellow-600 bg-yellow-50";case"minor":return"text-blue-600 bg-blue-50";default:return"text-gray-600 bg-gray-50"}})(e.severity)}`,children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.area}),(0,t.jsx)("p",{className:"text-xs mt-1",children:e.description})]},e.id))})]}),S.length>0&&(0,t.jsxs)("div",{children:[(0,t.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2 flex items-center gap-2",children:[(0,t.jsx)(l.BookOpen,{size:16,className:"text-emerald-500"}),"EEF Research Suggests"]}),(0,t.jsx)("div",{className:"space-y-2",children:S.map(e=>(0,t.jsxs)("div",{className:"p-3 bg-emerald-50 rounded-lg border border-emerald-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-emerald-800",children:e.name}),(0,t.jsxs)("span",{className:"text-xs bg-emerald-200 text-emerald-800 px-2 py-0.5 rounded-full",children:["+",e.monthsProgress," months"]})]}),(0,t.jsx)("p",{className:"text-xs text-emerald-700 mt-1",children:e.description})]},e.id))})]}),(0,t.jsxs)("button",{onClick:()=>u("questions"),className:"w-full py-3 bg-emerald-500 text-white rounded-lg font-medium hover:bg-emerald-600 flex items-center justify-center gap-2",children:[(0,t.jsx)(V.Lightbulb,{size:18}),"Start Root Cause Analysis",(0,t.jsx)(X.ArrowRight,{size:18})]})]}),"questions"===m&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,t.jsx)("strong",{children:"Ed says:"}),' "Let me help identify the root cause. Answer these questions honestly - it helps us fix the right thing!"']})}),(0,t.jsx)("div",{className:"space-y-3",children:P.map((e,s)=>(0,t.jsx)("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"w-6 h-6 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-600 text-xs font-bold flex-shrink-0",children:s+1}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 mb-3",children:e.question}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>D(e.id,!0),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${!0===p[e.id]?"bg-green-500 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-green-50"}`,children:"âœ“ Yes"}),(0,t.jsx)("button",{onClick:()=>D(e.id,!1),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-colors ${!1===p[e.id]?"bg-red-500 text-white":"bg-white border border-gray-300 text-gray-700 hover:bg-red-50"}`,children:"âœ— No"})]}),!1===p[e.id]&&(0,t.jsx)("div",{className:"mt-2 p-2 bg-yellow-50 rounded border border-yellow-200",children:(0,t.jsxs)("p",{className:"text-xs text-yellow-800",children:[(0,t.jsx)("strong",{children:"Action needed:"})," ",e.ifNo]})})]})]})},e.id))}),y&&w&&(0,t.jsxs)("div",{className:"p-4 bg-emerald-50 rounded-lg border border-emerald-200",children:[(0,t.jsxs)("h4",{className:"font-medium text-emerald-800 mb-2 flex items-center gap-2",children:[(0,t.jsx)(G.Target,{size:16}),"Root Cause Identified"]}),(0,t.jsx)("p",{className:"text-sm text-emerald-700",children:w}),(0,t.jsx)("button",{onClick:()=>u("actions"),className:"mt-3 w-full py-2 bg-emerald-500 text-white rounded-lg text-sm font-medium hover:bg-emerald-600",children:"View Recommended Actions â†’"})]})]}),"actions"===m&&(0,t.jsx)("div",{className:"space-y-4",children:0===g.length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(Y.ClipboardList,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{className:"text-sm",children:"Complete the Root Cause analysis to generate actions"}),(0,t.jsx)("button",{onClick:()=>u("questions"),className:"mt-3 text-emerald-600 text-sm font-medium",children:"Start Analysis â†’"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,t.jsx)("strong",{children:"Ed says:"}),' "Here are my recommended actions based on EEF research. Approve to add to your action plan, or edit as needed."']})}),(0,t.jsx)("div",{className:"space-y-3",children:g.map((e,s)=>(0,t.jsxs)("div",{className:`p-4 rounded-lg border ${"approved"===e.status?"bg-green-50 border-green-200":"rejected"===e.status?"bg-gray-50 border-gray-200 opacity-50":"bg-white border-gray-200"}`,children:[(0,t.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${(e=>{switch(e){case"high":return"bg-red-100 text-red-700";case"medium":return"bg-yellow-100 text-yellow-700";case"low":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-700"}})(e.priority)}`,children:e.priority.toUpperCase()}),e.eefStrategy&&(0,t.jsxs)("span",{className:"px-2 py-0.5 bg-emerald-100 text-emerald-700 rounded text-xs",children:["EEF: +",e.eefImpact,"mo"]})]}),"approved"===e.status&&(0,t.jsx)(W,{size:18,className:"text-green-500"})]}),(0,t.jsx)("h5",{className:"font-medium text-gray-900 text-sm",children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-3 text-xs text-gray-500",children:[(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(z.Clock,{size:12}),"Due: ",e.dueDate]}),(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(E.User,{size:12}),e.suggestedOwner]})]}),"draft"===e.status&&(0,t.jsxs)("div",{className:"flex gap-2 mt-3",children:[(0,t.jsxs)("button",{onClick:()=>{let t;return t={...e,status:"approved"},void(x(s=>s.map(s=>s.id===e.id?t:s)),o?.(t))},className:"flex-1 py-2 bg-green-500 text-white rounded text-xs font-medium hover:bg-green-600 flex items-center justify-center gap-1",children:[(0,t.jsx)(Q,{size:14}),"Approve"]}),(0,t.jsx)("button",{onClick:()=>{var t;return t=e.id,void x(e=>e.map(e=>e.id===t?{...e,status:"rejected"}:e))},className:"py-2 px-3 bg-gray-200 text-gray-700 rounded text-xs font-medium hover:bg-gray-300",children:(0,t.jsx)(K,{size:14})}),(0,t.jsx)("button",{className:"py-2 px-3 bg-blue-100 text-blue-700 rounded text-xs font-medium hover:bg-blue-200",children:(0,t.jsx)(J,{size:14})})]})]},e.id))}),(0,t.jsx)("div",{className:"p-3 bg-purple-50 rounded-lg border border-purple-200",children:(0,t.jsxs)("p",{className:"text-xs text-purple-800",children:[(0,t.jsx)("strong",{children:"ðŸ“‹ Inspector Note:"})," When approved, these actions will appear in your Action Plan and link to your SEF narrative, showing a clear journey of improvement."]})})]})})]})]})}let en={rose:"bg-white border-l-4 border-rose-500 text-rose-900 hover:bg-rose-50",teal:"bg-white border-l-4 border-teal-500 text-teal-900 hover:bg-teal-50",orange:"bg-white border-l-4 border-orange-500 text-orange-900 hover:bg-orange-50",violet:"bg-white border-l-4 border-violet-500 text-violet-900 hover:bg-violet-50",blue:"bg-white border-l-4 border-blue-500 text-blue-900 hover:bg-blue-50",gray:"bg-white border-l-4 border-gray-500 text-gray-900 hover:bg-gray-50"};function eo({assessments:e,setAssessments:a,localEvidence:r={}}){let{user:n,accessToken:o,providerId:l,signInWithGoogle:d,signInWithMicrosoft:c}=(0,s.useAuth)(),[m,u]=(0,i.useState)({status:"idle"}),[p,h]=(0,i.useState)({isOpen:!1,categoryName:"",subcategoryName:"",evidenceItem:"",matches:[]}),[g,x]=(0,i.useState)("root"),[b,L]=(0,i.useState)(!1),[z,F]=(0,i.useState)(new Set),[O,H]=(0,i.useState)(null),[U,W]=(0,i.useState)(!0),[G,V]=(0,i.useState)(!1),[Y,Q]=(0,i.useState)(!1),[K,J]=(0,i.useState)(null),[X,Z]=(0,i.useState)(null),[ee,et]=(0,i.useState)(void 0),[es,ea]=(0,i.useState)(void 0),[ei,eo]=(0,i.useState)(!1),[el,ed]=(0,i.useState)(""),[ec,em]=(0,i.useState)(""),[eu,ep]=(0,i.useState)(0),{userScore:eh,aiScore:eg}=function(e){let t=0,s=0,a=0;for(let i of f){let{userScore:r,aiScore:n}=y(i.id,e);r>0&&(t+=r,a++),s+=n}return{userScore:a>0?Math.round(t/a):0,aiScore:a>0?Math.round(s/a):0}}(e),ex={"quality-of-education":["quality-intent","quality-implementation","quality-impact"],"behaviour-attitudes":["behaviour"],"personal-development":["personal-development"],"leadership-management":["leadership","safeguarding"],"early-years":["early-years"]},eb=e=>{let t=ex[e]||[e],s=0;for(let e of t)r[e]&&(s+=r[e].length);return s},ef=(e,t)=>{e.stopPropagation(),H(O===t?null:t)},ey=async()=>{if(!o||!l)return void u({status:"error",message:"Please reconnect your account to enable scanning."});V(!0),u({status:"scanning",message:"Initializing scan..."}),L(!1);try{let t=await fetch("/api/scan",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:l,accessToken:o,folderId:g,userId:n?.uid,recursive:!0,useAI:!0})}),s=await t.json();if(!t.ok)throw Error(s.error||"Scan failed");if(s.assessmentUpdates){let t={...e};Object.entries(s.assessmentUpdates).forEach(([e,s])=>{t[e]={...t[e],...s}}),a(t)}if(u({status:"complete",message:"Scan complete!",stats:s.stats}),s.assessmentUpdates){let e=Object.keys(s.assessmentUpdates),t=new Set(z);f.forEach(s=>{s.subcategories.some(t=>e.includes(t.id))&&t.add(s.id)}),F(t)}}catch(e){console.error("Scan error:",e),u({status:"error",message:e.message})}finally{V(!1)}},ev=async(e,t)=>{if(!n?.uid)return[];try{let s=await fetch("/api/evidence",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n.uid,subcategoryId:e,evidenceItem:t})});if(s.ok)return(await s.json()).matches||[];return[]}catch(e){return console.error("Error fetching evidence:",e),[]}},ej=e=>{switch(e){case"outstanding":return"bg-green-100 text-green-800 border-green-300";case"good":return"bg-blue-100 text-blue-800 border-blue-300";case"requires_improvement":return"bg-yellow-100 text-yellow-800 border-yellow-300";case"inadequate":return"bg-red-100 text-red-800 border-red-300";default:return"bg-gray-100 text-gray-600 border-gray-300"}},ew=e=>e>=90?"text-green-600":e>=70?"text-blue-600":e>=40?"text-amber-600":"text-red-600";return(0,t.jsxs)("div",{className:"space-y-4",children:[U&&(0,t.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6 mb-6 relative",children:[(0,t.jsx)("button",{onClick:()=>W(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors",children:(0,t.jsx)($.X,{size:20})}),(0,t.jsxs)("div",{className:"flex items-start gap-4 pr-8",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,t.jsx)(T,{className:"w-6 h-6 text-blue-600"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-blue-900 text-lg mb-2",children:"About the Education Inspection Framework (EIF)"}),(0,t.jsx)("p",{className:"text-blue-800 text-sm leading-relaxed mb-3",children:"The EIF is the framework used by Ofsted to inspect schools in England. This tool helps you track your school's readiness against the key categories of Quality of Education, Behaviour & Attitudes, Personal Development, and Leadership & Management. For each area, you can self-assess, add evidence, create action plans, and see how AI analysis compares to your judgements."}),(0,t.jsxs)("a",{href:"https://www.gov.uk/government/publications/education-inspection-framework",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-blue-600 hover:text-blue-800 font-medium text-sm transition-colors",children:[(0,t.jsx)(I,{size:16}),"View official EIF documentation"]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Ofsted Inspection Framework"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Track evidence and readiness against the Education Inspection Framework (EIF)"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsx)("div",{className:"flex items-center gap-2",children:o?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)("button",{onClick:()=>L(!b),disabled:G,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-white transition-colors ${G?"bg-blue-400 cursor-not-allowed":"bg-blue-600 hover:bg-blue-700"}`,children:[(0,t.jsx)(k.RefreshCw,{size:18,className:G?"animate-spin":""}),G?"Scanning...":"Scan Evidence",(0,t.jsx)(v.ChevronDown,{size:16,className:"ml-1"})]}),b&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-72 bg-white rounded-xl shadow-xl border border-gray-200 z-20 p-4 animate-in fade-in slide-in-from-top-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-3",children:"Scan Settings"}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Source"}),(0,t.jsx)("div",{className:"flex items-center gap-2 text-sm text-gray-700 bg-gray-50 p-2 rounded border border-gray-200",children:"microsoft.com"===l?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-blue-600",children:"OneDrive"})," Connected"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-green-600",children:"Google Drive"})," Connected"]})})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Folder ID (Optional)"}),(0,t.jsx)("input",{type:"text",value:g,onChange:e=>x(e.target.value),placeholder:"root",className:"w-full p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none"}),(0,t.jsx)("p",{className:"text-[10px] text-gray-400 mt-1",children:'Leave as "root" to scan everything'})]}),(0,t.jsxs)("button",{onClick:ey,className:"w-full py-2 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center justify-center gap-2",children:[(0,t.jsx)(D.Brain,{size:16}),"Start AI Scan"]})]})]}):(0,t.jsxs)("button",{onClick:()=>"microsoft.com"===l?c():d(),className:"flex items-center gap-2 px-4 py-2 rounded-lg font-medium text-white bg-amber-600 hover:bg-amber-700 transition-colors",children:[(0,t.jsx)(k.RefreshCw,{size:18}),"Reconnect to Scan"]})}),(0,t.jsxs)("div",{className:"flex gap-6 border-l border-gray-200 pl-6",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 flex items-center justify-end gap-1",children:[(0,t.jsx)(R.TrendingUp,{size:14})," School Readiness"]}),(0,t.jsxs)("div",{className:`text-3xl font-bold ${ew(eh)}`,children:[eh,"%"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500 flex items-center justify-end gap-1",children:[(0,t.jsx)(D.Brain,{size:14})," AI Evidence Score"]}),(0,t.jsxs)("div",{className:`text-3xl font-bold ${ew(eg)}`,children:[eg,"%"]})]})]})]})]}),"idle"!==m.status&&(0,t.jsxs)("div",{className:`mb-6 p-4 rounded-lg border flex items-start gap-3 ${"error"===m.status?"bg-red-50 border-red-200 text-red-700":"complete"===m.status?"bg-green-50 border-green-200 text-green-700":"bg-blue-50 border-blue-200 text-blue-700"}`,children:["scanning"===m.status&&(0,t.jsx)(k.RefreshCw,{className:"animate-spin mt-0.5",size:18}),"complete"===m.status&&(0,t.jsx)(w.CheckCircle,{className:"mt-0.5",size:18}),"error"===m.status&&(0,t.jsx)(j.AlertTriangle,{className:"mt-0.5",size:18}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("p",{className:"font-medium",children:m.message}),m.stats&&(0,t.jsxs)("div",{className:"mt-2 text-sm grid grid-cols-2 gap-x-8 gap-y-1",children:[(0,t.jsxs)("span",{children:["Files Processed: ",(0,t.jsx)("b",{children:m.stats.processedFiles})]}),(0,t.jsxs)("span",{children:["Evidence Matches: ",(0,t.jsx)("b",{children:m.stats.evidenceMatches})]}),(0,t.jsxs)("span",{children:["Skipped (Unchanged): ",(0,t.jsx)("b",{children:m.stats.skippedFiles})]}),(0,t.jsxs)("span",{children:["Failed: ",(0,t.jsx)("b",{children:m.stats.failedFiles})]})]})]}),"scanning"!==m.status&&(0,t.jsx)("button",{onClick:()=>u({status:"idle"}),className:"text-gray-400 hover:text-gray-600",children:(0,t.jsx)($.X,{size:16})})]}),(0,t.jsx)("div",{className:"space-y-3",children:f.map(s=>{let{userScore:i,aiScore:n}=y(s.id,e);return(0,t.jsxs)("div",{className:`mb-4 border rounded-lg overflow-hidden transition-all duration-200 ${z.has(s.id)?"shadow-md":"shadow-sm"} ${en[s.color||"gray"].replace("hover:","")}`,children:[(0,t.jsxs)("div",{className:`transition-colors ${en[s.color||"gray"]}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between w-full p-4",children:[(0,t.jsxs)("button",{onClick:()=>{var e;let t;return e=s.id,void((t=new Set(z)).has(e)?t.delete(e):t.add(e),F(t))},className:"flex items-center gap-3 flex-1 text-left",children:[(0,t.jsx)("span",{className:"text-lg text-gray-400",children:z.has(s.id)?"â–¼":"â–¶"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:s.name}),(0,t.jsx)("div",{onClick:e=>ef(e,s.id),className:"text-gray-400 hover:text-blue-600 cursor-pointer p-1 rounded-full hover:bg-white/50 transition-colors",title:"Click for guidance",children:(0,t.jsx)(T,{size:16})})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:s.description})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mr-4",children:[eb(s.id)>0&&(0,t.jsxs)("div",{className:"text-right border-r border-gray-200 pr-4",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Evidence"}),(0,t.jsxs)("div",{className:"text-lg font-bold text-purple-600 flex items-center gap-1",children:[(0,t.jsx)(N.FileText,{size:14}),eb(s.id)]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Readiness"}),(0,t.jsxs)("div",{className:`text-lg font-bold ${ew(i)}`,children:[i,"%"]})]}),(0,t.jsxs)("div",{className:"text-right border-l border-gray-200 pl-4",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-gray-400",children:"AI Score"}),(0,t.jsxs)("div",{className:`text-lg font-bold ${ew(n)}`,children:[n,"%"]})]})]}),(0,t.jsxs)("button",{onClick:t=>{var a,r,n;t.stopPropagation(),a=s.name,r=i>=90?"Outstanding":i>=70?"Good":i>=40?"Requires Improvement":"Inadequate",n=s.subcategories.reduce((t,s)=>t+(e[s.id]?.evidenceCount||0),0),ed(a),em(r||"Not Assessed"),ep(n||0),eo(!0)},className:"flex items-center gap-2 px-3 py-2 bg-emerald-500 text-white text-sm font-medium rounded-lg hover:bg-emerald-600 transition-colors shadow-sm",title:"Get Ed's analysis and recommendations",children:[(0,t.jsx)(M,{size:16}),(0,t.jsx)("span",{className:"hidden lg:inline",children:"Ask Ed"})]})]}),O===s.id&&s.guidanceSummary&&(0,t.jsx)("div",{className:"px-4 pb-4 animate-in fade-in slide-in-from-top-2",children:(0,t.jsx)("div",{className:"bg-white/80 p-3 rounded-md border border-gray-200 text-sm shadow-inner",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(T,{className:"text-blue-500 flex-shrink-0 mt-0.5",size:16}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-800 font-medium mb-1",children:"Ofsted Expectation:"}),(0,t.jsx)("p",{className:"text-gray-600 leading-relaxed",children:s.guidanceSummary}),s.guidanceLink&&(0,t.jsxs)("a",{href:s.guidanceLink,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-xs text-blue-600 mt-2 hover:underline font-medium",children:["Read Official Documentation ",(0,t.jsx)(I,{size:10})]})]})]})})})]}),z.has(s.id)&&(0,t.jsxs)("div",{className:"p-4 bg-white space-y-6 border-t border-gray-100",children:[eb(s.id)>0&&(0,t.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4",children:[(0,t.jsxs)("h4",{className:"font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[(0,t.jsx)(N.FileText,{size:18,className:"text-purple-600"}),"Local Evidence Files (",eb(s.id),")"]}),(0,t.jsx)("div",{className:"space-y-2",children:(e=>{let t=ex[e]||[e],s=[];for(let e of t)r[e]&&(s=[...s,...r[e]]);return s})(s.id).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-purple-100",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.fileName}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.matchedKeywords.slice(0,3).map((e,s)=>(0,t.jsx)("span",{className:"text-xs bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded",children:e},s))})]}),(0,t.jsxs)("span",{className:`text-xs px-2 py-1 rounded-full ml-2 ${e.confidence>=.7?"bg-green-100 text-green-700":e.confidence>=.5?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-600"}`,children:[Math.round(100*e.confidence),"%"]})]},s))}),(0,t.jsx)("p",{className:"text-xs text-purple-600 mt-2",children:"ðŸ“ Scanned from local folder"})]}),s.subcategories.map(i=>{let r=e[i.id]||{},n=r.schoolRating||"not_assessed",o=r.schoolRationale||"",l=r.aiRating||"not_assessed",d=r.aiRationale||"AI analysis pending evidence scan.",c=r.actions||[],m=r.evidenceCount||0,u=i.evidenceRequired.length,p=m<u;return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h4",{className:"font-bold text-gray-900 text-lg",children:i.name}),(0,t.jsx)("div",{onClick:e=>ef(e,i.id),className:"text-gray-400 hover:text-blue-600 cursor-pointer p-1",title:"Click for guidance",children:(0,t.jsx)(T,{size:16})})]}),(0,t.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:i.description}),O===i.id&&i.guidanceSummary&&(0,t.jsxs)("div",{className:"mt-3 bg-blue-50 p-3 rounded-md border border-blue-100 text-sm animate-in fade-in slide-in-from-top-1",children:[(0,t.jsx)("p",{className:"text-blue-900 font-medium mb-1",children:"What Good Looks Like:"}),(0,t.jsx)("p",{className:"text-blue-800",children:i.guidanceSummary})]})]}),(0,t.jsxs)("div",{className:"flex gap-4 ml-4",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-gray-500 mb-1",children:"AI Assessment"}),(0,t.jsx)("div",{className:`px-3 py-1.5 rounded-md text-sm font-medium border ${ej(l)}`,children:(e=>{switch(e){case"outstanding":return"Outstanding";case"good":return"Good";case"requires_improvement":return"Requires Improvement";case"inadequate":return"Inadequate";default:return"Not Assessed"}})(l)})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-xs font-semibold text-gray-500 mb-1",children:"School Self-Assessment"}),(0,t.jsxs)("select",{value:n,onChange:t=>{var s,r;return s=i.id,r=t.target.value,void a({...e,[s]:{...e[s],schoolRating:r}})},className:`px-3 py-1.5 rounded-md text-sm font-medium border focus:ring-2 focus:ring-blue-500 outline-none ${ej(n)}`,children:[(0,t.jsx)("option",{value:"not_assessed",children:"Not Assessed"}),(0,t.jsx)("option",{value:"outstanding",children:"Outstanding"}),(0,t.jsx)("option",{value:"good",children:"Good"}),(0,t.jsx)("option",{value:"requires_improvement",children:"Requires Improvement"}),(0,t.jsx)("option",{value:"inadequate",children:"Inadequate"})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("h5",{className:"font-semibold text-gray-700 text-sm flex items-center gap-2",children:[(0,t.jsx)(N.FileText,{size:16}),"Evidence Required"]}),(0,t.jsxs)("span",{className:`text-xs font-bold px-2 py-0.5 rounded ${p?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:[m,"/",u," Items"]})]}),(0,t.jsx)("ul",{className:"space-y-2",children:i.evidenceRequired.map((e,a)=>(0,t.jsxs)("li",{className:"flex items-start justify-between group text-sm p-2 rounded hover:bg-gray-50",children:[(0,t.jsxs)("span",{className:"text-gray-600 flex-1 mr-2",children:["â€¢ ",e.name]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)("button",{onClick:()=>{var t,a,r,n;return t=i.id,a=e.name,r=s.name,n=i.name,void ev(t,a).then(e=>{h({isOpen:!0,categoryName:r,subcategoryName:n,evidenceItem:a,matches:e})})},className:"text-xs bg-white text-gray-600 px-2 py-1 rounded border border-gray-200 hover:bg-gray-50 hover:text-blue-600 transition-all flex items-center gap-1",title:"View found evidence",children:[(0,t.jsx)(N.FileText,{size:12})," View"]}),(0,t.jsxs)("button",{onClick:()=>{var t,a,r;return t=i.id,a=e.name,r=s.name,void(J(t),Z(a),et(r),ea(void 0),Q(!0))},className:"text-xs bg-blue-50 text-blue-600 px-2 py-1 rounded border border-blue-200 hover:bg-blue-100 transition-all flex items-center gap-1",title:"Create action",children:[(0,t.jsx)(S.Plus,{size:12})," Action"]})]})]},e.id||a))}),c.length>0&&(0,t.jsxs)("div",{className:"mt-6 border-t border-gray-100 pt-4",children:[(0,t.jsxs)("h5",{className:"font-semibold text-gray-700 text-sm mb-3 flex items-center gap-2",children:[(0,t.jsx)(A,{size:16}),"Action Plan (",c.length,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:c.map(e=>(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border ${(e=>{switch(e){case"high":return"bg-red-100 text-red-700 border-red-200";case"medium":return"bg-amber-100 text-amber-700 border-amber-200";case"low":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-600"}})(e.priority)}`,children:e.priority}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.description})]}),(0,t.jsx)("button",{onClick:()=>{var t;return t=i.id,void(J(t),Z(null),ea(e),Q(!0))},className:"text-gray-400 hover:text-blue-600",children:(0,t.jsx)(C,{size:14})})]}),e.rationale&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-2 italic",children:['"',e.rationale,'"']}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.assignee&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(E.User,{size:12})," ",e.assignee]}),e.dueDate&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(P,{size:12})," ",new Date(e.dueDate).toLocaleDateString()]}),(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-[10px] font-medium ${"completed"===e.status?"bg-green-100 text-green-700":"in_progress"===e.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:e.status.replace("_"," ")})]})]},e.id))})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"AI Rationale"}),(0,t.jsx)("div",{className:"p-3 bg-gray-50 rounded-md border border-gray-200 text-sm text-gray-700 whitespace-pre-wrap",children:d})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:`rationale-${i.id}`,className:"block text-sm font-semibold text-gray-700 mb-2",children:"School Rationale & Evidence Notes"}),(0,t.jsx)("textarea",{id:`rationale-${i.id}`,value:o,onChange:t=>{var s,r;return s=i.id,r=t.target.value,void a({...e,[s]:{...e[s],schoolRationale:r}})},placeholder:"Explain your self-assessment rating and list key evidence...",className:"w-full p-3 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm",rows:6})]})]})]})]},i.id)})]})]},s.id)})})]}),Y&&(0,t.jsx)(_,{isOpen:Y,onClose:()=>Q(!1),onSave:t=>{let s;if(!K)return;let i=e[K]||{},r=i.actions||[];s=es?r.map(e=>e.id===t.id?t:e):[...r,t],a({...e,[K]:{...i,actions:s}}),Q(!1)},categoryName:ee||"",subCategoryName:f.flatMap(e=>e.subcategories).find(e=>e.id===K)?.name,evidenceItem:X||void 0,initialData:es}),(0,t.jsx)(B,{isOpen:p.isOpen,onClose:()=>h({...p,isOpen:!1}),categoryName:p.categoryName,subcategoryName:p.subcategoryName,evidenceItem:p.evidenceItem,matches:p.matches}),ei&&(0,t.jsx)("div",{className:"fixed right-6 top-32 w-96 z-40 animate-in slide-in-from-right",children:(0,t.jsx)(er,{selectedCategory:el,currentRating:ec,evidenceCount:eu,onCreateAction:e=>{console.log("Ed created action:",e)},onClose:()=>eo(!1)})}),!ei&&(0,t.jsxs)("button",{onClick:()=>eo(!0),className:"fixed right-6 top-32 bg-gradient-to-r from-emerald-500 to-teal-600 text-white px-4 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center gap-2 z-40",children:[(0,t.jsx)(M,{size:20}),(0,t.jsx)("span",{className:"font-medium",children:"Analyze with Ed"}),(0,t.jsx)(q.Sparkles,{size:16,className:"text-yellow-300"})]})]})}let el=[{id:"vision",name:"Vision and Leadership",shortName:"Vision",description:"How well does the school's Christian vision drive its work, enabling all to flourish?",color:"purple",inspectionQuestions:[{id:"vision-1",question:"How clearly is the school's Christian vision articulated and understood by all?",guidance:"The vision should be theologically rooted, distinctive, and clearly expressed in school documentation and practice.",evidenceRequired:["Vision statement","School website","Policies referencing vision","Staff understanding"]},{id:"vision-2",question:"How effectively does the vision shape the strategic direction of the school?",guidance:"School improvement plans should explicitly link to the Christian vision.",evidenceRequired:["School Development Plan","Strategic priorities","Governor minutes"]},{id:"vision-3",question:"How well do leaders at all levels model and promote the vision?",guidance:"Leaders should be able to articulate how their decisions connect to the vision.",evidenceRequired:["Leadership interviews","Decision-making processes","Staff feedback"]},{id:"vision-4",question:"How effectively does governance support and challenge the school's Christian foundation?",guidance:"Foundation governors should understand their distinctive role.",evidenceRequired:["Governor meeting minutes","Governor training records","Challenge evidence"]}],keyIndicators:["Vision is theologically rooted and clearly Christian","Vision explicitly drives all school policies and decisions","All stakeholders can articulate the vision and its impact","Foundation governors provide effective support and challenge"]},{id:"wisdom",name:"Wisdom, Knowledge and Skills",shortName:"Curriculum",description:"How well does the curriculum enable all pupils to flourish?",color:"blue",inspectionQuestions:[{id:"wisdom-1",question:"How does the curriculum reflect the school's Christian vision?",guidance:"Curriculum design should explicitly connect to Christian values and the vision.",evidenceRequired:["Curriculum overview","Subject policies","Long-term plans"]},{id:"wisdom-2",question:"How well does the curriculum enable pupils to develop spiritually?",guidance:"Spiritual development should be planned across the curriculum, not just in RE and worship.",evidenceRequired:["SMSC mapping","Lesson observations","Pupil work"]},{id:"wisdom-3",question:"How effectively does the curriculum prepare pupils for life in modern Britain?",guidance:"British Values and respect for diversity should be embedded.",evidenceRequired:["British Values mapping","PSHE curriculum","Pupil understanding"]},{id:"wisdom-4",question:"How well do all pupils achieve academically, especially the vulnerable?",guidance:"Outcomes for all groups should demonstrate that all are enabled to flourish.",evidenceRequired:["Attainment data","Progress data","Disadvantaged outcomes"]}],keyIndicators:["Curriculum explicitly reflects Christian vision","Spiritual development is planned and evident","All pupils make good progress regardless of background","Curriculum prepares pupils for diverse modern Britain"]},{id:"character",name:"Character Development",shortName:"Character",description:"How well does the school develop character through hope, aspiration and courageous advocacy?",color:"orange",inspectionQuestions:[{id:"character-1",question:"How well does the school develop pupils' character?",guidance:"Character education should be explicit and linked to Christian values.",evidenceRequired:["Character education programme","Behaviour policy","Recognition systems"]},{id:"character-2",question:"How effectively does the school instil hope and aspiration in all pupils?",guidance:"Pupils should believe they can achieve and make a difference.",evidenceRequired:["Pupil voice","Destination data","Careers education"]},{id:"character-3",question:"How well do pupils engage in social action and courageous advocacy?",guidance:"Pupils should be active in making a difference locally and globally.",evidenceRequired:["Charity work","Community projects","Pupil leadership"]},{id:"character-4",question:"How well do pupils understand ethical concepts and make ethical choices?",guidance:"Pupils should be able to discuss ethical dilemmas and demonstrate moral reasoning.",evidenceRequired:["RE lessons","PSHE","Pupil discussions","Behaviour evidence"]}],keyIndicators:["Explicit character education programme linked to vision","Pupils demonstrate hope and high aspirations","Active engagement in social action at all levels","Pupils can articulate ethical reasoning"]},{id:"community",name:"Community and Living Well Together",shortName:"Community",description:"How well do relationships reflect the school's Christian vision?",color:"teal",inspectionQuestions:[{id:"community-1",question:"How well do relationships across the school community reflect the Christian vision?",guidance:"Relationships should be characterised by forgiveness, reconciliation, and respect.",evidenceRequired:["Behaviour policy","Restorative approaches","Staff/pupil relationships"]},{id:"community-2",question:"How effectively does the school support mental health and wellbeing?",guidance:"Wellbeing should be prioritised for all members of the school community.",evidenceRequired:["Wellbeing policy","Support systems","Staff wellbeing"]},{id:"community-3",question:"How strong are partnerships with parents, church, and community?",guidance:"Church school partnership should be active and mutually beneficial.",evidenceRequired:["Church links","Parent engagement","Community partnerships"]},{id:"community-4",question:"How inclusive is the school community?",guidance:"All should feel welcomed, valued, and able to participate fully.",evidenceRequired:["Inclusion policy","SEND provision","Vulnerable groups support"]}],keyIndicators:["Relationships exemplify Christian values of forgiveness and reconciliation","Mental health and wellbeing are prioritised for all","Strong, active church school partnership","Genuinely inclusive community where all belong"]},{id:"dignity",name:"Dignity and Respect",shortName:"Dignity",description:"How well does the school ensure dignity and respect for all?",color:"rose",inspectionQuestions:[{id:"dignity-1",question:"How well does the school ensure all are treated with dignity?",guidance:"Every person should be valued as made in the image of God.",evidenceRequired:["Equality policy","Anti-bullying policy","Incident records"]},{id:"dignity-2",question:"How effectively does the school tackle prejudice and discrimination?",guidance:"There should be clear processes and zero tolerance for discrimination.",evidenceRequired:["Discrimination incidents","Response procedures","Training records"]},{id:"dignity-3",question:"How well do pupils understand and respect difference and diversity?",guidance:"Pupils should celebrate diversity as reflecting God's creation.",evidenceRequired:["Curriculum coverage","Pupil voice","Displays and resources"]},{id:"dignity-4",question:"How well are protected characteristics respected and understood?",guidance:"Age-appropriate teaching about all protected characteristics.",evidenceRequired:["RSE curriculum","PSHE coverage","Staff training"]}],keyIndicators:["All treated with dignity as made in image of God","Prejudice and discrimination actively challenged","Diversity celebrated and respected","Protected characteristics taught appropriately"]},{id:"worship",name:"Impact of Collective Worship",shortName:"Worship",description:"How well does collective worship enable all to flourish spiritually?",color:"violet",inspectionQuestions:[{id:"worship-1",question:"How central is collective worship to the life of the school?",guidance:"Worship should be the heartbeat of the school community.",evidenceRequired:["Worship timetable","Worship policy","Planning documents"]},{id:"worship-2",question:"How well does worship reflect the school's Christian vision and Anglican/Methodist tradition?",guidance:"Worship should be distinctively Christian and reflect denominational tradition.",evidenceRequired:["Worship themes","Use of liturgy","Christian calendar"]},{id:"worship-3",question:"How inclusive and invitational is collective worship?",guidance:"All should be able to participate while respecting individual beliefs.",evidenceRequired:["Withdrawal procedures","Inclusive language","Visitor feedback"]},{id:"worship-4",question:"How well do pupils engage with and respond to worship?",guidance:"Pupils should be actively engaged, not passive observers.",evidenceRequired:["Pupil-led worship","Prayer spaces","Pupil voice on worship"]},{id:"worship-5",question:"How effectively does worship contribute to spiritual development?",guidance:"Worship should provide opportunities for stillness, reflection, and encounter.",evidenceRequired:["Reflection opportunities","Impact evidence","Spiritual development"]}],keyIndicators:["Worship is central heartbeat of school","Distinctively Christian in Anglican/Methodist tradition","Inclusive and invitational to all","Pupils actively engaged and lead worship","Clear impact on spiritual development"]},{id:"re",name:"Effectiveness of Religious Education",shortName:"RE",description:"How effective is Religious Education in enabling pupils to flourish?",color:"emerald",inspectionQuestions:[{id:"re-1",question:"How well does RE reflect the Church of England Statement of Entitlement?",guidance:"RE should be academically rigorous, have a significant Christian content, and enable pupils to engage with questions of meaning.",evidenceRequired:["RE policy","Curriculum overview","Statement of Entitlement audit"]},{id:"re-2",question:"How high quality is RE teaching?",guidance:"RE should be taught by confident, well-trained staff using effective pedagogy.",evidenceRequired:["Lesson observations","Pupil work","Teacher subject knowledge"]},{id:"re-3",question:"How well do pupils achieve in RE?",guidance:"Outcomes in RE should be at least in line with core subjects.",evidenceRequired:["RE assessment data","Progress tracking","GCSE results if applicable"]},{id:"re-4",question:"How well does RE prepare pupils to live in diverse society?",guidance:"Pupils should learn about Christianity and other worldviews.",evidenceRequired:["Curriculum coverage","World religion content","Pupil understanding"]},{id:"re-5",question:"How effectively does RE enable pupils to engage with big questions?",guidance:"RE should provoke curiosity and enable theological thinking.",evidenceRequired:["Discussion evidence","Written work","Pupil voice"]}],keyIndicators:["RE meets Statement of Entitlement requirements","High-quality teaching by confident staff","Strong pupil outcomes comparable to core subjects","Good coverage of Christianity and other worldviews","Pupils can engage theologically with big questions"]}],ed={excellent:{label:"Excellent",color:"bg-green-500",description:"Exceptional practice"},good:{label:"Good",color:"bg-blue-500",description:"Effective practice"},requires_improvement:{label:"Requires Improvement",color:"bg-yellow-500",description:"Some weaknesses"},ineffective:{label:"Ineffective",color:"bg-red-500",description:"Significant weaknesses"},not_assessed:{label:"Not Assessed",color:"bg-gray-400",description:"Awaiting assessment"}};function ec(e,t){let s=el.find(t=>t.id===e);if(!s)return{userScore:0,evidenceCount:0};let a=0,i=0,r=0;for(let e of s.inspectionQuestions){let s=t[e.id];s?.rating&&"not_assessed"!==s.rating&&(i++,a+="excellent"===s.rating?100:"good"===s.rating?75:"requires_improvement"===s.rating?50:25),s?.evidenceCount&&(r+=s.evidenceCount)}return{userScore:i>0?Math.round(a/i):0,evidenceCount:r}}let em=(0,r.default)("church",[["path",{d:"M10 9h4",key:"u4k05v"}],["path",{d:"M12 7v5",key:"ma6bk"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"m18 9 3.52 2.147a1 1 0 0 1 .48.854V19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2v-6.999a1 1 0 0 1 .48-.854L6 9",key:"flvdwo"}],["path",{d:"M6 21V7a1 1 0 0 1 .376-.782l5-3.999a1 1 0 0 1 1.249.001l5 4A1 1 0 0 1 18 7v14",key:"a5i0n2"}]]);var eu=e.i(90597),ep=e.i(61911),eh=e.i(70273);let eg=(0,r.default)("cross",[["path",{d:"M4 9a2 2 0 0 0-2 2v2a2 2 0 0 0 2 2h4a1 1 0 0 1 1 1v4a2 2 0 0 0 2 2h2a2 2 0 0 0 2-2v-4a1 1 0 0 1 1-1h4a2 2 0 0 0 2-2v-2a2 2 0 0 0-2-2h-4a1 1 0 0 1-1-1V4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4a1 1 0 0 1-1 1z",key:"1xbrqy"}]]),ex={purple:"bg-white border-l-4 border-purple-500 text-purple-900 hover:bg-purple-50",blue:"bg-white border-l-4 border-blue-500 text-blue-900 hover:bg-blue-50",orange:"bg-white border-l-4 border-orange-500 text-orange-900 hover:bg-orange-50",teal:"bg-white border-l-4 border-teal-500 text-teal-900 hover:bg-teal-50",rose:"bg-white border-l-4 border-rose-500 text-rose-900 hover:bg-rose-50",violet:"bg-white border-l-4 border-violet-500 text-violet-900 hover:bg-violet-50",emerald:"bg-white border-l-4 border-emerald-500 text-emerald-900 hover:bg-emerald-50"},eb={vision:eg,wisdom:l.BookOpen,character:eh.Star,community:ep.Users,dignity:eu.Heart,worship:em,re:l.BookOpen};function ef({assessments:e={},setAssessments:a=()=>{},localEvidence:r={}}){let{user:n}=(0,s.useAuth)(),[o,l]=(0,i.useState)(new Set),[d,c]=(0,i.useState)(null),[m,u]=(0,i.useState)(!0),[p,h]=(0,i.useState)(!1),[g,x]=(0,i.useState)(""),[b,f]=(0,i.useState)(""),[y,v]=(0,i.useState)(!1),[j,k]=(0,i.useState)(null),[R,D]=(0,i.useState)(null),[L,z]=(0,i.useState)(void 0),[F,O]=(0,i.useState)(void 0),{userScore:H,totalEvidence:U}=function(e){let t=0,s=0,a=0;for(let i of el){let{userScore:r,evidenceCount:n}=ec(i.id,e);r>0&&(t+=r,a++),s+=n}return{userScore:a>0?Math.round(t/a):0,totalEvidence:s}}(e),B={vision:["leadership","vision"],wisdom:["quality-intent","quality-implementation","quality-impact"],character:["personal-development","character"],community:["behaviour","community"],dignity:["dignity","equality"],worship:["worship","collective-worship"],re:["re","religious-education"]},W=e=>e>=90?"text-green-600":e>=70?"text-blue-600":e>=40?"text-amber-600":"text-red-600";return(0,t.jsxs)("div",{className:"space-y-4",children:[m&&(0,t.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-6 mb-6 relative",children:[(0,t.jsx)("button",{onClick:()=>u(!1),className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition-colors",children:(0,t.jsx)($.X,{size:20})}),(0,t.jsxs)("div",{className:"flex items-start gap-4 pr-8",children:[(0,t.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,t.jsx)(em,{className:"w-6 h-6 text-purple-600"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-purple-900 text-lg mb-2",children:"About SIAMS Inspection"}),(0,t.jsx)("p",{className:"text-purple-800 text-sm leading-relaxed mb-3",children:"SIAMS (Statutory Inspection of Anglican and Methodist Schools) evaluates how well a church school's Christian vision enables pupils and adults to flourish. The framework focuses on 7 strands covering vision, curriculum, character, community, dignity, worship, and RE."}),(0,t.jsxs)("a",{href:"https://www.churchofengland.org/about/education-and-schools/church-schools-and-academies/siams-inspections",target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-purple-600 hover:text-purple-800 font-medium text-sm transition-colors",children:[(0,t.jsx)(I,{size:16}),"View official SIAMS guidance"]})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold text-gray-900 mb-2 flex items-center gap-2",children:[(0,t.jsx)(em,{className:"text-purple-600"}),"SIAMS Inspection Framework"]}),(0,t.jsx)("p",{className:"text-gray-600",children:"Statutory Inspection of Anglican and Methodist Schools"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-6",children:[(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-gray-400",children:"School Readiness"}),(0,t.jsxs)("div",{className:`text-2xl font-bold ${W(H)}`,children:[H,"%"]})]}),(0,t.jsxs)("div",{className:"text-right border-l border-gray-200 pl-4",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Evidence Items"}),(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:U})]})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:el.map(s=>{let{userScore:i,evidenceCount:n}=ec(s.id,e),m=(e=>{let t=B[e]||[e],s=0;for(let e of t)r[e]&&(s+=r[e].length);return s})(s.id),u=eb[s.id]||em;return(0,t.jsxs)("div",{className:`mb-4 border rounded-lg overflow-hidden transition-all duration-200 ${o.has(s.id)?"shadow-md":"shadow-sm"}`,children:[(0,t.jsxs)("div",{className:`transition-colors ${ex[s.color]||ex.purple}`,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between w-full p-4",children:[(0,t.jsxs)("button",{onClick:()=>{var e;let t;return e=s.id,void((t=new Set(o)).has(e)?t.delete(e):t.add(e),l(t))},className:"flex items-center gap-3 flex-1 text-left",children:[(0,t.jsx)("span",{className:"text-lg text-gray-400",children:o.has(s.id)?"â–¼":"â–¶"}),(0,t.jsx)(u,{size:24,className:"text-purple-500"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:s.name}),(0,t.jsx)("div",{onClick:e=>{var t;return t=s.id,void(e.stopPropagation(),c(d===t?null:t))},className:"text-gray-400 hover:text-purple-600 cursor-pointer p-1 rounded-full hover:bg-white/50 transition-colors",title:"Click for guidance",children:(0,t.jsx)(T,{size:16})})]}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:s.description})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4 mr-4",children:[m>0&&(0,t.jsxs)("div",{className:"text-right border-r border-gray-200 pr-4",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Evidence"}),(0,t.jsxs)("div",{className:"text-lg font-bold text-purple-600 flex items-center gap-1",children:[(0,t.jsx)(N.FileText,{size:14}),m]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("div",{className:"text-[10px] uppercase font-bold text-gray-400",children:"Readiness"}),(0,t.jsxs)("div",{className:`text-lg font-bold ${W(i)}`,children:[i,"%"]})]})]}),(0,t.jsxs)("button",{onClick:e=>{var t,a;e.stopPropagation(),t=s.name,a=i>=90?"Excellent":i>=70?"Good":i>=40?"Requires Improvement":"Ineffective",x(t),f(a||"Not Assessed"),h(!0)},className:"flex items-center gap-2 px-3 py-2 bg-purple-500 text-white text-sm font-medium rounded-lg hover:bg-purple-600 transition-colors shadow-sm",title:"Get Ed's analysis and recommendations",children:[(0,t.jsx)(M,{size:16}),(0,t.jsx)("span",{className:"hidden lg:inline",children:"Ask Ed"})]})]}),d===s.id&&(0,t.jsx)("div",{className:"px-4 pb-4 animate-in fade-in slide-in-from-top-2",children:(0,t.jsx)("div",{className:"bg-white/80 p-3 rounded-md border border-gray-200 text-sm shadow-inner",children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(T,{className:"text-purple-500 flex-shrink-0 mt-0.5",size:16}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-gray-800 font-medium mb-2",children:"Key Indicators:"}),(0,t.jsx)("ul",{className:"text-gray-600 space-y-1",children:s.keyIndicators.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)(w.CheckCircle,{size:14,className:"text-green-500 mt-0.5 flex-shrink-0"}),e]},s))})]})]})})})]}),o.has(s.id)&&(0,t.jsxs)("div",{className:"p-4 bg-white space-y-6 border-t border-gray-100",children:[m>0&&(0,t.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4 mb-4",children:[(0,t.jsxs)("h4",{className:"font-semibold text-purple-900 mb-3 flex items-center gap-2",children:[(0,t.jsx)(N.FileText,{size:18,className:"text-purple-600"}),"Local Evidence Files (",m,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:(e=>{let t=B[e]||[e],s=[];for(let e of t)r[e]&&(s=[...s,...r[e]]);return s})(s.id).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-2 bg-white rounded border border-purple-100",children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.fileName}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:e.matchedKeywords.slice(0,3).map((e,s)=>(0,t.jsx)("span",{className:"text-xs bg-purple-100 text-purple-700 px-1.5 py-0.5 rounded",children:e},s))})]}),(0,t.jsxs)("span",{className:`text-xs px-2 py-1 rounded-full ml-2 ${e.confidence>=.7?"bg-green-100 text-green-700":e.confidence>=.5?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-600"}`,children:[Math.round(100*e.confidence),"%"]})]},s))}),(0,t.jsx)("p",{className:"text-xs text-purple-600 mt-2",children:"ðŸ“ Scanned from local folder"})]}),s.inspectionQuestions.map(i=>{let r=e[i.id]||{},n=r.rating||"not_assessed",o=r.rationale||"";return(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:[(0,t.jsx)("div",{className:"flex justify-between items-start mb-4",children:(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h4",{className:"font-bold text-gray-900 text-lg",children:i.question}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:i.guidance})]})}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Assessment"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.entries(ed).map(([s,r])=>(0,t.jsx)("button",{onClick:()=>{var t;return t=i.id,void a({...e,[t]:{...e[t],rating:s}})},className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors border ${n===s?(e=>{switch(e){case"excellent":return"bg-green-100 text-green-700 border-green-300";case"good":return"bg-blue-100 text-blue-700 border-blue-300";case"requires_improvement":return"bg-yellow-100 text-yellow-700 border-yellow-300";case"ineffective":return"bg-red-100 text-red-700 border-red-300";default:return"bg-gray-100 text-gray-600 border-gray-300"}})(s):"bg-gray-50 text-gray-600 border-gray-200 hover:bg-gray-100"}`,children:r.label},s))})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Evidence & Rationale"}),(0,t.jsx)("textarea",{value:o,onChange:t=>{var s,r;return s=i.id,r=t.target.value,void a({...e,[s]:{...e[s],rationale:r}})},placeholder:"Describe your evidence for this rating...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-3",children:[(0,t.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Evidence Required:"}),(0,t.jsx)("ul",{className:"space-y-2",children:i.evidenceRequired.map((e,a)=>(0,t.jsxs)("li",{className:"flex items-start justify-between group text-sm p-2 rounded hover:bg-white",children:[(0,t.jsxs)("span",{className:"text-gray-600 flex-1 mr-2",children:["â€¢ ",e]}),(0,t.jsxs)("button",{onClick:()=>{var t,a;return t=i.id,a=s.name,void(k(t),D(e),z(a),O(void 0),v(!0))},className:"text-xs bg-purple-50 text-purple-600 px-2 py-1 rounded border border-purple-200 hover:bg-purple-100 transition-all flex items-center gap-1 opacity-0 group-hover:opacity-100",title:"Create action",children:[(0,t.jsx)(S.Plus,{size:12})," Action"]})]},a))})]}),(e[i.id]?.actions||[]).length>0&&(0,t.jsxs)("div",{className:"mt-4 border-t border-gray-100 pt-4",children:[(0,t.jsxs)("h5",{className:"font-semibold text-gray-700 text-sm mb-3 flex items-center gap-2",children:[(0,t.jsx)(A,{size:16}),"Action Plan (",(e[i.id]?.actions||[]).length,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:(e[i.id]?.actions||[]).map(e=>(0,t.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg p-3 shadow-sm hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase border ${(e=>{switch(e){case"high":return"bg-red-50 text-red-700 border-red-200";case"medium":return"bg-yellow-50 text-yellow-700 border-yellow-200";case"low":return"bg-green-50 text-green-700 border-green-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}})(e.priority)}`,children:e.priority}),(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.description})]}),(0,t.jsx)("button",{onClick:()=>{var t;return t=i.id,void(k(t),D(null),O(e),v(!0))},className:"text-gray-400 hover:text-purple-600",children:(0,t.jsx)(C,{size:14})})]}),e.rationale&&(0,t.jsxs)("p",{className:"text-xs text-gray-500 mb-2 italic",children:['"',e.rationale,'"']}),(0,t.jsxs)("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.assignee&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(E.User,{size:12})," ",e.assignee]}),e.dueDate&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:[(0,t.jsx)(P,{size:12})," ",new Date(e.dueDate).toLocaleDateString()]}),(0,t.jsx)("span",{className:`px-2 py-0.5 rounded text-[10px] font-medium ${"completed"===e.status?"bg-green-100 text-green-700":"in_progress"===e.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:e.status?.replace("_"," ")||"not started"})]})]},e.id))})]})]},i.id)})]})]},s.id)})})]}),p&&(0,t.jsx)("div",{className:"fixed right-6 top-32 w-96 z-40 animate-in slide-in-from-right",children:(0,t.jsx)(er,{selectedCategory:g,currentRating:b,onClose:()=>h(!1)})}),!p&&(0,t.jsxs)("button",{onClick:()=>h(!0),className:"fixed right-6 top-32 bg-gradient-to-r from-purple-500 to-violet-600 text-white px-4 py-3 rounded-xl shadow-lg hover:shadow-xl transition-all flex items-center gap-2 z-40",children:[(0,t.jsx)(M,{size:20}),(0,t.jsx)("span",{className:"font-medium",children:"Analyze with Ed"}),(0,t.jsx)(q.Sparkles,{size:16,className:"text-yellow-300"})]}),y&&(0,t.jsx)(_,{isOpen:y,onClose:()=>v(!1),onSave:t=>{let s;if(!j)return;let i=e[j]||{},r=i.actions||[];s=F?r.map(e=>e.id===t.id?t:e):[...r,t],a({...e,[j]:{...i,actions:s}}),v(!1),O(void 0)},categoryName:L||"",subCategoryName:el.flatMap(e=>e.inspectionQuestions).find(e=>e.id===j)?.question?.substring(0,50),evidenceItem:R||void 0,initialData:F})]})}let ey=(0,r.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]),ev=(0,r.default)("layout-list",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]]);var ej=e.i(40539);let ew=(0,r.default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),eN=(0,r.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),ek=(0,r.default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),eS=(0,r.default)("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]),eC=(0,r.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),eP={rose:"bg-rose-100 border-l-4 border-rose-500 text-rose-900",teal:"bg-teal-100 border-l-4 border-teal-500 text-teal-900",orange:"bg-orange-100 border-l-4 border-orange-500 text-orange-900",violet:"bg-violet-100 border-l-4 border-violet-500 text-violet-900",blue:"bg-blue-100 border-l-4 border-blue-500 text-blue-900",gray:"bg-gray-100 border-l-4 border-gray-500 text-gray-900"};function eE({actions:e}){let[s,a]=(0,i.useState)(!0),r=(0,i.useMemo)(()=>e.filter(e=>e.startDate&&e.dueDate),[e]),{minDate:n,maxDate:o,totalDays:l}=(0,i.useMemo)(()=>{if(0===r.length)return{minDate:new Date,maxDate:new Date,totalDays:0};let e=r.flatMap(e=>[new Date(e.startDate),new Date(e.dueDate)]),t=new Date(Math.min(...e.map(e=>e.getTime()))),s=new Date(Math.max(...e.map(e=>e.getTime())));t.setDate(t.getDate()-7),s.setDate(s.getDate()+7);let a=Math.ceil(Math.abs(s.getTime()-t.getTime())/864e5);return{minDate:t,maxDate:s,totalDays:a}},[r]),d=(0,i.useMemo)(()=>{if(!s)return{"All Actions":r.sort((e,t)=>new Date(e.startDate).getTime()-new Date(t.startDate).getTime())};let e={};return r.forEach(t=>{let s=t.category||"Uncategorized";e[s]||(e[s]=[]),e[s].push(t)}),e},[r,s]);if(0===r.length)return(0,t.jsxs)("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:[(0,t.jsx)("p",{className:"text-gray-500",children:"No actions with valid start and due dates to display."}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-1",children:"Edit actions to add dates to see them on the timeline."})]});let c=[],m=new Date(n);for(;m<=o;)c.push(new Date(m)),m.setMonth(m.getMonth()+1),m.setDate(1);return(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-bold text-gray-900",children:"Project Timeline"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Visual overview of action schedules"})]}),(0,t.jsxs)("div",{className:"bg-gray-100 p-1 rounded-lg flex border border-gray-200",children:[(0,t.jsxs)("button",{onClick:()=>a(!0),className:`px-3 py-1.5 rounded-md text-xs font-medium flex items-center gap-2 transition-all ${s?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(eS,{size:14})," Grouped"]}),(0,t.jsxs)("button",{onClick:()=>a(!1),className:`px-3 py-1.5 rounded-md text-xs font-medium flex items-center gap-2 transition-all ${!s?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(eC,{size:14})," Holistic"]})]})]}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("div",{className:"min-w-[800px] p-6 relative",children:[(0,t.jsx)("div",{className:"flex border-b border-gray-200 pb-2 mb-4 relative h-8",children:c.map((e,s)=>{let a=(e.getTime()-n.getTime())/864e5/l*100;return a<0||a>100?null:(0,t.jsx)("div",{className:"absolute text-xs font-semibold text-gray-500 transform -translate-x-1/2",style:{left:`${a}%`},children:e.toLocaleDateString("default",{month:"short",year:"2-digit"})},s)})}),(0,t.jsx)("div",{className:"absolute inset-0 top-24 pointer-events-none",children:c.map((e,s)=>{let a=(e.getTime()-n.getTime())/864e5/l*100;return a<0||a>100?null:(0,t.jsx)("div",{className:"absolute top-0 bottom-0 border-l border-gray-100 border-dashed",style:{left:`${a}%`}},s)})}),(0,t.jsx)("div",{className:"space-y-8 relative z-10",children:Object.entries(d).map(([e,s])=>(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-bold text-gray-700 mb-2 sticky left-0 bg-white/80 backdrop-blur-sm inline-block px-2 rounded",children:e}),(0,t.jsx)("div",{className:"space-y-2",children:s.map(e=>{var s,a,i;let r,o,d,c,m,u=(s=e.startDate,a=e.dueDate,r=new Date(s),o=new Date(a),d=Math.ceil((r.getTime()-n.getTime())/864e5),c=Math.ceil((o.getTime()-r.getTime())/864e5),{left:`${d/l*100}%`,width:`${Math.max(c/l*100,1)}%`});return(0,t.jsx)("div",{className:"relative h-8 flex items-center group",children:(0,t.jsxs)("div",{className:`absolute h-6 rounded shadow-sm cursor-pointer transition-all flex items-center px-2 overflow-hidden ${(i=e.category||"",m=f.find(e=>e.name===i),eP[m?.color||"gray"]||eP.gray)}`,style:u,children:[(0,t.jsx)("span",{className:"text-xs font-medium truncate",children:e.description}),(0,t.jsxs)("div",{className:"opacity-0 group-hover:opacity-100 absolute bottom-full left-1/2 -translate-x-1/2 mb-2 w-64 bg-gray-900 text-white text-xs rounded p-2 z-20 pointer-events-none transition-opacity shadow-lg",children:[(0,t.jsx)("div",{className:"font-bold mb-1",children:e.description}),(0,t.jsx)("div",{className:"text-gray-300 mb-1",children:e.category}),(0,t.jsxs)("div",{className:"flex justify-between text-gray-400",children:[(0,t.jsx)("span",{children:new Date(e.startDate).toLocaleDateString()}),(0,t.jsx)("span",{children:new Date(e.dueDate).toLocaleDateString()})]})]})]})},e.id)})})]},e))})]})})]})}let eA={rose:"bg-white border-rose-200 text-rose-700",teal:"bg-white border-teal-200 text-teal-700",orange:"bg-white border-orange-200 text-orange-700",violet:"bg-white border-violet-200 text-violet-700",blue:"bg-white border-blue-200 text-blue-700",gray:"bg-white border-gray-200 text-gray-700"};function eR({actions:e,onUpdateAction:s}){let[a,r]=(0,i.useState)("list"),[n,o]=(0,i.useState)("all"),[l,d]=(0,i.useState)("all"),[c,m]=(0,i.useState)(!1),[u,h]=(0,i.useState)(""),[g,x]=(0,i.useState)({key:"dueDate",direction:"asc"}),b=(0,i.useMemo)(()=>Array.from(new Set(e.map(e=>e.category).filter(Boolean))),[e]),y=(0,i.useMemo)(()=>e.filter(e=>(!c||"completed"!==e.status)&&("all"===n||e.status===n)&&("all"===l||e.category===l)&&(!u||!!e.description.toLowerCase().includes(u.toLowerCase())||!!e.assignee?.toLowerCase().includes(u.toLowerCase()))).sort((e,t)=>{let{key:s,direction:a}=g,i=e[s],r=t[s];if("dueDate"===s)i=i?new Date(i).getTime():1/0,r=r?new Date(r).getTime():1/0;else if("priority"===s){let e={high:3,medium:2,low:1};i=e[i]||0,r=e[r]||0}else i=(i||"").toString().toLowerCase(),r=(r||"").toString().toLowerCase();return i<r?"asc"===a?-1:1:i>r?"asc"===a?1:-1:0}),[e,c,n,l,u,g]),v=({columnKey:e})=>g.key!==e?(0,t.jsx)(ew,{size:14,className:"text-gray-400 opacity-0 group-hover:opacity-50"}):"asc"===g.direction?(0,t.jsx)(eN,{size:14,className:"text-blue-600"}):(0,t.jsx)(ek,{size:14,className:"text-blue-600"}),j=({label:e,columnKey:s})=>(0,t.jsx)("th",{className:"px-6 py-3 text-left text-xs font-bold text-gray-500 uppercase tracking-wider cursor-pointer hover:bg-gray-100 transition-colors group select-none",onClick:()=>{x(e=>({key:s,direction:e.key===s&&"asc"===e.direction?"desc":"asc"}))},children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e,(0,t.jsx)(v,{columnKey:s})]})});return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Action Plan Dashboard"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage and track all improvement actions across frameworks."})]}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("div",{className:"bg-gray-100 p-1 rounded-lg flex border border-gray-200",children:[(0,t.jsxs)("button",{onClick:()=>r("list"),className:`px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-2 transition-all ${"list"===a?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(ev,{size:16})," List"]}),(0,t.jsxs)("button",{onClick:()=>r("gantt"),className:`px-3 py-1.5 rounded-md text-sm font-medium flex items-center gap-2 transition-all ${"gantt"===a?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(ej.BarChart2,{size:16})," Timeline"]})]}),(0,t.jsxs)("div",{className:"bg-white border border-gray-300 rounded-lg px-4 py-2 flex items-center gap-2 shadow-sm",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Total Actions:"}),(0,t.jsx)("span",{className:"text-lg font-bold text-blue-600",children:e.length})]})]})]}),(0,t.jsxs)("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex flex-wrap gap-4 items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,t.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,t.jsx)(p.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",size:18}),(0,t.jsx)("input",{type:"text",placeholder:"Search actions...",value:u,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 border-l border-gray-200 pl-4",children:[(0,t.jsx)(ey,{size:16,className:"text-gray-400"}),(0,t.jsxs)("select",{value:n,onChange:e=>o(e.target.value),className:"border-none bg-transparent font-medium text-gray-700 focus:ring-0 cursor-pointer text-sm",children:[(0,t.jsx)("option",{value:"all",children:"All Statuses"}),(0,t.jsx)("option",{value:"open",children:"Open"}),(0,t.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,t.jsx)("option",{value:"completed",children:"Completed"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 border-l border-gray-200 pl-4",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Category:"}),(0,t.jsxs)("select",{value:l,onChange:e=>d(e.target.value),className:"border-none bg-transparent font-medium text-gray-700 focus:ring-0 cursor-pointer text-sm max-w-[200px] truncate",children:[(0,t.jsx)("option",{value:"all",children:"All Categories"}),b.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),(0,t.jsx)("div",{className:"flex items-center gap-2",children:(0,t.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer select-none text-sm font-medium text-gray-700",children:[(0,t.jsx)("input",{type:"checkbox",checked:c,onChange:e=>m(e.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-2 focus:ring-blue-500"}),"Hide Completed"]})})]}),"list"===a?(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:"bg-gray-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)(j,{label:"Action",columnKey:"description"}),(0,t.jsx)(j,{label:"Category",columnKey:"category"}),(0,t.jsx)(j,{label:"Assignee",columnKey:"assignee"}),(0,t.jsx)(j,{label:"Due Date",columnKey:"dueDate"}),(0,t.jsx)(j,{label:"Priority",columnKey:"priority"}),(0,t.jsx)(j,{label:"Status",columnKey:"status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:0===y.length?(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No actions found matching your filters."})}):y.map(e=>{var s;let a;return(0,t.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors group",children:[(0,t.jsx)("td",{className:"px-6 py-4",children:(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.description}),e.rationale&&(0,t.jsx)("span",{className:"text-xs text-gray-500 truncate max-w-md",children:e.rationale})]})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:`text-xs font-bold px-2 py-1 rounded border ${(s=e.category||"",a=f.find(e=>e.name===s),eA[a?.color||"gray"]||eA.gray)}`,children:e.category||"Uncategorized"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.assignee?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"h-6 w-6 rounded-full bg-gray-200 flex items-center justify-center text-xs font-medium text-gray-600",children:e.assignee.charAt(0)}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:e.assignee})]}):(0,t.jsx)("span",{className:"text-sm text-gray-400 italic",children:"Unassigned"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.dueDate?(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[(0,t.jsx)(P,{size:14}),new Date(e.dueDate).toLocaleDateString()]}):(0,t.jsx)("span",{className:"text-sm text-gray-400",children:"-"})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-bold rounded border uppercase ${(e=>{switch(e){case"high":return"text-red-700 bg-red-50 border-red-200";case"medium":return"text-amber-700 bg-amber-50 border-amber-200";case"low":return"text-green-700 bg-green-50 border-green-200";default:return"text-gray-600 bg-gray-50"}})(e.priority)}`,children:e.priority})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,t.jsx)("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-bold rounded border capitalize ${(e=>{switch(e){case"completed":return"bg-green-50 text-green-700 border-green-200";case"in_progress":return"bg-blue-50 text-blue-700 border-blue-200";default:return"bg-gray-50 text-gray-700 border-gray-200"}})(e.status)}`,children:e.status.replace("_"," ")})}),(0,t.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,t.jsx)("button",{className:"text-blue-600 hover:text-blue-900 opacity-0 group-hover:opacity-100 transition-opacity",children:"Edit"})})]},e.id)})})]})}):(0,t.jsx)(eE,{actions:y})]})}var eD=e.i(42920),eT=e.i(63488),eI=e.i(31278);let e$=(0,r.default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var eM=e.i(98919);let eq=(0,r.default)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]]);var eL=e.i(40160),ez=e.i(43531);let eF=(0,r.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);function eO(){let{user:e,organization:a}=(0,s.useAuth)(),[r,n]=(0,i.useState)("members"),[o,l]=(0,i.useState)([]),[d,c]=(0,i.useState)(!0),[m,u]=(0,i.useState)(null),[p,g]=(0,i.useState)([]),[x,b]=(0,i.useState)(!1),[f,y]=(0,i.useState)(!1),[j,w]=(0,i.useState)(""),[N,S]=(0,i.useState)("teacher"),[C,P]=(0,i.useState)(!1),[E,R]=(0,i.useState)(""),[D,T]=(0,i.useState)(null),[I,q]=(0,i.useState)([]),[L,F]=(0,i.useState)(null),[O,H]=(0,i.useState)(!1),[_,U]=(0,i.useState)(null),B=(0,i.useRef)(null),[W,G]=(0,i.useState)(null),[V,Y]=(0,i.useState)(null);(0,i.useEffect)(()=>{a?.id&&(Q(),K())},[a]);let Q=async()=>{if(a?.id){c(!0);try{let e=await fetch(`/api/organization/members?organizationId=${a.id}`);if(e.ok){let t=await e.json();l(t.members||[])}}catch(e){console.error("Error fetching members:",e)}finally{c(!1)}}},K=async()=>{if(a?.id){b(!0);try{let e=await fetch(`/api/organization/invitations?organizationId=${a.id}`);if(e.ok){let t=await e.json();g(t.invitations||[])}}catch(e){console.error("Error fetching invitations:",e)}finally{b(!1)}}},J=async t=>{if(t.preventDefault(),j.trim()&&a?.id&&e){P(!0),Y(null),G(null);try{if(!(await fetch("/api/organization/invite",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:j,role:N,organizationId:a.id,invitedBy:e.uid})})).ok)throw Error("Failed to send invitation");G(`Invitation sent to ${j}`),w(""),y(!1),K()}catch(e){Y(e.message||"Failed to send invitation")}finally{P(!1)}}},X=async(t,s)=>{if(a?.id&&e)try{let i=await fetch("/api/organization/members/update",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({organizationId:a.id,userId:t,newRole:s,requestedBy:e.uid})});if(!i.ok){let e=await i.json();throw Error(e.error||"Failed to update role")}G("Role updated successfully"),u(null),Q()}catch(e){Y(e.message)}},Z=async t=>{if(a?.id&&e&&confirm("Are you sure you want to remove this member?"))try{let s=await fetch(`/api/organization/members/update?organizationId=${a.id}&userId=${t}&requestedBy=${e.uid}`,{method:"DELETE"});if(!s.ok){let e=await s.json();throw Error(e.error||"Failed to remove member")}G("Member removed successfully"),Q()}catch(e){Y(e.message)}},ee=async t=>{if(a?.id&&e&&confirm("Cancel this invitation?"))try{if(!(await fetch(`/api/organization/invitations?invitationId=${t}&organizationId=${a.id}&requestedBy=${e.uid}`,{method:"DELETE"})).ok)throw Error("Failed to cancel invitation");G("Invitation cancelled"),K()}catch(e){Y(e.message)}},et=async t=>{if(a?.id&&e)try{if(!(await fetch("/api/organization/invitations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({invitationId:t,organizationId:a.id,requestedBy:e.uid})})).ok)throw Error("Failed to resend invitation");G("Invitation resent"),K()}catch(e){Y(e.message)}},es=async t=>{if(a?.id&&e){H(!0),q([]),T(null),U(null);try{let s=await fetch("/api/organization/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({csvContent:t,organizationId:a.id,invitedBy:e.uid,previewOnly:!0})}),i=await s.json();i.preview?(T(i.users),q(i.errors||[]),F(i.summary)):i.errors&&q(i.errors)}catch(e){Y(e.message)}finally{H(!1)}}},ea=async()=>{if(a?.id&&e&&E){H(!0),Y(null);try{let t=await fetch("/api/organization/import",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({csvContent:E,organizationId:a.id,invitedBy:e.uid,previewOnly:!1})}),s=await t.json();s.success?(U(s.results),G(`Successfully created ${s.results.created} invitations`),R(""),T(null),K()):(Y(s.error||"Import failed"),q(s.errors||[]))}catch(e){Y(e.message)}finally{H(!1)}}},ei=e=>{switch(e){case"admin":return(0,t.jsx)(eM.Shield,{className:"text-purple-600",size:18});case"slt":return(0,t.jsx)(M,{className:"text-blue-600",size:18});case"teacher":return(0,t.jsx)(ep.Users,{className:"text-green-600",size:18});default:return(0,t.jsx)(ep.Users,{className:"text-gray-600",size:18})}},er=e=>{switch(e){case"admin":return"bg-purple-100 text-purple-700 border-purple-200";case"slt":return"bg-blue-100 text-blue-700 border-blue-200";case"teacher":return"bg-green-100 text-green-700 border-green-200";default:return"bg-gray-100 text-gray-700 border-gray-200"}},en=a?.role==="admin";return a?(0,t.jsxs)("div",{className:"space-y-6",children:[W&&(0,t.jsxs)("div",{className:"p-4 bg-green-50 text-green-700 rounded-lg border border-green-200 flex items-center gap-3",children:[(0,t.jsx)(ez.Check,{className:"flex-shrink-0",size:20}),(0,t.jsx)("span",{children:W}),(0,t.jsx)("button",{onClick:()=>G(null),className:"ml-auto",children:(0,t.jsx)($.X,{size:18})})]}),V&&(0,t.jsxs)("div",{className:"p-4 bg-red-50 text-red-700 rounded-lg border border-red-200 flex items-center gap-3",children:[(0,t.jsx)(A,{className:"flex-shrink-0",size:20}),(0,t.jsx)("span",{children:V}),(0,t.jsx)("button",{onClick:()=>Y(null),className:"ml-auto",children:(0,t.jsx)($.X,{size:18})})]}),(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl p-6 text-white",children:(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"bg-white/20 p-4 rounded-xl",children:(0,t.jsx)(eD.Building,{size:32})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-2xl font-bold",children:a.name}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1 opacity-90",children:[ei(a.role),(0,t.jsxs)("span",{className:"text-sm",children:["Your role: ",a.role.toUpperCase()]})]})]})]})}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsxs)("nav",{className:"flex",children:[(0,t.jsxs)("button",{onClick:()=>n("members"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 border-b-2 transition-colors ${"members"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(ep.Users,{size:18}),"Team Members",(0,t.jsx)("span",{className:"ml-1 px-2 py-0.5 bg-gray-100 text-gray-600 rounded-full text-xs",children:o.length})]}),(0,t.jsxs)("button",{onClick:()=>n("invitations"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 border-b-2 transition-colors ${"invitations"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(eT.Mail,{size:18}),"Pending Invitations",p.length>0&&(0,t.jsx)("span",{className:"ml-1 px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded-full text-xs",children:p.length})]}),en&&(0,t.jsxs)("button",{onClick:()=>n("import"),className:`px-6 py-4 font-medium text-sm flex items-center gap-2 border-b-2 transition-colors ${"import"===r?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(eq,{size:18}),"Bulk Import"]})]})}),(0,t.jsxs)("div",{className:"p-6",children:["members"===r&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Team Members"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Manage users and their access levels"})]}),en&&(0,t.jsxs)("button",{onClick:()=>{n("invitations"),y(!0)},className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors",children:[(0,t.jsx)(e$,{size:18}),"Invite User"]})]}),d?(0,t.jsx)("div",{className:"flex justify-center py-12",children:(0,t.jsx)(eI.Loader2,{className:"animate-spin text-blue-600",size:32})}):(0,t.jsxs)("div",{className:"space-y-3",children:[o.map(s=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-300 transition-colors",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-indigo-500 flex items-center justify-center text-white font-bold text-lg",children:s.user.email[0].toUpperCase()}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:s.user.display_name||s.user.email}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:s.user.email})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[m===s.user.id&&en?(0,t.jsxs)("select",{value:s.role,onChange:e=>X(s.user.id,e.target.value),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[(0,t.jsx)("option",{value:"teacher",children:"Teacher"}),(0,t.jsx)("option",{value:"slt",children:"SLT"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]}):(0,t.jsxs)("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border ${er(s.role)} ${en?"cursor-pointer hover:opacity-80":""}`,onClick:()=>en&&u(s.user.id),children:[ei(s.role),(0,t.jsx)("span",{className:"text-sm font-medium",children:s.role.toUpperCase()}),en&&(0,t.jsx)(v.ChevronDown,{size:14})]}),en&&s.user.id!==e?.uid&&(0,t.jsx)("button",{onClick:()=>Z(s.user.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Remove member",children:(0,t.jsx)(eF,{size:18})})]})]},s.user.id)),0===o.length&&(0,t.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No members found."})]})]}),"invitations"===r&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Pending Invitations"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Users who haven't accepted their invitation yet"})]}),en&&(0,t.jsxs)("button",{onClick:()=>y(!f),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium transition-colors",children:[(0,t.jsx)(e$,{size:18}),f?"Cancel":"Invite User"]})]}),f&&en&&(0,t.jsxs)("form",{onSubmit:J,className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-4",children:"Send New Invitation"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,t.jsxs)("div",{className:"md:col-span-2",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),(0,t.jsx)("input",{type:"email",value:j,onChange:e=>w(e.target.value),placeholder:"user@school.edu",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),(0,t.jsxs)("select",{value:N,onChange:e=>S(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none",children:[(0,t.jsx)("option",{value:"teacher",children:"Teacher"}),(0,t.jsx)("option",{value:"slt",children:"SLT"}),(0,t.jsx)("option",{value:"admin",children:"Admin"})]})]})]}),(0,t.jsxs)("button",{type:"submit",disabled:C,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium disabled:opacity-50 flex items-center gap-2",children:[C?(0,t.jsx)(eI.Loader2,{className:"animate-spin",size:18}):(0,t.jsx)(eT.Mail,{size:18}),C?"Sending...":"Send Invitation"]})]}),x?(0,t.jsx)("div",{className:"flex justify-center py-12",children:(0,t.jsx)(eI.Loader2,{className:"animate-spin text-blue-600",size:32})}):(0,t.jsxs)("div",{className:"space-y-3",children:[p.map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"h-12 w-12 rounded-full bg-yellow-100 flex items-center justify-center text-yellow-600",children:(0,t.jsx)(z.Clock,{size:24})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.email}),(0,t.jsxs)("p",{className:"text-sm text-gray-500",children:["Invited ",new Date(e.created_at).toLocaleDateString(),e.invited_by_user&&` by ${e.invited_by_user.display_name||e.invited_by_user.email}`]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-lg border ${er(e.role)}`,children:[ei(e.role),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.role.toUpperCase()})]}),en&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>et(e.id),className:"p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors",title:"Resend invitation",children:(0,t.jsx)(k.RefreshCw,{size:18})}),(0,t.jsx)("button",{onClick:()=>ee(e.id),className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors",title:"Cancel invitation",children:(0,t.jsx)(eF,{size:18})})]})]})]},e.id)),0===p.length&&(0,t.jsx)("p",{className:"text-center text-gray-500 py-8",children:"No pending invitations."})]})]}),"import"===r&&en&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Bulk Import Users"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Upload a CSV file to invite multiple users at once"})]}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"bg-blue-100 p-3 rounded-lg",children:(0,t.jsx)(h.FileSpreadsheet,{className:"text-blue-600",size:24})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Step 1: Download Template"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1 mb-3",children:"Download our CSV template, fill in your users' details, then upload it below."}),(0,t.jsxs)("button",{onClick:()=>{window.location.href="/api/organization/template"},className:"flex items-center gap-2 px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition-colors",children:[(0,t.jsx)(eL.Download,{size:18}),"Download CSV Template"]})]})]})}),(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"bg-green-100 p-3 rounded-lg",children:(0,t.jsx)(eq,{className:"text-green-600",size:24})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Step 2: Upload Your File"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mt-1 mb-3",children:"Select your completed CSV file to preview and import users."}),(0,t.jsx)("input",{ref:B,type:"file",accept:".csv",onChange:e=>{let t=e.target.files?.[0];if(!t)return;let s=new FileReader;s.onload=e=>{let t=e.target?.result;R(t),es(t)},s.readAsText(t)},className:"hidden"}),(0,t.jsxs)("button",{onClick:()=>B.current?.click(),disabled:O,className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium transition-colors disabled:opacity-50",children:[O?(0,t.jsx)(eI.Loader2,{className:"animate-spin",size:18}):(0,t.jsx)(eq,{size:18}),O?"Processing...":"Select CSV File"]})]})]})}),(D||I.length>0)&&(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Import Preview"}),L&&(0,t.jsxs)("div",{className:"flex gap-4 mt-2 text-sm",children:[(0,t.jsxs)("span",{className:"text-green-600",children:[L.new," new users"]}),(0,t.jsxs)("span",{className:"text-yellow-600",children:[L.existing," already exist"]}),(0,t.jsxs)("span",{className:"text-red-600",children:[L.errors," errors"]})]})]}),I.length>0&&(0,t.jsxs)("div",{className:"p-4 bg-red-50 border-b border-red-200",children:[(0,t.jsx)("h4",{className:"font-medium text-red-700 mb-2",children:"Validation Errors"}),(0,t.jsx)("ul",{className:"text-sm text-red-600 space-y-1",children:I.map((e,s)=>(0,t.jsxs)("li",{children:["Row ",e.row,": ",e.message]},s))})]}),D&&D.length>0&&(0,t.jsx)("div",{className:"divide-y divide-gray-200 max-h-64 overflow-y-auto",children:D.map((e,s)=>(0,t.jsxs)("div",{className:"p-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:`h-8 w-8 rounded-full flex items-center justify-center text-white font-bold ${"new"===e.status?"bg-green-500":"bg-yellow-500"}`,children:e.email[0].toUpperCase()}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.displayName}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.email})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${er(e.role)}`,children:e.role.toUpperCase()}),"exists"===e.status&&(0,t.jsx)("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-700 rounded text-xs",children:"Already exists"})]})]},s))}),D&&L?.new>0&&0===I.length&&(0,t.jsxs)("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:()=>{R(""),T(null),q([])},className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:"Cancel"}),(0,t.jsxs)("button",{onClick:ea,disabled:O,className:"flex items-center gap-2 px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium disabled:opacity-50",children:[O?(0,t.jsx)(eI.Loader2,{className:"animate-spin",size:18}):(0,t.jsx)(ez.Check,{size:18}),O?"Importing...":`Import ${L.new} Users`]})]})]}),_&&(0,t.jsxs)("div",{className:"bg-green-50 rounded-lg p-6 border border-green-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,t.jsx)(ez.Check,{className:"text-green-600",size:24}),(0,t.jsx)("h3",{className:"font-semibold text-green-900",children:"Import Complete!"})]}),(0,t.jsxs)("div",{className:"text-sm text-green-700",children:[(0,t.jsxs)("p",{children:["âœ“ ",_.created," invitations created"]}),_.skipped>0&&(0,t.jsxs)("p",{children:["âŠ˜ ",_.skipped," skipped (already exist)"]}),_.errors?.length>0&&(0,t.jsxs)("p",{className:"text-red-600",children:["âœ— ",_.errors.length," failed"]})]})]})]})]})]})]}):(0,t.jsx)("div",{className:"text-center py-12",children:(0,t.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-8 max-w-md mx-auto",children:[(0,t.jsx)(A,{className:"text-yellow-600 mx-auto mb-4",size:48}),(0,t.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"No Organization Found"}),(0,t.jsx)("p",{className:"text-gray-600 mb-4",children:"Please complete the onboarding process to set up your school."}),(0,t.jsx)("a",{href:"/onboarding",className:"inline-block px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:"Complete Setup"})]})})}var eH=e.i(14764),e_=e.i(17923);let eU=(0,r.default)("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]),eB=(0,r.default)("maximize-2",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"m21 3-7 7",key:"1l2asr"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M9 21H3v-6",key:"wtvkvv"}]]),eW=[{icon:l.BookOpen,label:"What is EEF?",prompt:"What is the EEF and how can it help my school?"},{icon:G.Target,label:"Ofsted expects...",prompt:"What does Ofsted look for in Quality of Education?"},{icon:e_.BarChart3,label:"Reading gaps",prompt:"How can I improve reading outcomes using research?"},{icon:V.Lightbulb,label:"High-impact strategies",prompt:"What are the highest impact teaching strategies?"}];function eG({context:e}){let[s,a]=(0,i.useState)(!1),[r,n]=(0,i.useState)(!1),[o,l]=(0,i.useState)([]),[d,c]=(0,i.useState)(""),[m,u]=(0,i.useState)(!1),p=(0,i.useRef)(null),h=(0,i.useRef)(null);(0,i.useEffect)(()=>{p.current?.scrollIntoView({behavior:"smooth"})},[o]),(0,i.useEffect)(()=>{s&&!r&&h.current?.focus()},[s,r]);let g=async t=>{let s=t||d.trim();if(!s||m)return;let a={role:"user",content:s,timestamp:new Date};l(e=>[...e,a]),c(""),u(!0);try{let t=await fetch("/api/ed/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...o,a].map(e=>({role:e.role,content:e.content})),context:{...e,topic:s}})}),i=await t.json(),r={role:"assistant",content:i.response||"I'm sorry, I couldn't process that. Could you try again?",timestamp:new Date};l(e=>[...e,r])}catch(e){console.error("Chat error:",e),l(e=>[...e,{role:"assistant",content:"I'm having trouble connecting right now. Please try again in a moment.",timestamp:new Date}])}finally{u(!1)}};return s?(0,t.jsx)("div",{className:`fixed bottom-6 right-6 z-50 transition-all duration-300 ${r?"w-72":"w-96"}`,children:(0,t.jsxs)("div",{className:`bg-white rounded-2xl shadow-2xl border border-gray-200 overflow-hidden flex flex-col ${r?"h-14":"h-[32rem]"}`,children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-emerald-500 to-teal-600 text-white p-4 flex items-center justify-between cursor-pointer",onClick:()=>r&&n(!1),children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-white/20 rounded-full flex items-center justify-center",children:(0,t.jsx)(M,{size:22})}),(0,t.jsx)("div",{className:"absolute -bottom-0.5 -right-0.5 w-3 h-3 bg-green-400 rounded-full border-2 border-white"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-bold text-lg",children:"Ed"}),(0,t.jsx)("p",{className:"text-xs text-white/80",children:"Your AI School Improvement Partner"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),n(!r)},className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",children:r?(0,t.jsx)(eB,{size:18}):(0,t.jsx)(eU,{size:18})}),(0,t.jsx)("button",{onClick:e=>{e.stopPropagation(),a(!1)},className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors",children:(0,t.jsx)($.X,{size:18})})]})]}),!r&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4 bg-gray-50",children:[0===o.length?(0,t.jsxs)("div",{className:"text-center py-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-emerald-100 to-teal-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,t.jsx)(M,{className:"text-emerald-600",size:32})}),(0,t.jsx)("h4",{className:"font-bold text-gray-900 mb-2",children:"Hello! I'm Ed ðŸ‘‹"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 mb-4",children:"I can help you understand Ofsted expectations, explain EEF research, and suggest evidence-based improvements."}),(0,t.jsx)("div",{className:"grid grid-cols-2 gap-2",children:eW.map((e,s)=>(0,t.jsxs)("button",{onClick:()=>g(e.prompt),className:"flex items-center gap-2 p-2 bg-white border border-gray-200 rounded-lg text-left text-sm hover:border-emerald-300 hover:bg-emerald-50 transition-colors",children:[(0,t.jsx)(e.icon,{size:16,className:"text-emerald-600 flex-shrink-0"}),(0,t.jsx)("span",{className:"text-gray-700",children:e.label})]},s))})]}):o.map((e,s)=>(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsxs)("div",{className:`max-w-[85%] ${"user"===e.role?"bg-emerald-500 text-white rounded-2xl rounded-br-md":"bg-white text-gray-800 rounded-2xl rounded-bl-md shadow-sm border border-gray-100"} px-4 py-3`,children:["assistant"===e.role&&(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2 pb-2 border-b border-gray-100",children:[(0,t.jsx)(M,{size:16,className:"text-emerald-600"}),(0,t.jsx)("span",{className:"text-xs font-semibold text-emerald-600",children:"Ed"})]}),(0,t.jsx)("div",{className:`text-sm leading-relaxed ${"assistant"===e.role?"prose prose-sm":""}`,dangerouslySetInnerHTML:{__html:e.content.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>").replace(/\*(.*?)\*/g,"<em>$1</em>").replace(/^â€¢ /gm,"â€¢ ").replace(/^- /gm,"â€¢ ").replace(/\n/g,"<br/>")}})]})},s)),m&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsx)("div",{className:"bg-white text-gray-800 rounded-2xl rounded-bl-md shadow-sm border border-gray-100 px-4 py-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(eI.Loader2,{size:16,className:"animate-spin text-emerald-600"}),(0,t.jsx)("span",{className:"text-sm text-gray-500",children:"Ed is thinking..."})]})})}),(0,t.jsx)("div",{ref:p})]}),(0,t.jsxs)("div",{className:"p-4 bg-white border-t border-gray-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{ref:h,type:"text",value:d,onChange:e=>c(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g())},placeholder:"Ask Ed anything about school improvement...",className:"flex-1 px-4 py-2.5 bg-gray-100 border-0 rounded-xl focus:ring-2 focus:ring-emerald-500 focus:bg-white transition-all text-sm",disabled:m}),(0,t.jsx)("button",{onClick:()=>g(),disabled:!d.trim()||m,className:"p-2.5 bg-emerald-500 text-white rounded-xl hover:bg-emerald-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:(0,t.jsx)(eH.Send,{size:18})})]}),(0,t.jsx)("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Ed uses EEF research & Ofsted framework â€¢ Responses are AI-generated"})]})]})]})}):(0,t.jsxs)("button",{onClick:()=>a(!0),className:"fixed bottom-6 right-6 w-16 h-16 bg-gradient-to-br from-emerald-500 to-teal-600 text-white rounded-full shadow-lg hover:shadow-xl transition-all duration-300 flex items-center justify-center group z-50",title:"Chat with Ed",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(M,{size:28,className:"group-hover:scale-110 transition-transform"}),(0,t.jsx)(q.Sparkles,{size:14,className:"absolute -top-1 -right-1 text-yellow-300 animate-pulse"})]}),(0,t.jsx)("span",{className:"absolute -top-2 -left-2 bg-yellow-400 text-gray-900 text-xs font-bold px-2 py-0.5 rounded-full",children:"Ed"})]})}var eV=e.i(63059);let eY=(0,r.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),eQ=(0,r.default)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]),eK=[{id:"quality-of-education",title:"Quality of Education",ofstedArea:"Quality of Education",icon:l.BookOpen,color:"rose",subSections:["Intent","Implementation","Impact"]},{id:"behaviour-attitudes",title:"Behaviour and Attitudes",ofstedArea:"Behaviour and Attitudes",icon:ep.Users,color:"teal"},{id:"personal-development",title:"Personal Development",ofstedArea:"Personal Development",icon:R.TrendingUp,color:"orange"},{id:"leadership-management",title:"Leadership and Management",ofstedArea:"Leadership and Management",icon:eM.Shield,color:"violet"}],eJ={outstanding:"bg-green-100 text-green-800 border-green-300",good:"bg-blue-100 text-blue-800 border-blue-300",requires_improvement:"bg-yellow-100 text-yellow-800 border-yellow-300",inadequate:"bg-red-100 text-red-800 border-red-300",not_assessed:"bg-gray-100 text-gray-600 border-gray-300"};function eX({schoolName:e="Your School",assessments:s={},actions:a=[],observations:r=[],onClose:n}){let[o,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),[u,p]=(0,i.useState)(new Set(["quality-of-education"])),[h,g]=(0,i.useState)("generate"),x=async()=>{l(!0),await new Promise(e=>setTimeout(e,2e3));let t=eK.map(e=>{let t="not_assessed",a=Object.entries(s).filter(([t])=>t.toLowerCase().includes(e.id.split("-")[0]));if(a.length>0){let e=a.reduce((e,[t,s])=>e+("Outstanding"===s.schoolRating?4:"Good"===s.schoolRating?3:"Requires Improvement"===s.schoolRating?2:1),0)/a.length;t=e>=3.5?"outstanding":e>=2.5?"good":e>=1.5?"requires_improvement":"inadequate"}return{id:e.id,title:e.title,ofstedArea:e.ofstedArea,currentGrade:t,narrative:b(e.id,t),strengths:f(e.id),areasForDevelopment:y(e.id),evidence:j(e.id),actions:S(e.id),impact:C(e.id),nextSteps:P(e.id)}});c({schoolName:e,lastUpdated:new Date().toISOString(),overallEffectiveness:E(t),sections:t}),l(!1),g("preview")},b=(t,s)=>({"quality-of-education":`At ${e}, we have developed a curriculum that is ambitious for all pupils, including those with SEND. Our curriculum is carefully sequenced to build knowledge progressively, ensuring pupils develop deep understanding over time.

Teachers demonstrate strong subject knowledge and use effective pedagogical approaches. We have invested in validated schemes (e.g., Little Wandle for phonics, White Rose for mathematics) and ensure these are implemented with fidelity.

Pupil outcomes demonstrate that the majority of pupils, including disadvantaged pupils and those with SEND, are achieving well. Our reading outcomes show sustained improvement, with phonics pass rates above national average.`,"behaviour-attitudes":`Behaviour at ${e} is consistently good. We have high expectations which are clearly communicated and consistently applied. Pupils understand our behaviour expectations and the vast majority meet them.

Attendance is a priority. We have robust systems to monitor and improve attendance, with particular focus on persistent absence and vulnerable groups. Our attendance figures are in line with or above national averages.

Pupils demonstrate positive attitudes to learning. They are engaged, motivated, and take pride in their work.`,"personal-development":`${e} provides a rich and varied curriculum that develops pupils' character, resilience, and fundamental British values. Our PSHE curriculum is comprehensive and age-appropriate.

We provide extensive enrichment opportunities including clubs, visits, and visitors. All pupils have access to these opportunities regardless of background.

Pupils are well-prepared for life in modern Britain. They understand and respect diversity, and are equipped to be responsible citizens.`,"leadership-management":`Leaders at ${e} have a clear vision for the school and high ambitions for all pupils. We have developed a culture of continuous improvement underpinned by evidence-based practice.

Governance is strong, with governors providing appropriate support and challenge. Staff workload and wellbeing are priorities, and we have taken effective action to address these.

Safeguarding is effective. All staff understand their responsibilities, and appropriate policies and procedures are in place.`})[t]||"Narrative to be completed.",f=e=>({"quality-of-education":["Curriculum is ambitious and well-sequenced","Validated schemes implemented with fidelity","Strong phonics outcomes above national average","Teachers demonstrate secure subject knowledge","Effective use of assessment to identify gaps"],"behaviour-attitudes":["High expectations consistently applied","Attendance above national average","Positive learning culture embedded","Low exclusion rates","Pupils demonstrate respect and tolerance"],"personal-development":["Rich enrichment programme accessible to all","PSHE curriculum is comprehensive","British values explicitly taught","Pupils understand diversity and inclusion","Strong careers guidance (where applicable)"],"leadership-management":["Clear vision and high ambitions","Evidence-based approach to improvement","Effective governance","Staff wellbeing prioritised","Safeguarding is effective"]})[e]||[],y=e=>({"quality-of-education":["Continue to embed new curriculum in foundation subjects","Further develop adaptive teaching for SEND pupils","Improve consistency of feedback practice"],"behaviour-attitudes":["Reduce persistent absence for disadvantaged pupils","Further embed restorative approaches"],"personal-development":["Extend enrichment offer for all year groups","Develop pupil leadership opportunities"],"leadership-management":["Continue to develop middle leader capacity","Further embed research-informed practice"]})[e]||[],j=e=>["Curriculum documentation and long-term plans","Lesson observations and learning walks","Pupil work scrutiny","Assessment data and progress tracking","Pupil and parent voice surveys","Staff CPD records","Governor meeting minutes"],S=e=>{let t=a.filter(t=>t.category?.toLowerCase().includes(e.split("-")[0])).map(e=>e.title||e.description).slice(0,5);return t.length>0?t:["Actions linked from School Improvement Plan"]},C=e=>"Impact data shows improvement over time. Comparison with previous years demonstrates progress. [Link to data dashboard]",P=e=>"Continue to monitor through half-termly reviews. Adjust provision based on ongoing assessment data.",E=e=>{let t=e.map(e=>"outstanding"===e.currentGrade?4:"good"===e.currentGrade?3:"requires_improvement"===e.currentGrade?2:1),s=t.reduce((e,t)=>e+t,0)/t.length;return s>=3.5?"Outstanding":s>=2.5?"Good":s>=1.5?"Requires Improvement":"Inadequate"},A=async()=>{if(!d)return;let e=d.sections.map(e=>`## ${e.title}

${e.narrative}

**Strengths:**
${e.strengths.map(e=>`- ${e}`).join("\n")}`).join("\n\n---\n\n");await navigator.clipboard.writeText(e),alert("SEF content copied to clipboard!")};return(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-indigo-600 to-purple-700 text-white p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:(0,t.jsx)(N.FileText,{size:24})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"SEF Generator"}),(0,t.jsx)("p",{className:"text-indigo-200 text-sm",children:"Auto-generate your Self-Evaluation Form"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(q.Sparkles,{size:20,className:"text-yellow-300"}),(0,t.jsx)("span",{className:"text-sm",children:"AI-Powered"})]})]})}),(0,t.jsx)("div",{className:"border-b border-gray-200 bg-gray-50",children:(0,t.jsx)("nav",{className:"flex",children:[{id:"generate",label:"Generate",icon:q.Sparkles},{id:"preview",label:"Preview",icon:m.Eye},{id:"export",label:"Export",icon:eL.Download}].map(e=>(0,t.jsxs)("button",{onClick:()=>g(e.id),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 border-b-2 ${h===e.id?"border-indigo-500 text-indigo-600 bg-white":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(e.icon,{size:16}),e.label]},e.id))})}),(0,t.jsxs)("div",{className:"p-6",children:["generate"===h&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"bg-blue-50 rounded-lg p-4 border border-blue-200",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(M,{className:"text-blue-600 mt-0.5",size:20}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-blue-800",children:"Ed will generate your SEF"}),(0,t.jsx)("p",{className:"text-sm text-blue-700 mt-1",children:"Based on your framework assessments, evidence, actions, and lesson observations, Ed will create a comprehensive SEF document ready for inspection."})]})]})}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:Object.keys(s).length}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Assessments"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:a.length}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Actions"})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:r.length}),(0,t.jsx)("div",{className:"text-sm text-gray-600",children:"Observations"})]})]}),(0,t.jsx)("button",{onClick:x,disabled:o,className:"w-full py-4 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-medium hover:from-indigo-700 hover:to-purple-700 disabled:opacity-50 flex items-center justify-center gap-2",children:o?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.RefreshCw,{size:20,className:"animate-spin"}),"Generating SEF..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q.Sparkles,{size:20}),"Generate SEF Document"]})})]}),"preview"===h&&d&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6 border border-gray-200",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:d.schoolName}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Last updated: ",new Date(d.lastUpdated).toLocaleDateString()]})]}),(0,t.jsx)("div",{className:`px-4 py-2 rounded-lg font-bold text-lg ${"Outstanding"===d.overallEffectiveness?"bg-green-100 text-green-800":"Good"===d.overallEffectiveness?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:d.overallEffectiveness})]})}),(0,t.jsx)("div",{className:"space-y-3",children:d.sections.map(e=>(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,t.jsxs)("button",{onClick:()=>{var t;let s;return t=e.id,void((s=new Set(u)).has(t)?s.delete(t):s.add(t),p(s))},className:"w-full p-4 bg-gray-50 flex items-center justify-between hover:bg-gray-100",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[u.has(e.id)?(0,t.jsx)(v.ChevronDown,{size:20,className:"text-gray-400"}):(0,t.jsx)(eV.ChevronRight,{size:20,className:"text-gray-400"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.title})]}),(0,t.jsx)("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${eJ[e.currentGrade]}`,children:e.currentGrade.replace("_"," ")})]}),u.has(e.id)&&(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Narrative"}),(0,t.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-line bg-gray-50 p-3 rounded-lg",children:e.narrative})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h5",{className:"text-sm font-medium text-green-700 mb-2 flex items-center gap-1",children:[(0,t.jsx)(w.CheckCircle,{size:14}),"Strengths"]}),(0,t.jsx)("ul",{className:"text-sm text-gray-600 space-y-1",children:e.strengths.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-green-500 mt-1",children:"â€¢"}),e]},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h5",{className:"text-sm font-medium text-yellow-700 mb-2 flex items-center gap-1",children:[(0,t.jsx)(R.TrendingUp,{size:14}),"Areas for Development"]}),(0,t.jsx)("ul",{className:"text-sm text-gray-600 space-y-1",children:e.areasForDevelopment.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-yellow-500 mt-1",children:"â€¢"}),e]},s))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Evidence Sources"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:e.evidence.map((e,s)=>(0,t.jsx)("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs rounded",children:e},s))})]})]})]},e.id))})]}),"export"===h&&d&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Export Options"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Download your SEF in various formats for sharing with governors, inspectors, or for your records."})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("button",{onClick:()=>{let t=new Blob([d?`
SELF-EVALUATION FORM
${d.schoolName}
Last Updated: ${new Date(d.lastUpdated).toLocaleDateString()}
Overall Effectiveness: ${d.overallEffectiveness}

${d.sections.map(e=>`
${"=".repeat(50)}
${e.title.toUpperCase()}
Current Grade: ${e.currentGrade.replace("_"," ").toUpperCase()}
${"=".repeat(50)}

NARRATIVE:
${e.narrative}

STRENGTHS:
${e.strengths.map(e=>`â€¢ ${e}`).join("\n")}

AREAS FOR DEVELOPMENT:
${e.areasForDevelopment.map(e=>`â€¢ ${e}`).join("\n")}

EVIDENCE:
${e.evidence.map(e=>`â€¢ ${e}`).join("\n")}

LINKED ACTIONS:
${e.actions.map(e=>`â€¢ ${e}`).join("\n")}

IMPACT:
${e.impact}

NEXT STEPS:
${e.nextSteps}
`).join("\n\n")}
        `:""],{type:"text/plain"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`SEF_${e.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.txt`,a.click(),URL.revokeObjectURL(s)},className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 flex flex-col items-center gap-2",children:[(0,t.jsx)(eL.Download,{size:24,className:"text-blue-600"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Download as Text"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Plain text format"})]}),(0,t.jsxs)("button",{onClick:A,className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 flex flex-col items-center gap-2",children:[(0,t.jsx)(eY,{size:24,className:"text-green-600"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Copy to Clipboard"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Markdown format"})]}),(0,t.jsxs)("button",{onClick:()=>window.print(),className:"p-4 border border-gray-200 rounded-lg hover:bg-gray-50 flex flex-col items-center gap-2",children:[(0,t.jsx)(eQ,{size:24,className:"text-purple-600"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Print"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Print or save as PDF"})]}),(0,t.jsxs)("button",{disabled:!0,className:"p-4 border border-gray-200 rounded-lg opacity-50 cursor-not-allowed flex flex-col items-center gap-2",children:[(0,t.jsx)(N.FileText,{size:24,className:"text-gray-400"}),(0,t.jsx)("span",{className:"font-medium text-gray-900",children:"Word Document"}),(0,t.jsx)("span",{className:"text-xs text-gray-500",children:"Coming soon"})]})]}),(0,t.jsxs)("div",{className:"bg-purple-50 rounded-lg p-4 border border-purple-200",children:[(0,t.jsxs)("h4",{className:"font-medium text-purple-800 mb-2 flex items-center gap-2",children:[(0,t.jsx)(M,{size:18}),"Ed's Inspector Tips"]}),(0,t.jsxs)("ul",{className:"text-sm text-purple-700 space-y-1",children:[(0,t.jsx)("li",{children:"â€¢ Keep your SEF concise - inspectors prefer quality over quantity"}),(0,t.jsx)("li",{children:"â€¢ Update regularly (at least termly) to show you know your school"}),(0,t.jsx)("li",{children:"â€¢ Link evidence directly - don't make inspectors search"}),(0,t.jsx)("li",{children:"â€¢ Be honest about AFDs - inspectors respect self-awareness"}),(0,t.jsx)("li",{children:"â€¢ Show impact, not just intent - use data and examples"})]})]})]}),"generate"!==h&&!d&&(0,t.jsxs)("div",{className:"text-center py-12",children:[(0,t.jsx)(N.FileText,{size:48,className:"mx-auto text-gray-300 mb-4"}),(0,t.jsx)("p",{className:"text-gray-500",children:"Generate your SEF first"}),(0,t.jsx)("button",{onClick:()=>g("generate"),className:"mt-4 text-indigo-600 font-medium",children:"Go to Generate â†’"})]})]})]})}let eZ=["Quality of Education - Intent","Quality of Education - Implementation","Quality of Education - Impact","Reading/Phonics","Mathematics","Behaviour Management","SEND Provision","Assessment for Learning","Adaptive Teaching","Subject Knowledge"],e0=["English","Mathematics","Science","History","Geography","Art","Music","PE","Computing","RE","PSHE","MFL","Phonics","Reading","Writing","Foundation Subjects"],e1=["Nursery","Reception","Year 1","Year 2","Year 3","Year 4","Year 5","Year 6"],e2={1:{label:"Inadequate",color:"bg-red-500",description:"Significant concerns"},2:{label:"Requires Improvement",color:"bg-yellow-500",description:"Not yet good"},3:{label:"Good",color:"bg-blue-500",description:"Effective practice"},4:{label:"Outstanding",color:"bg-green-500",description:"Exceptional practice"}};function e5({isOpen:e,onClose:s,onSave:a,initialData:r,currentUser:n}){let[o,d]=(0,i.useState)("details"),[c,u]=(0,i.useState)({date:new Date().toISOString().split("T")[0],duration:20,ratings:{subjectKnowledge:3,pedagogicalSkills:3,adaptiveTeaching:3,assessment:3,behaviour:3,engagement:3},isSchemeFollowed:!0,isCPDNeeded:!1,isSupportPlanNeeded:!1,observerId:n?.id||"",observerName:n?.name||"",...r}),[p,h]=(0,i.useState)(!1),[g,x]=(0,i.useState)(null);if(!e)return null;let b=(e,t)=>{u(s=>({...s,ratings:{...s.ratings,[e]:t}}))},f=()=>{let e=c.ratings;if(!e)return"requires_improvement";let t=Object.values(e),s=t.reduce((e,t)=>e+t,0)/t.length;return s>=3.5?"outstanding":s>=2.5?"good":s>=1.5?"requires_improvement":"inadequate"},y=async()=>{h(!0),await new Promise(e=>setTimeout(e,1500));let e=c.ratings,t=e?Object.entries(e).filter(([e,t])=>t<=2).map(([e,t])=>e.replace(/([A-Z])/g," $1").toLowerCase()):[],s="**Ed's Analysis:**\n\n";0===t.length?s+="âœ… This lesson demonstrates strong practice across all areas. Consider sharing this teacher's approaches in CPD sessions.\n\n**EEF Connection:** High-quality teaching is the most important lever schools have to improve pupil outcomes.":(s+=`âš ï¸ Areas needing attention: ${t.join(", ")}.

`,t.some(e=>e.includes("adaptive"))&&(s+="**EEF Insight:** Adaptive teaching (differentiation) shows +4 months progress when done well. Recommend CPD on responsive teaching strategies.\n\n"),t.some(e=>e.includes("assessment"))&&(s+="**EEF Insight:** Feedback (+6 months) relies on effective assessment. Consider training on formative assessment techniques.\n\n"),c.isSchemeFollowed||(s+="ðŸš¨ **Critical:** Scheme not being followed. This needs immediate leadership intervention. If the scheme is validated (e.g., Little Wandle, White Rose), fidelity is essential for impact.\n\n")),c.isSupportPlanNeeded&&(s+="\nðŸ“‹ **Recommendation:** Create a formal support plan with clear targets and weekly monitoring."),x(s),h(!1)},v=({label:e,value:s,onChange:a,description:i})=>(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-700",children:e}),i&&(0,t.jsx)("p",{className:"text-xs text-gray-500",children:i})]}),(0,t.jsx)("span",{className:`text-xs px-2 py-1 rounded font-medium ${4===s?"bg-green-100 text-green-700":3===s?"bg-blue-100 text-blue-700":2===s?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:e2[s].label})]}),(0,t.jsx)("div",{className:"flex gap-2",children:[1,2,3,4].map(e=>(0,t.jsx)("button",{onClick:()=>a(e),className:`flex-1 py-2 rounded-lg text-sm font-medium transition-all ${s===e?`${e2[e].color} text-white shadow-md`:"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:e},e))})]});return(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-violet-600 to-purple-700 text-white p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:(0,t.jsx)(m.Eye,{size:24})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"Lesson Observation"}),(0,t.jsx)("p",{className:"text-violet-200 text-sm",children:"Record teaching quality evidence"})]})]}),(0,t.jsx)("button",{onClick:s,className:"p-2 hover:bg-white/20 rounded-lg",children:(0,t.jsx)($.X,{size:24})})]})}),(0,t.jsx)("div",{className:"border-b border-gray-200 bg-gray-50",children:(0,t.jsx)("nav",{className:"flex",children:[{id:"details",label:"Details",icon:l.BookOpen},{id:"ratings",label:"Ratings",icon:eh.Star},{id:"notes",label:"Notes",icon:O.MessageSquare},{id:"summary",label:"Summary",icon:G.Target}].map(e=>(0,t.jsxs)("button",{onClick:()=>d(e.id),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 border-b-2 transition-colors ${o===e.id?"border-violet-500 text-violet-600 bg-white":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[(0,t.jsx)(e.icon,{size:16}),e.label]},e.id))})}),(0,t.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["details"===o&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),(0,t.jsx)("input",{type:"date",value:c.date,onChange:e=>u({...c,date:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration (mins)"}),(0,t.jsxs)("select",{value:c.duration,onChange:e=>u({...c,duration:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500",children:[(0,t.jsx)("option",{value:10,children:"10 minutes (Drop-in)"}),(0,t.jsx)("option",{value:20,children:"20 minutes (Learning Walk)"}),(0,t.jsx)("option",{value:30,children:"30 minutes (Part Lesson)"}),(0,t.jsx)("option",{value:45,children:"45 minutes (Full Lesson)"}),(0,t.jsx)("option",{value:60,children:"60 minutes (Extended)"})]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Teacher"}),(0,t.jsx)("input",{type:"text",value:c.teacher||"",onChange:e=>u({...c,teacher:e.target.value}),placeholder:"Teacher name",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),(0,t.jsxs)("select",{value:c.subject||"",onChange:e=>u({...c,subject:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500",children:[(0,t.jsx)("option",{value:"",children:"Select subject..."}),e0.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Year Group"}),(0,t.jsxs)("select",{value:c.yearGroup||"",onChange:e=>u({...c,yearGroup:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500",children:[(0,t.jsx)("option",{value:"",children:"Select year..."}),e1.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Focus Area"}),(0,t.jsxs)("select",{value:c.focusArea||"",onChange:e=>u({...c,focusArea:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500",children:[(0,t.jsx)("option",{value:"",children:"Select focus..."}),eZ.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]}),"ratings"===o&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("div",{className:"bg-gray-50 rounded-lg p-3 mb-4",children:(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,t.jsx)("strong",{children:"Rating Scale:"})," 1 = Inadequate, 2 = Requires Improvement, 3 = Good, 4 = Outstanding"]})}),(0,t.jsx)(v,{label:"Subject Knowledge",description:"Does the teacher have secure knowledge of the subject?",value:c.ratings?.subjectKnowledge||3,onChange:e=>b("subjectKnowledge",e)}),(0,t.jsx)(v,{label:"Pedagogical Skills",description:"Are explanations clear? Is content well-sequenced?",value:c.ratings?.pedagogicalSkills||3,onChange:e=>b("pedagogicalSkills",e)}),(0,t.jsx)(v,{label:"Adaptive Teaching",description:"Is teaching adapted for different learners including SEND?",value:c.ratings?.adaptiveTeaching||3,onChange:e=>b("adaptiveTeaching",e)}),(0,t.jsx)(v,{label:"Assessment & Feedback",description:"Is assessment used to check understanding? Is feedback effective?",value:c.ratings?.assessment||3,onChange:e=>b("assessment",e)}),(0,t.jsx)(v,{label:"Behaviour Management",description:"Are expectations clear? Is behaviour consistently managed?",value:c.ratings?.behaviour||3,onChange:e=>b("behaviour",e)}),(0,t.jsx)(v,{label:"Pupil Engagement",description:"Are pupils engaged and making progress in the lesson?",value:c.ratings?.engagement||3,onChange:e=>b("engagement",e)}),(0,t.jsxs)("div",{className:"mt-6 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:[(0,t.jsx)("h4",{className:"font-medium text-yellow-800 mb-3",children:"Critical Checks"}),(0,t.jsxs)("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.isSchemeFollowed,onChange:e=>u({...c,isSchemeFollowed:e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Curriculum scheme is being followed with fidelity"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.isCPDNeeded,onChange:e=>u({...c,isCPDNeeded:e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"CPD recommended for this teacher"})]}),(0,t.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,t.jsx)("input",{type:"checkbox",checked:c.isSupportPlanNeeded,onChange:e=>u({...c,isSupportPlanNeeded:e.target.checked}),className:"w-5 h-5 rounded border-gray-300 text-violet-600 focus:ring-violet-500"}),(0,t.jsx)("span",{className:"text-sm text-gray-700",children:"Formal support plan needed"})]})]})]}),"notes"===o&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(Q,{size:14,className:"inline mr-1 text-green-600"}),"Strengths Observed"]}),(0,t.jsx)("textarea",{value:c.strengths||"",onChange:e=>u({...c,strengths:e.target.value}),placeholder:"What went well in this lesson?",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(R.TrendingUp,{size:14,className:"inline mr-1 text-yellow-600"}),"Areas for Development"]}),(0,t.jsx)("textarea",{value:c.areasForDevelopment||"",onChange:e=>u({...c,areasForDevelopment:e.target.value}),placeholder:"What could be improved?",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[(0,t.jsx)(G.Target,{size:14,className:"inline mr-1 text-blue-600"}),"Next Steps / Actions"]}),(0,t.jsx)("textarea",{value:c.nextSteps||"",onChange:e=>u({...c,nextSteps:e.target.value}),placeholder:"Specific actions for the teacher...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500"})]})]}),"summary"===o&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-xl p-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Overall Judgement"}),(0,t.jsx)("div",{className:"grid grid-cols-4 gap-2",children:["outstanding","good","requires_improvement","inadequate"].map(e=>(0,t.jsx)("button",{onClick:()=>u({...c,overallJudgement:e}),className:`py-3 rounded-lg text-sm font-medium transition-all ${c.overallJudgement===e||!c.overallJudgement&&f()===e?"outstanding"===e?"bg-green-500 text-white":"good"===e?"bg-blue-500 text-white":"requires_improvement"===e?"bg-yellow-500 text-white":"bg-red-500 text-white":"bg-white border border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:e.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())},e))})]}),(0,t.jsxs)("div",{className:"bg-emerald-50 rounded-xl p-4 border border-emerald-200",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(M,{size:20,className:"text-emerald-600"}),(0,t.jsx)("span",{className:"font-medium text-emerald-800",children:"Ed's Analysis"})]}),(0,t.jsx)("button",{onClick:y,disabled:p,className:"text-sm px-3 py-1 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 disabled:opacity-50",children:p?"Analyzing...":"Generate Insights"})]}),g?(0,t.jsx)("div",{className:"text-sm text-emerald-900 whitespace-pre-wrap",children:g}):(0,t.jsx)("p",{className:"text-sm text-emerald-700",children:'Click "Generate Insights" for Ed\'s EEF-backed analysis of this observation.'})]}),(c.isCPDNeeded||c.isSupportPlanNeeded||!c.isSchemeFollowed)&&(0,t.jsxs)("div",{className:"bg-red-50 rounded-xl p-4 border border-red-200",children:[(0,t.jsxs)("h4",{className:"font-medium text-red-800 mb-2 flex items-center gap-2",children:[(0,t.jsx)(j.AlertTriangle,{size:18}),"Actions Required"]}),(0,t.jsxs)("ul",{className:"text-sm text-red-700 space-y-1",children:[!c.isSchemeFollowed&&(0,t.jsx)("li",{children:"â€¢ Scheme not being followed - leadership intervention required"}),c.isCPDNeeded&&(0,t.jsx)("li",{children:"â€¢ CPD recommended - add to professional development plan"}),c.isSupportPlanNeeded&&(0,t.jsx)("li",{children:"â€¢ Formal support plan needed - schedule meeting with teacher"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Link to Ofsted Framework Area"}),(0,t.jsxs)("select",{value:c.linkedFrameworkArea||"",onChange:e=>u({...c,linkedFrameworkArea:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500",children:[(0,t.jsx)("option",{value:"",children:"Select area (optional)..."}),(0,t.jsx)("option",{value:"quality-intent",children:"Quality of Education - Intent"}),(0,t.jsx)("option",{value:"quality-implementation",children:"Quality of Education - Implementation"}),(0,t.jsx)("option",{value:"quality-impact",children:"Quality of Education - Impact"}),(0,t.jsx)("option",{value:"behaviour",children:"Behaviour & Attitudes"}),(0,t.jsx)("option",{value:"personal-development",children:"Personal Development"}),(0,t.jsx)("option",{value:"leadership",children:"Leadership & Management"})]})]})]})]}),(0,t.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-gray-50 flex items-center justify-between",children:[(0,t.jsx)("button",{onClick:s,className:"px-4 py-2 text-gray-700 hover:bg-gray-200 rounded-lg",children:"Cancel"}),(0,t.jsxs)("button",{onClick:()=>{a({id:c.id||`obs-${Date.now()}`,date:c.date||new Date().toISOString().split("T")[0],teacher:c.teacher||"",subject:c.subject||"",yearGroup:c.yearGroup||"",focusArea:c.focusArea||"",duration:c.duration||20,ratings:c.ratings||{subjectKnowledge:3,pedagogicalSkills:3,adaptiveTeaching:3,assessment:3,behaviour:3,engagement:3},strengths:c.strengths||"",areasForDevelopment:c.areasForDevelopment||"",nextSteps:c.nextSteps||"",isSchemeFollowed:c.isSchemeFollowed??!0,isCPDNeeded:c.isCPDNeeded??!1,isSupportPlanNeeded:c.isSupportPlanNeeded??!1,overallJudgement:c.overallJudgement||f(),observerId:c.observerId||"",observerName:c.observerName||"",linkedFrameworkArea:c.linkedFrameworkArea}),s()},className:"px-6 py-2 bg-violet-600 text-white rounded-lg hover:bg-violet-700 flex items-center gap-2",children:[(0,t.jsx)(F,{size:18}),"Save Observation"]})]})]})})}var e4=e.i(75505);let e3=(0,r.default)("hard-drive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]),e6=(0,r.default)("cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]),e7=[".pdf",".doc",".docx",".txt",".rtf",".xls",".xlsx",".csv",".ppt",".pptx",".png",".jpg",".jpeg",".gif"],e8=["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/plain","application/rtf","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","text/csv","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation","image/png","image/jpeg","image/gif"];function e9({onScanComplete:e,onAnalysisComplete:s,onClose:a}){let[r,n]=(0,i.useState)(null),[o,l]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),[m,u]=(0,i.useState)(null),[p,h]=(0,i.useState)({current:0,total:0}),[g,x]=(0,i.useState)(!1),[b,f]=(0,i.useState)(null),[y,v]=(0,i.useState)("files"),S=(0,i.useRef)(null),C=(0,i.useRef)(null),P=async e=>new Promise((t,s)=>{let a=new FileReader;e.type.startsWith("text/")||e.name.endsWith(".txt")||e.name.endsWith(".csv")?(a.onload=()=>t(a.result),a.onerror=()=>s(a.error),a.readAsText(e)):"application/pdf"===e.type?t(`[PDF Document: ${e.name}]`):e.type.startsWith("image/")?t(`[Image: ${e.name}]`):t(`[Document: ${e.name}, Type: ${e.type}]`)}),E=e=>{let t="."+e.name.split(".").pop()?.toLowerCase();return e7.includes(t)||e8.includes(e.type)},A=async t=>{let s=t.target.files;if(!s)return;l(!0),u(null),c(null);let a=[],i=0,r=Array.from(s).filter(e=>E(e)).length;h({current:0,total:r});let n=0;for(let e of Array.from(s)){if(!E(e)){i++;continue}h({current:++n,total:r});try{let t=await P(e);a.push({name:e.name,path:e.webkitRelativePath||e.name,type:e.type,size:e.size,content:t.substring(0,1e4),lastModified:new Date(e.lastModified)})}catch(e){i++}}c({totalFiles:s.length,processedFiles:a.length,skippedFiles:i,supportedTypes:[...new Set(a.map(e=>e.type))],files:a}),e(a),l(!1)},R=async t=>{let s=t.target.files;if(!s)return;l(!0),u(null);let a=[];for(let e of Array.from(s))try{let t=await P(e);a.push({name:e.name,path:e.name,type:e.type,size:e.size,content:t.substring(0,1e4),lastModified:new Date(e.lastModified)})}catch(t){console.warn(`Failed to read ${e.name}`)}if(d){let e=[...d.files,...a];c({...d,totalFiles:e.length,processedFiles:e.length,files:e})}else c({totalFiles:a.length,processedFiles:a.length,skippedFiles:0,supportedTypes:[...new Set(a.map(e=>e.type))],files:a});e(a),l(!1)},D=async()=>{if(d&&0!==d.files.length){x(!0),u(null);try{let e=await fetch("/api/analyze-local",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:d.files})});if(!e.ok)throw Error("Analysis failed");let t=await e.json();f({totalMatches:t.totalMatches,matchesByArea:t.matchesByArea,allMatches:t.allMatches}),v("evidence"),s?.(t)}catch(e){u(e.message||"Analysis failed")}finally{x(!1)}}};return(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-700 text-white p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:(0,t.jsx)(e3,{size:24})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-xl font-bold",children:"Local Evidence Scanner"}),(0,t.jsx)("p",{className:"text-blue-200 text-sm",children:"Scan folders from your computer"})]})]}),a&&(0,t.jsx)("button",{onClick:a,className:"p-2 hover:bg-white/20 rounded-lg",children:(0,t.jsx)($.X,{size:24})})]})}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[!d&&!o&&(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("label",{className:"p-6 border-2 border-dashed border-gray-300 rounded-xl hover:border-blue-500 hover:bg-blue-50 transition-colors text-center group cursor-pointer block",children:[(0,t.jsx)(e4.FolderOpen,{size:40,className:"mx-auto mb-3 text-gray-400 group-hover:text-blue-500"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Scan Folder"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Select an evidence folder from your computer"}),(0,t.jsx)("p",{className:"text-xs text-blue-500 mt-2 font-medium",children:"Click here to open folder picker"}),(0,t.jsx)("input",{type:"file",webkitdirectory:"",multiple:!0,onChange:A,className:"hidden"})]}),(0,t.jsxs)("label",{className:"p-6 border-2 border-dashed border-gray-300 rounded-xl hover:border-green-500 hover:bg-green-50 transition-colors text-center group cursor-pointer block",children:[(0,t.jsx)(eq,{size:40,className:"mx-auto mb-3 text-gray-400 group-hover:text-green-500"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Upload Files"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Select individual files to scan"}),(0,t.jsx)("p",{className:"text-xs text-green-500 mt-2 font-medium",children:"Click here to select files"}),(0,t.jsx)("input",{type:"file",multiple:!0,accept:e7.join(","),onChange:R,className:"hidden"})]})]}),(0,t.jsx)("input",{ref:S,type:"file",multiple:!0,accept:e7.join(","),onChange:R,className:"hidden"}),(0,t.jsx)("input",{ref:C,type:"file",webkitdirectory:"",multiple:!0,onChange:A,className:"hidden"}),o&&(0,t.jsxs)("div",{className:"text-center py-8",children:[(0,t.jsx)(eI.Loader2,{size:48,className:"mx-auto mb-4 text-blue-500 animate-spin"}),(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:"Scanning Files..."}),(0,t.jsxs)("p",{className:"text-sm text-gray-600 mt-1",children:[p.current," of ",p.total," files processed"]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-4 max-w-xs mx-auto",children:(0,t.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all",style:{width:`${p.total?p.current/p.total*100:0}%`}})})]}),m&&(0,t.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[(0,t.jsx)(j.AlertTriangle,{className:"text-red-500 flex-shrink-0"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-red-800",children:"Scan Failed"}),(0,t.jsx)("p",{className:"text-sm text-red-600",children:m})]})]}),d&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(w.CheckCircle,{className:"text-green-500"}),(0,t.jsx)("h4",{className:"font-semibold text-green-800",children:"Scan Complete!"})]}),!b&&(0,t.jsx)("button",{onClick:D,disabled:g,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 flex items-center gap-2 text-sm font-medium",children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eI.Loader2,{size:16,className:"animate-spin"}),"Analyzing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(N.FileText,{size:16}),"ðŸ” Find Evidence"]})})]}),(0,t.jsxs)("div",{className:"grid grid-cols-4 gap-4 text-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:d.totalFiles}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Total Found"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-green-600",children:d.processedFiles}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Processed"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-gray-400",children:d.skippedFiles}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Skipped"})]}),b&&(0,t.jsxs)("div",{children:[(0,t.jsx)("div",{className:"text-2xl font-bold text-purple-600",children:b.totalMatches}),(0,t.jsx)("div",{className:"text-xs text-gray-500",children:"Evidence Matches"})]})]})]}),b&&(0,t.jsx)("div",{className:"border-b border-gray-200",children:(0,t.jsxs)("nav",{className:"flex",children:[(0,t.jsxs)("button",{onClick:()=>v("files"),className:`flex-1 py-2 text-sm font-medium border-b-2 ${"files"===y?"border-blue-500 text-blue-600":"border-transparent text-gray-500"}`,children:["ðŸ“ Files (",d.files.length,")"]}),(0,t.jsxs)("button",{onClick:()=>v("evidence"),className:`flex-1 py-2 text-sm font-medium border-b-2 ${"evidence"===y?"border-purple-500 text-purple-600":"border-transparent text-gray-500"}`,children:["ðŸŽ¯ Evidence (",b.totalMatches,")"]})]})}),"files"===y&&(0,t.jsxs)("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-gray-50 px-4 py-2 border-b border-gray-200",children:(0,t.jsxs)("h4",{className:"font-medium text-gray-700",children:["Scanned Files (",d.files.length,")"]})}),(0,t.jsx)("div",{className:"max-h-64 overflow-y-auto",children:d.files.map((e,s)=>{var a,i;return(0,t.jsxs)("div",{className:"flex items-center gap-3 px-4 py-2 border-b border-gray-100 last:border-b-0 hover:bg-gray-50",children:[(0,t.jsx)("span",{className:"text-xl",children:(a=e.type).startsWith("image/")?"ðŸ–¼ï¸":a.includes("pdf")?"ðŸ“„":a.includes("word")||a.includes("document")?"ðŸ“":a.includes("sheet")||a.includes("excel")||a.includes("csv")?"ðŸ“Š":a.includes("presentation")||a.includes("powerpoint")?"ðŸ“½ï¸":"ðŸ“"}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 truncate",children:e.path})]}),(0,t.jsx)("span",{className:"text-xs text-gray-400",children:(i=e.size)<1024?i+" B":i<1048576?(i/1024).toFixed(1)+" KB":(i/1048576).toFixed(1)+" MB"})]},s)})})]}),"evidence"===y&&b&&(0,t.jsx)("div",{className:"space-y-3",children:0===Object.entries(b.matchesByArea).length?(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(j.AlertTriangle,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"No evidence matches found in these files."}),(0,t.jsx)("p",{className:"text-sm",children:"Try scanning folders with more school documents."})]}):Object.entries(b.matchesByArea).map(([e,s])=>(0,t.jsxs)("div",{className:`border rounded-lg overflow-hidden ${{"quality-intent":"bg-rose-50 border-rose-200","quality-implementation":"bg-rose-50 border-rose-200","quality-impact":"bg-rose-50 border-rose-200",behaviour:"bg-teal-50 border-teal-200","personal-development":"bg-orange-50 border-orange-200",leadership:"bg-violet-50 border-violet-200",safeguarding:"bg-red-50 border-red-200",send:"bg-blue-50 border-blue-200","early-years":"bg-pink-50 border-pink-200",reading:"bg-emerald-50 border-emerald-200"}[e]||"bg-gray-50 border-gray-200"}`,children:[(0,t.jsxs)("div",{className:"px-4 py-2 border-b bg-white/50",children:[(0,t.jsx)("h5",{className:"font-medium text-gray-900",children:s[0]?.frameworkAreaLabel||e}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[s.length," match(es)"]})]}),(0,t.jsx)("div",{className:"divide-y divide-gray-100",children:s.slice(0,3).map((e,s)=>{var a;return(0,t.jsxs)("div",{className:"px-4 py-2 bg-white/30",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900 truncate flex-1",children:e.fileName}),(0,t.jsxs)("span",{className:`text-xs px-2 py-0.5 rounded-full ${(a=e.confidence)>=.7?"bg-green-100 text-green-700":a>=.5?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-600"}`,children:[Math.round(100*e.confidence),"% match"]})]}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1 mb-1",children:e.matchedKeywords.slice(0,4).map((e,s)=>(0,t.jsx)("span",{className:"text-xs bg-white px-1.5 py-0.5 rounded border border-gray-200",children:e},s))}),e.relevantExcerpt&&(0,t.jsx)("p",{className:"text-xs text-gray-500 italic truncate",children:e.relevantExcerpt})]},s)})})]},e))}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)("button",{onClick:()=>{c(null),f(null),v("files"),h({current:0,total:0})},className:"flex-1 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 flex items-center justify-center gap-2",children:[(0,t.jsx)(k.RefreshCw,{size:18}),"Scan Again"]}),(0,t.jsxs)("button",{onClick:()=>S.current?.click(),className:"flex-1 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 flex items-center justify-center gap-2",children:[(0,t.jsx)(eq,{size:18}),"Add More Files"]})]})]}),!d&&!o&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,t.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Supported File Types"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:["PDF","Word","Excel","PowerPoint","Text","CSV","Images"].map(e=>(0,t.jsx)("span",{className:"px-2 py-1 bg-white border border-gray-200 rounded text-xs text-gray-600",children:e},e))})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,t.jsx)(e6,{size:16}),(0,t.jsx)("span",{children:"Cloud storage (Google Drive, OneDrive) coming soon"})]})})]})]})}var te=e.i(54385),tt=e.i(39312);let ts=({organizationId:e,ofstedAssessments:s,siamsAssessments:a,actions:r,evidenceCount:n,isChurchSchool:o=!1,onNavigate:d})=>{let c,m,u,p,h,g,[x,b]=(0,i.useState)(new Date);(0,i.useEffect)(()=>{let e=setInterval(()=>b(new Date),6e4);return()=>clearInterval(e)},[]);let f=0===(c=Object.values(s).filter(e=>e.schoolRating&&"not_assessed"!==e.schoolRating).map(e=>{switch(e.schoolRating){case"exceptional":return 100;case"strong_standard":return 80;case"expected_standard":return 60;case"needs_attention":return 40;case"urgent_improvement":return 20;default:return 0}})).length?0:Math.round(c.reduce((e,t)=>e+t,0)/c.length),y=0===(m=Object.values(a).filter(e=>e.rating&&"not_assessed"!==e.rating).map(e=>{switch(e.rating){case"excellent":return 100;case"good":return 75;case"requires_improvement":return 50;case"ineffective":return 25;default:return 0}})).length?0:Math.round(m.reduce((e,t)=>e+t,0)/m.length),v=(u=[],p=new Date,r.forEach(e=>{if("completed"!==e.status&&e.dueDate){let t=Math.ceil((new Date(e.dueDate).getTime()-p.getTime())/864e5);t<0?u.push({id:e.id,type:"overdue",title:e.title,description:`${Math.abs(t)} days overdue`,dueDate:e.dueDate,priority:"critical",action:"Update Status",link:"actions"}):t<=7&&u.push({id:e.id,type:"deadline",title:e.title,description:`Due in ${t} days`,dueDate:e.dueDate,priority:t<=3?"high":"medium",action:"View Action",link:"actions"})}}),(h=Object.values(s).filter(e=>e.schoolRating&&"not_assessed"!==e.schoolRating).length)<6&&u.push({id:"assessment-gap",type:"gap",title:"Incomplete Self-Assessment",description:`${6-h} Ofsted areas not yet assessed`,priority:"high",action:"Complete Assessment",link:"ofsted"}),n<10&&u.push({id:"evidence-gap",type:"gap",title:"Limited Evidence",description:`Only ${n} evidence items found`,priority:"medium",action:"Scan Documents",link:"dashboard"}),u.sort((e,t)=>{let s={critical:0,high:1,medium:2};return s[e.priority]-s[t.priority]})),k=r.filter(e=>"completed"===e.status).length,S=r.filter(e=>"in_progress"===e.status).length;return(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-medium text-gray-900 tracking-tight",children:(g=x.getHours())<12?"Good morning":g<17?"Good afternoon":"Good evening"}),(0,t.jsxs)("p",{className:"text-gray-500 mt-1",children:["Happy ",x.toLocaleDateString("en-GB",{weekday:"long"})," Â· Here's your school improvement snapshot"]})]}),(0,t.jsxs)("div",{className:"text-right",children:[(0,t.jsx)("p",{className:"text-sm text-gray-400",children:x.toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})}),(0,t.jsx)("p",{className:"text-3xl font-light text-gray-900 tabular-nums",children:x.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit"})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6 hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>d("ofsted"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gray-200 flex items-center justify-center",children:(0,t.jsx)(G.Target,{className:"w-5 h-5 text-gray-700"})}),(0,t.jsxs)("span",{className:"text-3xl font-medium text-gray-900",children:[f,"%"]})]}),(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"Ofsted Readiness"}),(0,t.jsx)("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-1.5",children:(0,t.jsx)("div",{className:"h-1.5 rounded-full bg-gray-900 transition-all",style:{width:`${f}%`}})}),(0,t.jsxs)("p",{className:"mt-3 text-sm text-gray-500 flex items-center gap-1",children:["View Framework ",(0,t.jsx)(X.ArrowRight,{className:"w-3 h-3"})]})]}),o&&(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6 hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>d("siams"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gray-200 flex items-center justify-center",children:(0,t.jsx)(l.BookOpen,{className:"w-5 h-5 text-gray-700"})}),(0,t.jsxs)("span",{className:"text-3xl font-medium text-gray-900",children:[y,"%"]})]}),(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"SIAMS Readiness"}),(0,t.jsx)("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-1.5",children:(0,t.jsx)("div",{className:"h-1.5 rounded-full bg-gray-900 transition-all",style:{width:`${y}%`}})}),(0,t.jsxs)("p",{className:"mt-3 text-sm text-gray-500 flex items-center gap-1",children:["View Framework ",(0,t.jsx)(X.ArrowRight,{className:"w-3 h-3"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6 hover:bg-gray-100 transition-colors cursor-pointer",onClick:()=>d("actions"),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gray-200 flex items-center justify-center",children:(0,t.jsx)(te.ClipboardCheck,{className:"w-5 h-5 text-gray-700"})}),(0,t.jsxs)("span",{className:"text-3xl font-medium text-gray-900",children:[k,"/",r.length]})]}),(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"Actions Complete"}),(0,t.jsxs)("div",{className:"mt-3 flex gap-2",children:[(0,t.jsxs)("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded-md",children:[S," In Progress"]}),(0,t.jsxs)("span",{className:"px-2 py-1 bg-gray-200 text-gray-700 text-xs rounded-md",children:[r.length-k-S," Draft"]})]}),(0,t.jsxs)("p",{className:"mt-3 text-sm text-gray-500 flex items-center gap-1",children:["View Actions ",(0,t.jsx)(X.ArrowRight,{className:"w-3 h-3"})]})]}),(0,t.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gray-200 flex items-center justify-center",children:(0,t.jsx)(N.FileText,{className:"w-5 h-5 text-gray-700"})}),(0,t.jsx)("span",{className:"text-3xl font-medium text-gray-900",children:n})]}),(0,t.jsx)("h3",{className:"font-medium text-gray-900",children:"Evidence Items"}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Documents matched to framework"}),(0,t.jsxs)("p",{className:"mt-3 text-sm text-gray-500 flex items-center gap-1",children:["Scan More ",(0,t.jsx)(X.ArrowRight,{className:"w-3 h-3"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(j.AlertTriangle,{className:"w-4 h-4 text-amber-500"}),(0,t.jsx)("h2",{className:"font-medium text-gray-900",children:"Needs Attention"})]}),v.length>0&&(0,t.jsx)("span",{className:"px-2 py-0.5 bg-amber-100 text-amber-700 text-xs font-medium rounded-full",children:v.length})]}),(0,t.jsx)("div",{className:"divide-y divide-gray-50",children:0===v.length?(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)(w.CheckCircle,{className:"w-10 h-10 text-gray-300 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-500",children:"All caught up! No urgent items."})]}):v.slice(0,5).map(e=>(0,t.jsx)("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>d(e.link),children:(0,t.jsxs)("div",{className:"flex items-start justify-between",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:`w-8 h-8 rounded-lg flex items-center justify-center flex-shrink-0 ${"critical"===e.priority?"bg-red-50":"high"===e.priority?"bg-amber-50":"bg-gray-100"}`,children:(0,t.jsx)(A,{className:`w-4 h-4 ${"critical"===e.priority?"text-red-500":"high"===e.priority?"text-amber-500":"text-gray-500"}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.title}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]}),(0,t.jsx)("button",{className:"px-3 py-1.5 text-xs font-medium bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",children:e.action})]})},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-2xl border border-gray-100 overflow-hidden",children:[(0,t.jsxs)("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center gap-2",children:[(0,t.jsx)(tt.Zap,{className:"w-4 h-4 text-gray-400"}),(0,t.jsx)("h2",{className:"font-medium text-gray-900",children:"Quick Actions"})]}),(0,t.jsxs)("div",{className:"p-4 space-y-2",children:[(0,t.jsxs)("button",{onClick:()=>d("ofsted"),className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-xl text-left transition-colors flex items-center justify-between group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-white border border-gray-200 flex items-center justify-center",children:(0,t.jsx)(G.Target,{className:"w-5 h-5 text-gray-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:"Complete Self-Assessment"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Review Ofsted judgement areas"})]})]}),(0,t.jsx)(X.ArrowRight,{className:"w-4 h-4 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),(0,t.jsxs)("button",{onClick:()=>d("actions"),className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-xl text-left transition-colors flex items-center justify-between group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-white border border-gray-200 flex items-center justify-center",children:(0,t.jsx)(te.ClipboardCheck,{className:"w-5 h-5 text-gray-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:"Manage Actions"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Track improvement priorities"})]})]}),(0,t.jsx)(X.ArrowRight,{className:"w-4 h-4 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),(0,t.jsxs)("button",{onClick:()=>d("reports"),className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-xl text-left transition-colors flex items-center justify-between group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-white border border-gray-200 flex items-center justify-center",children:(0,t.jsx)(N.FileText,{className:"w-5 h-5 text-gray-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:"Generate Reports"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"SEF, SDP, Pupil Premium"})]})]}),(0,t.jsx)(X.ArrowRight,{className:"w-4 h-4 text-gray-400 group-hover:translate-x-1 transition-transform"})]}),(0,t.jsxs)("button",{onClick:()=>d("voice"),className:"w-full px-4 py-3 bg-gray-50 hover:bg-gray-100 rounded-xl text-left transition-colors flex items-center justify-between group",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"w-10 h-10 rounded-lg bg-white border border-gray-200 flex items-center justify-center",children:(0,t.jsx)(R.TrendingUp,{className:"w-5 h-5 text-gray-600"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-medium text-gray-900",children:"Voice Observation"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Record lesson observations"})]})]}),(0,t.jsx)(X.ArrowRight,{className:"w-4 h-4 text-gray-400 group-hover:translate-x-1 transition-transform"})]})]})]})]})]})};var ta=e.i(31343);let ti=(0,r.default)("pause",[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]]),tr=(0,r.default)("square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),tn=(0,r.default)("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]),to=(0,r.default)("wand-sparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),tl=({onSaveObservation:e})=>{let[s,a]=(0,i.useState)(!1),[r,n]=(0,i.useState)(!1),[o,l]=(0,i.useState)(0),[d,c]=(0,i.useState)(null),[m,p]=(0,i.useState)(""),[h,g]=(0,i.useState)(!1),[x,b]=(0,i.useState)(!1),[f,y]=(0,i.useState)(null),[v,S]=(0,i.useState)(null),[C,P]=(0,i.useState)(""),[E,A]=(0,i.useState)(""),[R,D]=(0,i.useState)(""),T=(0,i.useRef)(null),I=(0,i.useRef)([]),$=(0,i.useRef)(null);(0,i.useEffect)(()=>()=>{$.current&&clearInterval($.current)},[]);let M=e=>{let t=Math.floor(e/60);return`${t.toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`},q=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),t=new MediaRecorder(e);T.current=t,I.current=[],t.ondataavailable=e=>{e.data.size>0&&I.current.push(e.data)},t.onstop=()=>{c(new Blob(I.current,{type:"audio/webm"})),e.getTracks().forEach(e=>e.stop())},t.start(1e3),a(!0),S(null),$.current=setInterval(()=>l(e=>e+1),1e3)}catch(e){S("Could not access microphone. Please check permissions.")}},L=async()=>{if(d){g(!0),S(null);try{let e=new FormData;e.append("audio",d,"recording.webm");let t=await fetch("/api/voice/transcribe",{method:"POST",body:e});if(t.ok){let e=await t.json();p(e.transcript)}else p(`Lesson observation for ${C||"the teacher"}. Strong subject knowledge demonstrated. Good use of questioning. Behaviour well managed. Clear learning objectives. Differentiation evident through tiered success criteria. Areas for development: pace could be quicker, more student talk needed.`)}catch{p("Demo transcript - Voice recording captured successfully. Strong teaching observed with good engagement.")}finally{g(!1)}}},z=async()=>{if(m){b(!0);try{let e=await fetch("/api/voice/process-observation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:m,teacherName:C,subject:E,yearGroup:R})}),t=e.ok?await e.json():{id:`obs_${Date.now()}`,teacherName:C||"Teacher",date:new Date().toISOString().split("T")[0],duration:M(o),subject:E||"Not specified",yearGroup:R||"Not specified",transcript:m,summary:"A well-structured lesson with strong subject knowledge and effective assessment.",strengths:["Strong subject knowledge","Effective questioning","Good differentiation"],areasForDevelopment:["Increase lesson pace","More student discussion"],ratings:{subjectKnowledge:4,pedagogy:3,assessment:4,behaviour:3},eefRecommendations:["Feedback (+6 months): Enhance AfL","Collaborative learning (+5 months)"],suggestedActions:["Observe exemplar lesson","Coaching on pace"],ofstedLinks:["Curriculum and Teaching","Achievement"]};y(t)}catch{S("Processing failed")}finally{b(!1)}}},O=e=>e>=4?"bg-green-500":e>=3?"bg-blue-500":e>=2?"bg-yellow-500":"bg-red-500";return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-violet-600 to-purple-600 rounded-2xl p-6 text-white",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)(u.Mic,{className:"w-8 h-8"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Voice-to-Observation"})]}),(0,t.jsx)("p",{className:"text-violet-100",children:"Record your notes and let AI structure them"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[(0,t.jsxs)("h2",{className:"font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,t.jsx)(u.Mic,{className:"w-5 h-5 text-violet-500"})," Record Observation"]}),(0,t.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,t.jsx)("input",{type:"text",value:C,onChange:e=>P(e.target.value),placeholder:"Teacher name",className:"px-3 py-2 border rounded-lg"}),(0,t.jsx)("input",{type:"text",value:E,onChange:e=>A(e.target.value),placeholder:"Subject",className:"px-3 py-2 border rounded-lg"}),(0,t.jsx)("input",{type:"text",value:R,onChange:e=>D(e.target.value),placeholder:"Year Group",className:"px-3 py-2 border rounded-lg"})]}),(0,t.jsxs)("div",{className:"flex flex-col items-center py-8 bg-gray-50 rounded-xl",children:[(0,t.jsx)("div",{className:"text-5xl font-mono font-bold text-gray-800 mb-6",children:M(o)}),s&&!r&&(0,t.jsx)("div",{className:"flex items-center gap-1 mb-6",children:[1,2,3,4,5].map(e=>(0,t.jsx)("div",{className:"w-1 bg-red-500 rounded-full animate-pulse",style:{height:`${24*Math.random()+8}px`}},e))}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[!s&&!d&&(0,t.jsx)("button",{onClick:q,className:"p-4 bg-red-500 text-white rounded-full hover:bg-red-600 shadow-lg",children:(0,t.jsx)(u.Mic,{className:"w-8 h-8"})}),s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>{T.current&&s&&(r?(T.current.resume(),$.current=setInterval(()=>l(e=>e+1),1e3)):(T.current.pause(),$.current&&clearInterval($.current)),n(!r))},className:"p-3 bg-yellow-500 text-white rounded-full hover:bg-yellow-600",children:r?(0,t.jsx)(ta.Play,{className:"w-6 h-6"}):(0,t.jsx)(ti,{className:"w-6 h-6"})}),(0,t.jsx)("button",{onClick:()=>{T.current&&s&&(T.current.stop(),a(!1),n(!1),$.current&&clearInterval($.current))},className:"p-4 bg-gray-700 text-white rounded-full hover:bg-gray-800",children:(0,t.jsx)(tr,{className:"w-6 h-6"})})]}),d&&!s&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>new Audio(URL.createObjectURL(d)).play(),className:"p-3 bg-blue-500 text-white rounded-full",children:(0,t.jsx)(tn,{className:"w-6 h-6"})}),(0,t.jsx)("button",{onClick:()=>{c(null),p(""),l(0),y(null)},className:"p-3 bg-gray-500 text-white rounded-full",children:(0,t.jsx)(k.RefreshCw,{className:"w-6 h-6"})})]})]})]}),v&&(0,t.jsxs)("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 flex items-center gap-2",children:[(0,t.jsx)(j.AlertTriangle,{className:"w-5 h-5"}),v]})]}),d&&(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("h2",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[(0,t.jsx)(N.FileText,{className:"w-5 h-5 text-violet-500"})," Transcript"]}),!m&&(0,t.jsx)("button",{onClick:L,disabled:h,className:"px-4 py-2 bg-violet-500 text-white rounded-lg flex items-center gap-2 disabled:opacity-50",children:h?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eI.Loader2,{className:"w-4 h-4 animate-spin"})," Transcribing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(to,{className:"w-4 h-4"})," Transcribe"]})})]}),m?(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("textarea",{value:m,onChange:e=>p(e.target.value),className:"w-full h-32 p-4 border rounded-lg font-mono text-sm"}),(0,t.jsx)("div",{className:"flex justify-end",children:(0,t.jsx)("button",{onClick:z,disabled:x,className:"px-6 py-2 bg-gradient-to-r from-violet-500 to-purple-500 text-white rounded-lg flex items-center gap-2 disabled:opacity-50",children:x?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eI.Loader2,{className:"w-4 h-4 animate-spin"})," Processing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(to,{className:"w-4 h-4"})," Process with AI"]})})})]}):(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(N.FileText,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"Click Transcribe to convert recording to text"})]})]}),f&&(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 bg-gradient-to-r from-violet-50 to-purple-50 border-b flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(w.CheckCircle,{className:"w-5 h-5 text-green-500"}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"font-semibold",children:[f.teacherName," â€¢ ",f.subject]}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:[f.yearGroup," â€¢ ",f.date]})]})]}),(0,t.jsxs)("button",{onClick:()=>e(f),className:"px-4 py-2 bg-green-500 text-white rounded-lg flex items-center gap-2",children:[(0,t.jsx)(F,{className:"w-4 h-4"})," Save"]})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-2",children:"Summary"}),(0,t.jsx)("p",{className:"text-gray-700 bg-gray-50 p-4 rounded-lg",children:f.summary})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-semibold mb-3",children:"Ratings"}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Object.entries(f.ratings).map(([e,s])=>(0,t.jsxs)("div",{className:"p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,t.jsx)("span",{className:"text-sm capitalize",children:e.replace(/([A-Z])/g," $1")}),(0,t.jsxs)("span",{className:`px-2 py-0.5 text-xs text-white rounded ${O(s)}`,children:[s,"/4"]})]}),(0,t.jsx)("div",{className:"flex gap-1",children:[1,2,3,4].map(e=>(0,t.jsx)("div",{className:`flex-1 h-2 rounded ${e<=s?O(s):"bg-gray-200"}`},e))})]},e))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-green-900 mb-3",children:"Strengths"}),(0,t.jsx)("ul",{className:"space-y-2",children:f.strengths.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2 text-sm text-green-800",children:[(0,t.jsx)(w.CheckCircle,{className:"w-4 h-4 mt-0.5"}),e]},s))})]}),(0,t.jsxs)("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-amber-900 mb-3",children:"Development Areas"}),(0,t.jsx)("ul",{className:"space-y-2",children:f.areasForDevelopment.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2 text-sm text-amber-800",children:[(0,t.jsx)(J,{className:"w-4 h-4 mt-0.5"}),e]},s))})]})]}),(0,t.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-semibold text-blue-900 mb-3",children:"EEF Recommendations"}),(0,t.jsx)("ul",{className:"space-y-2",children:f.eefRecommendations.map((e,s)=>(0,t.jsxs)("li",{className:"text-sm text-blue-800",children:["ðŸ“š ",e]},s))})]})]})]})]})},td=(0,r.default)("circle-question-mark",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),tc=({schoolData:e,ofstedAssessments:s,actions:a,evidenceCount:r})=>{let[n,o]=(0,i.useState)(!1),[d,c]=(0,i.useState)(null),[m,u]=(0,i.useState)(null),[h,g]=(0,i.useState)("lead"),[x,b]=(0,i.useState)([]),[f,y]=(0,i.useState)(""),[N,k]=(0,i.useState)(!1),S=[{id:"lead",name:"Lead Inspector",icon:p.Search,focus:"Overall effectiveness, leadership"},{id:"curriculum",name:"Curriculum Deep Diver",icon:l.BookOpen,focus:"Subject leadership, curriculum design"},{id:"safeguarding",name:"Safeguarding Lead",icon:eM.Shield,focus:"Child protection, culture of vigilance"},{id:"send",name:"SEND Specialist",icon:ep.Users,focus:"Inclusion, adaptive teaching, support"},{id:"eyfs",name:"EYFS Expert",icon:G.Target,focus:"Early years provision, development"}],C=async()=>{o(!0),b([]);try{let t=await fetch("/api/mock-inspector/simulate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({schoolData:e,assessments:s,persona:h})});if(t.ok){let e=await t.json();c(e)}else c(P())}catch{c(P())}finally{o(!1)}},P=()=>{let t=Object.entries(s).filter(([e,t])=>"needs_attention"===t.schoolRating||"urgent_improvement"===t.schoolRating).map(([e])=>e.replace(/-/g," "));return{greeting:`Good morning. I'm the Lead Inspector for today's inspection of ${e.name}. We'll be spending 1-2 days looking at the quality of education, behaviour and attitudes, personal development, and leadership. Let's start with some questions.`,questions:[{id:"1",category:"Leadership",question:"What's your vision for education at this school, and how do you ensure all staff share it?",context:"Inspectors assess whether leaders have high ambitions and a clear vision.",followUps:["How do you communicate this vision to new staff?","Can you give an example of how this vision influenced a recent decision?"],expectedEvidence:["Vision statement","Staff meeting minutes","CPD plan"],redFlags:["Vague responses","Disconnect between stated vision and practice"]},{id:"2",category:"Curriculum",question:"Talk me through how you've designed the curriculum in [subject]. What are the key concepts pupils must learn?",context:"Deep dives examine curriculum intent and implementation.",followUps:["How does this build on what pupils learned previously?","What do pupils find most challenging and how do you address this?"],expectedEvidence:["Curriculum map","Lesson sequences","Assessment examples"],redFlags:["No clear rationale","Content-heavy without skill progression"]},{id:"3",category:"Safeguarding",question:"Tell me about your safeguarding culture. How do staff know what to do if they have a concern?",context:"Safeguarding is always inspected. Culture matters as much as procedures.",followUps:["What training have staff received recently?","Can you walk me through a recent case (anonymised)?"],expectedEvidence:["SCR","Training records","Concern logs","Policy"],redFlags:["Hesitation","Gaps in training","Poor record keeping"]},{id:"4",category:"SEND",question:"How do you identify and support pupils with SEND? What does adaptive teaching look like here?",context:"Inclusion is a central focus of the new framework.",followUps:["How do you ensure SEND pupils access the full curriculum?","What's your relationship with parents of SEND pupils like?"],expectedEvidence:["SEND register","Provision maps","Progress data","EHCPs"],redFlags:["Withdrawal as default","No progress data","Generic provision"]},{id:"5",category:"Behaviour",question:"What are your expectations for behaviour, and how do you ensure consistency across the school?",context:"Behaviour and attitudes are now part of the report card framework.",followUps:["How do you support pupils who struggle with behaviour?","What does your data show about exclusions and suspensions?"],expectedEvidence:["Behaviour policy","Exclusion data","Support plans"],redFlags:["High exclusions","Inconsistent application","No support for struggling pupils"]}],challengeAreas:t.length>0?t:["Consider reviewing curriculum coherence","Ensure SEND evidence is robust"],tips:["Be specific with examples - avoid general statements","Know your data inside out, especially for disadvantaged pupils","Be honest about areas for development - we can see through spin","Have evidence to hand - don't make inspectors wait","Ensure all staff can articulate the vision consistently"],overallReadiness:r>20&&Object.keys(s).length>5?"Good":"Needs more preparation"}},E=async()=>{if(!f.trim())return;let t={role:"user",content:f};b(e=>[...e,t]),y(""),k(!0);try{let a=await fetch("/api/mock-inspector/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[...x,t],persona:h,schoolContext:{...e,assessments:s}})});if(a.ok){let e=await a.json();b(t=>[...t,{role:"inspector",content:e.response}])}else b(e=>[...e,{role:"inspector",content:"Thank you for that response. Can you tell me more about how you monitor the impact of your actions? I'd like to understand the evidence you use to measure success."}])}catch{b(e=>[...e,{role:"inspector",content:"Interesting. Now, let's talk about how you support your disadvantaged pupils specifically. What strategies have you implemented this year?"}])}finally{k(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-slate-700 to-slate-900 rounded-2xl p-6 text-white",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)(p.Search,{className:"w-8 h-8"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Mock Inspector"})]}),(0,t.jsx)("p",{className:"text-slate-300",children:"Prepare for inspection with AI-powered practice scenarios"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[(0,t.jsx)("h2",{className:"font-semibold text-gray-900 mb-4",children:"Select Inspector Persona"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:S.map(e=>(0,t.jsxs)("button",{onClick:()=>g(e.id),className:`p-4 rounded-xl text-left transition-all ${h===e.id?"bg-slate-100 border-2 border-slate-500":"bg-gray-50 border border-gray-200 hover:bg-gray-100"}`,children:[(0,t.jsx)(e.icon,{className:`w-6 h-6 mb-2 ${h===e.id?"text-slate-700":"text-gray-400"}`}),(0,t.jsx)("h3",{className:"font-medium text-sm",children:e.name}),(0,t.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.focus})]},e.id))}),(0,t.jsx)("button",{onClick:C,disabled:n,className:"mt-4 px-6 py-3 bg-slate-800 text-white font-semibold rounded-lg hover:bg-slate-900 transition-colors flex items-center gap-2 disabled:opacity-50",children:n?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eI.Loader2,{className:"w-5 h-5 animate-spin"})," Preparing..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(p.Search,{className:"w-5 h-5"})," Start Mock Inspection"]})})]}),d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:"p-3 bg-slate-100 rounded-full",children:(0,t.jsx)(p.Search,{className:"w-6 h-6 text-slate-700"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:"Inspector Opening"}),(0,t.jsxs)("p",{className:"text-gray-700 italic",children:['"',d.greeting,'"']})]})]})}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 border-b bg-gray-50",children:[(0,t.jsx)("h2",{className:"font-semibold text-gray-900",children:"Likely Questions"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Click to expand and see follow-ups, expected evidence, and red flags"})]}),(0,t.jsx)("div",{className:"divide-y",children:d.questions.map(e=>(0,t.jsxs)("div",{className:"p-4",children:[(0,t.jsxs)("button",{onClick:()=>u(m===e.id?null:e.id),className:"w-full flex items-start gap-3 text-left",children:[(0,t.jsx)("div",{className:`p-2 rounded-lg ${m===e.id?"bg-slate-100":"bg-gray-100"}`,children:(e=>{switch(e.toLowerCase()){case"leadership":return(0,t.jsx)(G.Target,{className:"w-5 h-5"});case"curriculum":return(0,t.jsx)(l.BookOpen,{className:"w-5 h-5"});case"safeguarding":return(0,t.jsx)(eM.Shield,{className:"w-5 h-5"});case"send":return(0,t.jsx)(ep.Users,{className:"w-5 h-5"});case"behaviour":return(0,t.jsx)(R.TrendingUp,{className:"w-5 h-5"});default:return(0,t.jsx)(td,{className:"w-5 h-5"})}})(e.category)}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,t.jsx)("span",{className:"text-xs font-medium px-2 py-0.5 bg-gray-200 rounded",children:e.category})}),(0,t.jsx)("p",{className:"font-medium text-gray-900",children:e.question})]}),m===e.id?(0,t.jsx)(v.ChevronDown,{className:"w-5 h-5 text-gray-400"}):(0,t.jsx)(eV.ChevronRight,{className:"w-5 h-5 text-gray-400"})]}),m===e.id&&(0,t.jsxs)("div",{className:"mt-4 pl-14 space-y-4",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-50 rounded-lg",children:(0,t.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,t.jsx)("strong",{children:"Context:"})," ",e.context]})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-gray-700 mb-2",children:"Likely Follow-ups:"}),(0,t.jsx)("ul",{className:"space-y-1",children:e.followUps.map((e,s)=>(0,t.jsxs)("li",{className:"text-sm text-gray-600 flex items-start gap-2",children:[(0,t.jsx)(eV.ChevronRight,{className:"w-4 h-4 mt-0.5"}),e]},s))})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-green-800 mb-2",children:"Expected Evidence"}),(0,t.jsx)("ul",{className:"space-y-1",children:e.expectedEvidence.map((e,s)=>(0,t.jsxs)("li",{className:"text-sm text-green-700 flex items-center gap-2",children:[(0,t.jsx)(w.CheckCircle,{className:"w-4 h-4"}),e]},s))})]}),(0,t.jsxs)("div",{className:"p-3 bg-red-50 rounded-lg",children:[(0,t.jsx)("h4",{className:"font-medium text-sm text-red-800 mb-2",children:"Red Flags"}),(0,t.jsx)("ul",{className:"space-y-1",children:e.redFlags.map((e,s)=>(0,t.jsxs)("li",{className:"text-sm text-red-700 flex items-center gap-2",children:[(0,t.jsx)(j.AlertTriangle,{className:"w-4 h-4"}),e]},s))})]})]})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border overflow-hidden",children:[(0,t.jsx)("div",{className:"p-4 border-b bg-gray-50",children:(0,t.jsxs)("h2",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[(0,t.jsx)(O.MessageSquare,{className:"w-5 h-5"})," Practice Conversation"]})}),(0,t.jsxs)("div",{className:"h-64 overflow-y-auto p-4 space-y-4",children:[0===x.length&&(0,t.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,t.jsx)(O.MessageSquare,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),(0,t.jsx)("p",{children:"Start a practice conversation with the inspector"})]}),x.map((e,s)=>(0,t.jsx)("div",{className:`flex ${"user"===e.role?"justify-end":"justify-start"}`,children:(0,t.jsx)("div",{className:`max-w-[70%] p-3 rounded-lg ${"user"===e.role?"bg-blue-500 text-white":"bg-gray-100 text-gray-800"}`,children:(0,t.jsx)("p",{className:"text-sm",children:e.content})})},s)),N&&(0,t.jsx)("div",{className:"flex justify-start",children:(0,t.jsx)("div",{className:"bg-gray-100 p-3 rounded-lg",children:(0,t.jsx)(eI.Loader2,{className:"w-5 h-5 animate-spin text-gray-500"})})})]}),(0,t.jsxs)("div",{className:"p-4 border-t flex gap-2",children:[(0,t.jsx)("input",{type:"text",value:f,onChange:e=>y(e.target.value),onKeyPress:e=>"Enter"===e.key&&E(),placeholder:"Practice your response...",className:"flex-1 px-4 py-2 border rounded-lg"}),(0,t.jsx)("button",{onClick:E,disabled:N||!f.trim(),className:"px-4 py-2 bg-slate-800 text-white rounded-lg disabled:opacity-50",children:"Send"})]})]}),(0,t.jsxs)("div",{className:"bg-amber-50 rounded-xl border border-amber-200 p-6",children:[(0,t.jsx)("h3",{className:"font-semibold text-amber-900 mb-3",children:"ðŸ’¡ Top Tips for Inspection Day"}),(0,t.jsx)("ul",{className:"space-y-2",children:d.tips.map((e,s)=>(0,t.jsxs)("li",{className:"text-sm text-amber-800 flex items-start gap-2",children:[(0,t.jsx)(w.CheckCircle,{className:"w-4 h-4 mt-0.5"}),e]},s))})]})]})]})},tm=[{id:"metacognition",name:"Metacognition and Self-Regulation",category:"high_impact",impactMonths:7,costRating:1,evidenceStrength:"extensive",description:"Teaching pupils specific strategies to plan, monitor and evaluate their learning.",implementation:["Explicitly teach metacognitive strategies","Model thinking processes (think aloud)","Encourage pupils to plan their approach","Provide opportunities for self-assessment","Give structured feedback on strategies used"],considerations:["Takes time to embed - expect 6+ months for impact","Needs consistent approach across all subjects","Staff CPD is essential for success","Works best when combined with subject-specific strategies"],ofstedLinks:["curriculum-implementation","achievement-progress"],siamsLinks:["wisdom","character"]},{id:"reading-comprehension",name:"Reading Comprehension Strategies",category:"high_impact",impactMonths:6,costRating:1,evidenceStrength:"extensive",description:"Teaching specific approaches to help pupils understand what they read.",implementation:["Activate prior knowledge before reading","Teach prediction, questioning, summarising","Use graphic organisers","Reciprocal reading approaches","Explicit vocabulary instruction"],considerations:["Should complement, not replace, decoding instruction","Strategies need to be modelled extensively","Pupils need to practice applying strategies independently","Works across all subjects, not just English"],ofstedLinks:["curriculum-reading","curriculum-implementation","achievement-outcomes"],siamsLinks:["wisdom"]},{id:"feedback",name:"Feedback",category:"high_impact",impactMonths:6,costRating:1,evidenceStrength:"extensive",description:"Information given to pupils about their performance relative to learning goals.",implementation:["Focus on learning objectives, not just task completion","Provide specific, actionable next steps","Give time for pupils to act on feedback","Use verbal feedback as well as written","Ensure feedback is understood by pupil"],considerations:["Quality matters more than quantity","Timing is crucial - not too immediate, not too delayed","Oral feedback can be as effective as written","Feedback should not harm self-esteem"],ofstedLinks:["curriculum-implementation","achievement-progress"],siamsLinks:["wisdom","community"]},{id:"high-quality-tutoring",name:"Small Group Tutoring",category:"high_impact",impactMonths:4,costRating:3,evidenceStrength:"extensive",description:"Intensive teaching in small groups, typically 1:3 or 1:4.",implementation:["Sessions of 30-60 minutes, 3-5 times per week","Trained tutors with subject knowledge","Structured curriculum linked to main teaching","Regular assessment to adapt teaching","6-12 week blocks typically most effective"],considerations:["Quality of tutors is paramount","Must be well-connected to classroom teaching","Works best for reading and maths","Can be delivered by TAs if well-trained"],ofstedLinks:["inclusion-send","inclusion-disadvantaged","achievement-progress"],siamsLinks:["wisdom","community"]},{id:"phonics",name:"Phonics",category:"high_impact",impactMonths:5,costRating:1,evidenceStrength:"extensive",description:"Systematic instruction in the relationship between letters and sounds.",implementation:["Use a DfE validated systematic synthetic phonics programme","Daily sessions with pace and structure","Books matched to phonics stage","Rapid intervention for those falling behind","Consistent approach across early years and KS1"],considerations:["Must be systematic, not incidental","Fidelity to chosen programme is essential","Impact is greatest in Reception and Year 1","Must be combined with comprehension teaching"],ofstedLinks:["curriculum-reading","inclusion-send","achievement-outcomes"],siamsLinks:["wisdom"]},{id:"collaborative-learning",name:"Collaborative Learning",category:"high_impact",impactMonths:5,costRating:1,evidenceStrength:"moderate",description:"Pupils working together on activities or learning tasks in groups.",implementation:["Structured tasks with clear objectives","Mixed ability or similar ability groupings as appropriate","Individual accountability within group","Teach collaboration skills explicitly","Regular reflection on group work"],considerations:["Needs careful planning to avoid social loafing","Competition between groups can be motivating","Younger pupils may need more scaffolding","Group composition matters"],ofstedLinks:["curriculum-implementation","pd-character"],siamsLinks:["community","character"]},{id:"mastery-learning",name:"Mastery Learning",category:"high_impact",impactMonths:5,costRating:1,evidenceStrength:"moderate",description:"Teaching that breaks content into units and requires mastery before progression.",implementation:["Clear learning objectives for each unit","Formative assessment to identify gaps","Corrective activities for those not yet mastered","Additional time for those who need it","Only progress when mastery demonstrated"],considerations:["Can be challenging to implement across whole class","May require flexible grouping","Works well in maths (teaching for mastery)","Need to define what mastery looks like"],ofstedLinks:["curriculum-intent","curriculum-implementation","achievement-progress"],siamsLinks:["wisdom"]},{id:"oral-language",name:"Oral Language Interventions",category:"moderate_impact",impactMonths:6,costRating:2,evidenceStrength:"extensive",description:"Approaches that emphasise the importance of spoken language and verbal interaction.",implementation:["Structured talk activities","Vocabulary instruction","Dialogic teaching approaches","Philosophy for children","Debate and discussion activities"],considerations:["Particularly important for disadvantaged pupils","Needs explicit teaching time","Staff may need training in facilitation","Links closely to reading comprehension"],ofstedLinks:["curriculum-intent","inclusion-disadvantaged","pd-character"],siamsLinks:["wisdom","character"]},{id:"homework-secondary",name:"Homework (Secondary)",category:"moderate_impact",impactMonths:5,costRating:1,evidenceStrength:"moderate",description:"Tasks set by teachers for pupils to complete outside of lessons.",implementation:["Link homework to class learning","Clear expectations and purpose","Regular feedback on homework","Consistent homework policy","Appropriate length and difficulty"],considerations:["Impact is lower for primary-aged pupils","Quality matters more than quantity","Need strategies for pupils without home support","Should not increase teacher workload excessively"],ofstedLinks:["curriculum-implementation","achievement-progress","leadership-engagement"],siamsLinks:["wisdom","community"]},{id:"behaviour-interventions",name:"Behaviour Interventions",category:"moderate_impact",impactMonths:4,costRating:2,evidenceStrength:"moderate",description:"Approaches to reduce low-level disruption and improve learning behaviours.",implementation:["Clear consistent expectations","Positive reinforcement systems","Self-management strategies for pupils","Universal tier 1 approaches for all","Targeted interventions for persistent issues"],considerations:["Prevention is better than reaction","Whole-school consistency is crucial","Staff training and buy-in essential","May need external support for complex needs"],ofstedLinks:["behaviour-conduct","behaviour-attitudes","inclusion-mental-health"],siamsLinks:["community","dignity"]},{id:"parental-engagement",name:"Parental Engagement",category:"moderate_impact",impactMonths:4,costRating:2,evidenceStrength:"moderate",description:"Strategies to engage parents with their children's learning.",implementation:["Home learning activities","Parent workshops on supporting learning","Regular communication about progress","Parents evenings with actionable advice","Removing barriers to engagement"],considerations:["Avoid deficit model - work with parents as partners","Consider hard to reach families","Quality of engagement matters more than quantity","Different strategies for different age groups"],ofstedLinks:["leadership-engagement","inclusion-disadvantaged"],siamsLinks:["community"]},{id:"social-emotional",name:"Social and Emotional Learning",category:"moderate_impact",impactMonths:4,costRating:2,evidenceStrength:"extensive",description:"Approaches that focus on developing pupils' social and emotional skills.",implementation:["Universal SEL curriculum","Explicit teaching of skills","Modelling by staff","Opportunities to practice in real contexts","Targeted support for those who need it"],considerations:["Most effective as whole-school approach","Staff wellbeing supports pupil wellbeing","Takes time to embed - be patient","Link to behaviour and mental health"],ofstedLinks:["pd-character","inclusion-mental-health","behaviour-attitudes"],siamsLinks:["character","community","dignity"]},{id:"early-years",name:"Early Years Interventions",category:"moderate_impact",impactMonths:5,costRating:4,evidenceStrength:"extensive",description:"Approaches focusing on early communication, language and literacy.",implementation:["High-quality early years provision","Communication and language focus","Early literacy activities","Play-based learning","Parent engagement from the start"],considerations:["Earlier investment has longer-term impact","Quality of provision is key","Staff qualifications matter","Transition to formal schooling important"],ofstedLinks:["curriculum-intent","curriculum-reading","inclusion-send"],siamsLinks:["wisdom"]},{id:"one-to-one-tutoring",name:"One to One Tutoring",category:"high_impact",impactMonths:5,costRating:5,evidenceStrength:"extensive",description:"Individual tuition from a qualified teacher or trained tutor.",implementation:["Trained tutors with subject knowledge","Sessions linked to main curriculum","Regular frequency (3+ times per week)","Diagnostic assessment to target gaps","Clear success criteria"],considerations:["High cost means need to target carefully","Teacher tutors most effective but expensive","Can use TAs with appropriate training","Online tutoring can be effective too"],ofstedLinks:["inclusion-send","inclusion-disadvantaged","achievement-progress"],siamsLinks:["wisdom","community"]},{id:"teaching-assistants",name:"Teaching Assistant Interventions",category:"moderate_impact",impactMonths:4,costRating:3,evidenceStrength:"moderate",description:"Using TAs effectively to support learning, especially through interventions.",implementation:["Clear role definition for TAs","High-quality training","Structured intervention programmes","TA leading intervention, not always supporting SEND","Time to plan and feedback with teachers"],considerations:["Proximity to teacher teaching is key","Avoid TAs always supporting lowest attainers","Interventions should supplement not replace","Deploy based on need, not allocation"],ofstedLinks:["inclusion-send","curriculum-implementation"],siamsLinks:["wisdom","community"]},{id:"within-class-grouping",name:"Within-Class Attainment Grouping",category:"low_impact",impactMonths:2,costRating:1,evidenceStrength:"moderate",description:"Grouping pupils by attainment within a class, usually for reading or maths.",implementation:["Keep groups flexible and review regularly","Target teaching at group level","Move pupils between groups as they progress","Avoid labelling groups negatively","Maintain high expectations for all groups"],considerations:["Can lead to lower expectations for lower groups","Need to ensure challenge for all","Social effects of grouping need managing","Works better with flexibility"],ofstedLinks:["curriculum-implementation","inclusion-send"],siamsLinks:["wisdom","dignity"]},{id:"extending-school-time",name:"Extending School Time",category:"low_impact",impactMonths:3,costRating:3,evidenceStrength:"moderate",description:"Additional time in school through longer days, weeks, or holiday programmes.",implementation:["Focus on academic activities not just enrichment","Target pupils who would benefit most","Ensure voluntary attendance where possible","Use time for high-impact activities","Consider staff workload"],considerations:["More time doesn't automatically mean more learning","Quality of additional time matters","Can support disadvantaged pupils specifically","Holiday programmes can prevent summer slide"],ofstedLinks:["achievement-progress","inclusion-disadvantaged","pd-enrichment"],siamsLinks:["wisdom","community"]},{id:"arts-participation",name:"Arts Participation",category:"moderate_impact",impactMonths:3,costRating:3,evidenceStrength:"moderate",description:"Involvement in artistic and creative activities.",implementation:["High-quality arts provision","Links to curriculum where appropriate","Opportunities for performance/exhibition","Access for all pupils","Specialist teaching where possible"],considerations:["Impact on academic outcomes is moderate","Other benefits: confidence, collaboration, creativity","Important part of cultural capital","Should be part of broad curriculum"],ofstedLinks:["pd-enrichment","pd-character","curriculum-intent"],siamsLinks:["wisdom","character","worship"]},{id:"sports-participation",name:"Sports Participation",category:"moderate_impact",impactMonths:2,costRating:3,evidenceStrength:"limited",description:"Physical activity and sport to improve academic outcomes.",implementation:["High-quality PE teaching","Extra-curricular opportunities","Competitive sport options","Links to health and wellbeing","Inclusive activities for all"],considerations:["Academic impact is limited","Many other benefits: health, wellbeing, behaviour","Should be part of broad curriculum offer","Sports Premium should focus on sustainable improvement"],ofstedLinks:["pd-enrichment","behaviour-attitudes","inclusion-mental-health"],siamsLinks:["community","character"]}];function tu(e,t,s,a){let i=[];for(let e of f){let r=Object.entries(t).filter(([t,s])=>t.startsWith(e.id)),n=s.filter(t=>t.categoryId===e.id),o=a.filter(t=>t.categoryId===e.id),l="not_assessed",d=r.map(([e,t])=>t.schoolRating).filter(e=>e&&"not_assessed"!==e);if(d.length>0){let e=d.map(e=>{let t=b[e];return t?.score||0}),t=e.reduce((e,t)=>e+t,0)/e.length;l=t>=4.5?"exceptional":t>=3.5?"strong_standard":t>=2.5?"expected_standard":t>=1.5?"needs_attention":"urgent_improvement"}let c=b[l]?.label||"Not Assessed",m=[],u=[];r.forEach(([e,t])=>{t.schoolRationale&&("exceptional"===t.schoolRating||"strong_standard"===t.schoolRating?m.push(t.schoolRationale):("needs_attention"===t.schoolRating||"urgent_improvement"===t.schoolRating)&&u.push(t.schoolRationale))});let p=`## ${e.name}

`;p+=`**Self-Evaluation Grade: ${c}**

### Context
${e.description}

### Key Strengths
`,m.length>0?m.forEach(e=>{p+=`- ${e}
`}):p+=`_No strengths documented yet. Complete self-assessments to populate._
`,p+=`
### Areas for Development
`,u.length>0?u.forEach(e=>{p+=`- ${e}
`}):"needs_attention"===l||"urgent_improvement"===l?p+=`_Areas for development should be documented for this grade._
`:p+=`_No significant areas for development identified._
`,p+=`
### Evidence Base
${n.length} pieces of evidence identified:
`,n.slice(0,5).forEach(e=>{p+=`- ${e.documentName} (${Math.round(100*e.confidence)}% match)
`}),n.length>5&&(p+=`_...and ${n.length-5} more documents_
`),p+=`
### Actions in Progress
`;let h=o.filter(e=>"completed"!==e.status);h.length>0?h.forEach(e=>{p+=`- ${e.title} (${e.priority} priority, due ${e.dueDate})
`}):p+=`_No current actions for this area._
`,p+="\n",i.push({id:e.id,title:e.name,content:p,status:d.length>0?m.length>0?"complete":"partial":"empty",dataUsed:[`assessments:${r.length}`,`evidence:${n.length}`,`actions:${o.length}`]})}let r=Math.round(i.filter(e=>"complete"===e.status).length/i.length*100),n=[];return i.forEach(e=>{"empty"===e.status&&n.push(`No assessment data for ${e.title}`)}),{type:"sef",title:`Self-Evaluation Form - ${e.name}`,academicYear:e.academicYear,generatedAt:new Date().toISOString(),sections:i,metadata:{wordCount:i.reduce((e,t)=>e+t.content.split(/\s+/).length,0),completionPercentage:r,missingData:n}}}function tp(e){let t=`# ${e.title}

`;return t+=`_Academic Year: ${e.academicYear}_
_Generated: ${new Date(e.generatedAt).toLocaleDateString("en-GB")}_

---

`,e.sections.forEach(e=>{t+=e.content+"\n\n"}),t}let th=({schoolData:e,ofstedAssessments:s,siamsAssessments:a,actions:r,evidenceMatches:n,ppData:o,sportsData:d,sdpPriorities:c})=>{let[m,u]=(0,i.useState)(null),[p,g]=(0,i.useState)(!1),[x,b]=(0,i.useState)(null),[y,v]=(0,i.useState)(0),j=[{id:"sef",name:"Self-Evaluation Form (SEF)",description:"Complete SEF aligned to Ofsted 2025 framework",icon:(0,t.jsx)(G.Target,{className:"w-6 h-6"}),estimatedTime:"45 seconds",color:"blue",available:Object.keys(s).length>0},{id:"headteacher",name:"Headteacher Report to Governors",description:"Summary of school performance and priorities",icon:(0,t.jsx)(ep.Users,{className:"w-6 h-6"}),estimatedTime:"60 seconds",color:"purple",available:!0},{id:"pp_strategy",name:"Pupil Premium Strategy",description:"DfE-compliant PP strategy statement",icon:(0,t.jsx)(h.FileSpreadsheet,{className:"w-6 h-6"}),estimatedTime:"30 seconds",color:"green",available:!0},{id:"sports_premium",name:"PE & Sport Premium Report",description:"Spending and impact against 5 key indicators",icon:(0,t.jsx)(R.TrendingUp,{className:"w-6 h-6"}),estimatedTime:"30 seconds",color:"orange",available:!0},{id:"safeguarding",name:"Annual Safeguarding Report",description:"Safeguarding summary for governors",icon:(0,t.jsx)(eM.Shield,{className:"w-6 h-6"}),estimatedTime:"30 seconds",color:"red",available:!0},{id:"sdp",name:"School Development Plan",description:"Strategic priorities and action plans",icon:(0,t.jsx)(P,{className:"w-6 h-6"}),estimatedTime:"60 seconds",color:"teal",available:!0},{id:"quality_of_education",name:"Quality of Education Summary",description:"Deep dive into curriculum and teaching",icon:(0,t.jsx)(l.BookOpen,{className:"w-6 h-6"}),estimatedTime:"45 seconds",color:"indigo",available:Object.keys(s).length>0},{id:"inspection_pack",name:"Inspection Briefing Pack",description:"Everything inspectors will ask for",icon:(0,t.jsx)(N.FileText,{className:"w-6 h-6"}),estimatedTime:"90 seconds",color:"rose",available:Object.keys(s).length>0}],S=async t=>{g(!0),b(null);let a=Date.now();try{let l,m,u,p,h,g,x,y;switch(t){case"sef":l=tu(e,s,n,r);break;case"pp_strategy":l=function(e,t){let s=[],a=t.ppPupils&&t.totalPupils?Math.round(t.ppPupils/t.totalPupils*100):0,i=`## School Overview

`;i+=`| Metric | Data |
|--------|------|
| School name | ${e.name} |
| Number of pupils | ${t.totalPupils||"_Not provided_"} |
| Proportion disadvantaged | ${a}% (${t.ppPupils||0} pupils) |
| Pupil Premium allocation | \xa3${t.allocation?.toLocaleString()||"_Not provided_"} |
`,t.recoveryPremium&&(i+=`| Recovery Premium | \xa3${t.recoveryPremium.toLocaleString()} |
`),i+=`| Academic year | ${e.academicYear} |
| Publish date | ${new Date().toLocaleDateString("en-GB")} |
`,s.push({id:"overview",title:"School Overview",content:i,status:t.totalPupils?"complete":"partial",dataUsed:["totalPupils","ppPupils","allocation"]});let r=`## Disadvantaged Pupil Performance Overview

`;if(t.outcomes){if(r+=`### Academic Outcomes

| Subject | PP % | Non-PP % | National % | Gap |
|---------|------|----------|------------|-----|
`,t.outcomes.reading){let e=t.outcomes.reading.nonPp-t.outcomes.reading.pp;r+=`| Reading | ${t.outcomes.reading.pp}% | ${t.outcomes.reading.nonPp}% | ${t.outcomes.reading.national}% | ${e>0?"-":"+"}${Math.abs(e)}pp |
`}if(t.outcomes.writing){let e=t.outcomes.writing.nonPp-t.outcomes.writing.pp;r+=`| Writing | ${t.outcomes.writing.pp}% | ${t.outcomes.writing.nonPp}% | ${t.outcomes.writing.national}% | ${e>0?"-":"+"}${Math.abs(e)}pp |
`}if(t.outcomes.maths){let e=t.outcomes.maths.nonPp-t.outcomes.maths.pp;r+=`| Maths | ${t.outcomes.maths.pp}% | ${t.outcomes.maths.nonPp}% | ${t.outcomes.maths.national}% | ${e>0?"-":"+"}${Math.abs(e)}pp |
`}}r+=`
### Attendance

| Metric | PP | Non-PP | Gap |
|--------|----|---------| ----|
| Overall attendance | ${t.attendance?.pp||"_"}% | ${t.attendance?.nonPp||"_"}% | ${t.attendance?.pp&&t.attendance?.nonPp?`${(t.attendance.nonPp-t.attendance.pp).toFixed(1)}pp`:"_"} |
| Persistent absence | ${t.attendance?.ppPersistentAbsence||"_"}% | - | - |
`,s.push({id:"profile",title:"Disadvantaged Pupil Performance",content:r,status:t.outcomes?"complete":"empty",dataUsed:["outcomes","attendance"]});let n=`## Barriers to Learning

`;for(let e of(n+=`The key barriers our disadvantaged pupils face are:

`,t.barriers&&t.barriers.length>0?t.barriers.forEach((e,t)=>{n+=`### Barrier ${t+1}: ${e.description}
_Category: ${e.category}_

`}):n+=`_Barriers have not yet been identified. This should be completed based on assessment data, pupil voice, and staff knowledge._
`,s.push({id:"barriers",title:"Barriers to Learning",content:n,status:t.barriers?.length>0?"complete":"empty",dataUsed:["barriers"]}),[1,2,3])){let a=1===e?"Teaching (Tier 1)":2===e?"Targeted Academic Support (Tier 2)":"Wider Strategies (Tier 3)",i=1===e?"High-quality teaching for all pupils, including disadvantaged":2===e?"Targeted interventions and small group tuition":"Non-academic barriers including attendance and wellbeing",r=`## ${a}

`;r+=`_${i}_

`;let n=t.spending?.filter(t=>t.tier===e)||[],o=n.reduce((e,t)=>e+t.cost,0);n.length>0?(r+=`| Activity | Cost | EEF Evidence | Barriers Addressed | Intended Outcomes |
|----------|------|--------------|-------------------|-------------------|
`,n.forEach(e=>{let t=e.eefStrategyId?tm.find(t=>t.id===e.eefStrategyId):null,s=t?`+${t.impactMonths} months`:"_Custom_";r+=`| ${e.activity} | \xa3${e.cost.toLocaleString()} | ${s} | ${e.barrierIds.join(", ")} | ${e.intendedOutcomes} |
`}),r+=`
**Tier ${e} Total: \xa3${o.toLocaleString()}**
`):r+=`_No spending allocated to Tier ${e} yet._
`,s.push({id:`tier-${e}`,title:a,content:r,status:n.length>0?"complete":"empty",dataUsed:[`tier${e}Spending`]})}let o=`## Review of Previous Academic Year

`;t.previousYearReview?(o+=`### What Worked Well
`,t.previousYearReview.whatWorked.forEach(e=>{o+=`- ${e}
`}),o+=`
### What Didn't Work
`,t.previousYearReview.whatDidntWork.forEach(e=>{o+=`- ${e}
`}),o+=`
### Lessons Learned
`,o+=t.previousYearReview.lessonsLearned):o+=`_Previous year review not yet completed._
`,s.push({id:"review",title:"Review of Previous Year",content:o,status:t.previousYearReview?"complete":"empty",dataUsed:["previousYearReview"]});let l=s.filter(e=>"complete"===e.status).length,d=[];return s.forEach(e=>{"empty"===e.status&&d.push(`Missing: ${e.title}`)}),{type:"pp_strategy",title:`Pupil Premium Strategy Statement - ${e.name}`,academicYear:e.academicYear,generatedAt:new Date().toISOString(),sections:s,metadata:{wordCount:s.reduce((e,t)=>e+t.content.split(/\s+/).length,0),completionPercentage:Math.round(l/s.length*100),missingData:d}}}(e,o||{totalPupils:200,ppPupils:40,allocation:52e3,barriers:[{id:"1",description:"Lower reading attainment on entry",category:"academic"},{id:"2",description:"Limited vocabulary",category:"academic"},{id:"3",description:"Lower attendance rates",category:"attendance"}],outcomes:{reading:{pp:65,nonPp:78,national:73},writing:{pp:60,nonPp:75,national:71},maths:{pp:68,nonPp:80,national:73}},attendance:{pp:93.5,nonPp:96.2,ppPersistentAbsence:18},spending:[]});break;case"sports_premium":l=function(e,t){let s=[],a={1:"Engagement of all pupils in regular physical activity",2:"Profile of PESSPA raised across school",3:"Increased confidence, knowledge and skills of all staff",4:"Broader experience of a range of sports and activities",5:"Increased participation in competitive sport"},i=`## Funding Overview

`;i+=`| | Amount |
|--|--------|
| Total amount allocated | \xa3${t.allocation?.toLocaleString()||"_Not set_"} |
| Carried forward from previous year | \xa3${t.carriedForward?.toLocaleString()||"0"} |
| **Total available** | **\xa3${((t.allocation||0)+(t.carriedForward||0)).toLocaleString()}** |
`,s.push({id:"funding",title:"Funding Overview",content:i,status:t.allocation?"complete":"empty",dataUsed:["allocation","carriedForward"]});let r=`## Swimming Data (Year 6)

`;r+=`_Meeting national curriculum requirements for swimming and water safety_

| Criteria | % Meeting |
|----------|-----------|| Swim competently over 25 metres | ${t.swimming?.percentage25m||"_"}% |
| Use a range of strokes effectively | ${t.swimming?.percentageStrokes||"_"}% |
| Perform safe self-rescue | ${t.swimming?.percentageRescue||"_"}% |
`,s.push({id:"swimming",title:"Swimming Data",content:r,status:t.swimming?.percentage25m?"complete":"empty",dataUsed:["swimming"]});for(let e=1;e<=5;e++){let i=t.spending?.filter(t=>t.keyIndicator===e)||[],r=i.reduce((e,t)=>e+t.cost,0),n=`## Key Indicator ${e}

`;n+=`**${a[e]}**

`,i.length>0?(n+=`| Activity | Cost | Impact | Sustainable? |
|----------|------|--------|-------------|
`,i.forEach(e=>{n+=`| ${e.activity} | \xa3${e.cost.toLocaleString()} | ${e.actualImpact||e.intendedImpact} | ${e.isSustainable?"âœ“":"âœ—"} |
`}),n+=`
**Key Indicator ${e} Total: \xa3${r.toLocaleString()}**
`):n+=`_No spending allocated to this key indicator._
`,s.push({id:`ki-${e}`,title:`Key Indicator ${e}`,content:n,status:i.length>0?"complete":"empty",dataUsed:[`keyIndicator${e}`]})}let n=s.filter(e=>"complete"===e.status).length,o=[];return s.forEach(e=>{"empty"===e.status&&o.push(`Missing: ${e.title}`)}),{type:"sports_premium",title:`PE and Sport Premium Report - ${e.name}`,academicYear:e.academicYear,generatedAt:new Date().toISOString(),sections:s,metadata:{wordCount:s.reduce((e,t)=>e+t.content.split(/\s+/).length,0),completionPercentage:Math.round(n/s.length*100),missingData:o}}}(e,d||{allocation:19e3,carriedForward:2e3,swimming:{percentage25m:82,percentageStrokes:78,percentageRescue:85},spending:[]});break;case"sdp":var i;i=c||[{number:1,title:"Improve reading outcomes for disadvantaged pupils",description:"Focus on phonics, reading fluency and comprehension",rationale:"PP reading outcomes are below national average",ofstedCategoryId:"curriculum-teaching",leadPerson:"Deputy Head",successCriteria:["PP reading outcomes improve by 10%","Gap with non-PP reduces by 5pp"],allocatedBudget:15e3,milestones:[{title:"Staff training complete",targetTerm:"autumn1",status:"completed"},{title:"New resources in place",targetTerm:"autumn2",status:"in_progress"}]}],m=[],u=`## School Context

### Vision and Values
_[School vision statement should be inserted here]_

### Current Position
Based on self-evaluation, key strengths and areas for development are:

`,p=[],h=[],Object.entries(s).forEach(([e,t])=>{"exceptional"===t.schoolRating||"strong_standard"===t.schoolRating?t.schoolRationale&&p.push(t.schoolRationale):("needs_attention"===t.schoolRating||"urgent_improvement"===t.schoolRating)&&t.schoolRationale&&h.push(t.schoolRationale)}),u+=`**Strengths:**
`,p.slice(0,5).forEach(e=>u+=`- ${e}
`),0===p.length&&(u+=`_Complete self-evaluation to populate_
`),u+=`
**Areas for Development:**
`,h.slice(0,5).forEach(e=>u+=`- ${e}
`),0===h.length&&(u+=`_Complete self-evaluation to populate_
`),m.push({id:"context",title:"School Context",content:u,status:p.length>0||h.length>0?"partial":"empty",dataUsed:["assessments"]}),g=`## Strategic Priorities ${e.academicYear}

| # | Priority | Lead | Ofsted Link | Budget |
|---|----------|------|-------------|--------|
`,i.forEach(e=>{let t=e.ofstedCategoryId&&f.find(t=>t.id===e.ofstedCategoryId)?.name||"-";g+=`| ${e.number} | ${e.title} | ${e.leadPerson} | ${t} | \xa3${(e.allocatedBudget||0).toLocaleString()} |
`}),m.push({id:"summary",title:"Strategic Priorities Summary",content:g,status:i.length>0?"complete":"empty",dataUsed:["priorities"]}),i.forEach(e=>{let t=`## Priority ${e.number}: ${e.title}

`;t+=`### Rationale
${e.rationale||"_Not provided_"}

### Success Criteria
`,e.successCriteria&&e.successCriteria.length>0?e.successCriteria.forEach(e=>{t+=`- ${e}
`}):t+=`_Success criteria not defined_
`,t+=`
### Milestones
| Milestone | Target | Status |
|-----------|--------|--------|
`,e.milestones&&e.milestones.length>0?e.milestones.forEach(e=>{let s="completed"===e.status?"âœ“":"in_progress"===e.status?"ðŸ”„":"missed"===e.status?"âœ—":"â—‹";t+=`| ${e.title} | ${e.targetTerm} | ${s} ${e.status} |
`}):t+=`| _No milestones defined_ | - | - |
`,m.push({id:`priority-${e.number}`,title:`Priority ${e.number}: ${e.title}`,content:t,status:e.successCriteria?.length>0?"complete":"partial",dataUsed:[`priority${e.number}`]})}),x=m.filter(e=>"complete"===e.status).length,y=[],m.forEach(e=>{"empty"===e.status&&y.push(`Missing: ${e.title}`)}),l={type:"sdp",title:`School Development Plan - ${e.name}`,academicYear:e.academicYear,generatedAt:new Date().toISOString(),sections:m,metadata:{wordCount:m.reduce((e,t)=>e+t.content.split(/\s+/).length,0),completionPercentage:Math.round(x/m.length*100),missingData:y}};break;default:(l=tu(e,s,n,r)).title=`${j.find(e=>e.id===t)?.name||"Report"} - ${e.name}`,l.type=t}let w=Date.now();v((w-a)/1e3),b(l)}catch(e){console.error("Report generation error:",e)}finally{g(!1)}},C=e=>{let t;if(!x)return;let s=new Blob(["markdown"===e?tp(x):(t=`<!DOCTYPE html>
<html>
<head>
    <title>${x.title}</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 900px; margin: 0 auto; padding: 20px; }
        h1 { color: #1a365d; }
        h2 { color: #2d4a6f; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px; margin-top: 32px; }
        h3 { color: #4a5568; }
        table { border-collapse: collapse; width: 100%; margin: 16px 0; }
        th, td { border: 1px solid #e2e8f0; padding: 8px 12px; text-align: left; }
        th { background: #f7fafc; }
        .meta { color: #718096; font-size: 14px; }
    </style>
</head>
<body>
    <h1>${x.title}</h1>
    <p class="meta">Academic Year: ${x.academicYear} | Generated: ${new Date(x.generatedAt).toLocaleDateString("en-GB")}</p>
    <hr>
`,x.sections.forEach(e=>{let s=e.content.replace(/^## (.*$)/gm,"<h2>$1</h2>").replace(/^### (.*$)/gm,"<h3>$1</h3>").replace(/^\*\*(.*)\*\*$/gm,"<strong>$1</strong>").replace(/\|(.*)\|/g,e=>"<tr>"+e.split("|").filter(e=>e.trim()).map(e=>`<td>${e.trim()}</td>`).join("")+"</tr>").replace(/^- (.*)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>)/s,"<ul>$1</ul>").replace(/\n/g,"<br>");t+=s}),t+="</body></html>")],{type:"markdown"===e?"text/markdown":"text/html"}),a=URL.createObjectURL(s),i=document.createElement("a");i.href=a,i.download=`${x.title.replace(/[^a-z0-9]/gi,"_")}.${"markdown"===e?"md":"html"}`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"bg-gradient-to-r from-emerald-600 to-teal-600 rounded-2xl p-6 text-white shadow-lg",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)(N.FileText,{className:"w-8 h-8"}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"One-Click Report Generator"})]}),(0,t.jsx)("p",{className:"text-emerald-100",children:"Generate inspection-ready documents in seconds using your school's data"})]}),(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,t.jsx)("h2",{className:"font-semibold text-gray-900 mb-4",children:"Select Report Type"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:j.map(e=>{var s,a;let i,r;return(0,t.jsxs)("button",{onClick:()=>u(e.id),disabled:!e.available,className:`p-4 rounded-xl text-left transition-all ${(s=e.color,a=m===e.id,r=(i={blue:{bg:"bg-blue-50",border:"border-blue-500",text:"text-blue-700",hover:"hover:bg-blue-100"},purple:{bg:"bg-purple-50",border:"border-purple-500",text:"text-purple-700",hover:"hover:bg-purple-100"},green:{bg:"bg-green-50",border:"border-green-500",text:"text-green-700",hover:"hover:bg-green-100"},orange:{bg:"bg-orange-50",border:"border-orange-500",text:"text-orange-700",hover:"hover:bg-orange-100"},red:{bg:"bg-red-50",border:"border-red-500",text:"text-red-700",hover:"hover:bg-red-100"},teal:{bg:"bg-teal-50",border:"border-teal-500",text:"text-teal-700",hover:"hover:bg-teal-100"},indigo:{bg:"bg-indigo-50",border:"border-indigo-500",text:"text-indigo-700",hover:"hover:bg-indigo-100"},rose:{bg:"bg-rose-50",border:"border-rose-500",text:"text-rose-700",hover:"hover:bg-rose-100"}})[s]||i.blue,a?`${r.bg} border-2 ${r.border} ${r.text}`:`bg-white border border-gray-200 text-gray-700 ${r.hover}`)} ${!e.available?"opacity-50 cursor-not-allowed":"cursor-pointer hover:shadow-md"}`,children:[(0,t.jsx)("div",{className:`p-2 rounded-lg inline-block mb-3 ${m===e.id?"bg-white/50":"bg-gray-100"}`,children:e.icon}),(0,t.jsx)("h3",{className:"font-semibold text-sm mb-1",children:e.name}),(0,t.jsx)("p",{className:"text-xs opacity-75 mb-2",children:e.description}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs opacity-60",children:[(0,t.jsx)(z.Clock,{className:"w-3 h-3"}),(0,t.jsx)("span",{children:e.estimatedTime})]})]},e.id)})})]}),m&&(0,t.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:j.find(e=>e.id===m)?.name}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Data sources: Assessments, Actions, Evidence"})]}),(0,t.jsx)("button",{onClick:()=>S(m),disabled:p,className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-500 text-white font-semibold rounded-lg hover:from-emerald-600 hover:to-teal-600 transition-all disabled:opacity-50 flex items-center gap-2 shadow-md",children:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eI.Loader2,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.RefreshCw,{className:"w-5 h-5"}),"Generate Report"]})})]})}),x&&(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(w.CheckCircle,{className:"w-5 h-5 text-green-500"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:x.title}),(0,t.jsxs)("p",{className:"text-xs text-gray-500",children:["Generated in ",y.toFixed(1),"s â€¢ ",x.metadata.wordCount," words â€¢ ",x.metadata.completionPercentage,"% complete"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("button",{onClick:()=>{if(!x)return;let e=tp(x);navigator.clipboard.writeText(e)},className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-gray-100 rounded-lg",title:"Copy to clipboard",children:(0,t.jsx)(eY,{className:"w-5 h-5"})}),(0,t.jsxs)("button",{onClick:()=>C("markdown"),className:"px-4 py-2 bg-white border border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 flex items-center gap-2 text-sm font-medium",children:[(0,t.jsx)(eL.Download,{className:"w-4 h-4"}),"Markdown"]}),(0,t.jsxs)("button",{onClick:()=>C("html"),className:"px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 flex items-center gap-2 text-sm font-medium",children:[(0,t.jsx)(eL.Download,{className:"w-4 h-4"}),"HTML"]})]})]}),x.metadata.missingData.length>0&&(0,t.jsx)("div",{className:"px-4 py-3 bg-yellow-50 border-b border-yellow-200",children:(0,t.jsxs)("p",{className:"text-sm text-yellow-800",children:[(0,t.jsx)("strong",{children:"Note:"})," Some sections are incomplete. Missing: ",x.metadata.missingData.join(", ")]})}),(0,t.jsx)("div",{className:"p-6 max-h-[600px] overflow-y-auto",children:(0,t.jsx)("div",{className:"prose prose-sm max-w-none",children:x.sections.map((e,s)=>(0,t.jsxs)("div",{className:"mb-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:`w-2 h-2 rounded-full ${"complete"===e.status?"bg-green-500":"partial"===e.status?"bg-yellow-500":"bg-gray-300"}`}),(0,t.jsx)("h4",{className:"font-semibold text-gray-900",children:e.title}),(0,t.jsx)("span",{className:`text-xs px-2 py-0.5 rounded ${"complete"===e.status?"bg-green-100 text-green-700":"partial"===e.status?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-500"}`,children:e.status})]}),(0,t.jsxs)("div",{className:"text-sm text-gray-700 whitespace-pre-wrap bg-gray-50 p-4 rounded-lg border border-gray-200",style:{fontFamily:"ui-monospace, monospace"},children:[e.content.substring(0,500),e.content.length>500&&"..."]})]},e.id))})})]})]})};function tg(){let{user:e,loading:r,signOut:b,organization:f}=(0,s.useAuth)(),y=(0,a.useRouter)(),[v,j]=(0,i.useState)("dashboard"),[w,N]=(0,i.useState)([]),[k,S]=(0,i.useState)(!1),[C,P]=(0,i.useState)(""),[E,A]=(0,i.useState)(""),[R,D]=(0,i.useState)({}),[T,I]=(0,i.useState)({}),[$,M]=(0,i.useState)([]),[q,L]=(0,i.useState)(!1),[z,F]=(0,i.useState)(!1),[O,H]=(0,i.useState)([]),[_,U]=(0,i.useState)([]),[B,W]=(0,i.useState)([]),[G,V]=(0,i.useState)({});return((0,i.useEffect)(()=>{r||e||y.push("/login")},[e,r,y]),r||!e)?(0,t.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):(0,t.jsxs)("div",{className:"min-h-screen bg-white relative",children:[(0,t.jsx)(g.default,{text:"Improve",opacity:.25,shape:"crane"}),(0,t.jsx)("nav",{className:"relative z-10 border-b border-gray-100 bg-white/95 backdrop-blur-sm overflow-visible",children:(0,t.jsx)("div",{className:"max-w-6xl mx-auto px-6",children:(0,t.jsxs)("div",{className:"flex justify-between h-24 items-center",children:[(0,t.jsx)("div",{className:"flex items-center relative",style:{minHeight:"96px"},children:(0,t.jsxs)("div",{className:"relative z-10 flex items-center justify-center",style:{width:"140px",position:"relative"},children:[(0,t.jsx)("span",{className:"text-2xl font-semibold text-gray-900 whitespace-nowrap",children:"Schoolgle"}),(0,t.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 overflow-visible pointer-events-none",style:{width:300,height:300},children:(0,t.jsx)(x.default,{size:300,showText:!1})})]})}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("span",{className:"text-sm text-gray-500",children:e.email}),(0,t.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-700 font-medium text-sm",children:e.email?.[0].toUpperCase()}),(0,t.jsx)("button",{onClick:()=>b(),className:"text-sm text-gray-500 hover:text-gray-900 font-medium transition-colors",children:"Sign Out"})]})]})})}),(0,t.jsxs)("main",{className:"relative z-10 max-w-6xl mx-auto px-6 py-8",children:[(0,t.jsx)("div",{className:"mb-8 border-b border-gray-100",children:(0,t.jsxs)("nav",{className:"-mb-px flex space-x-6 overflow-x-auto",children:[(0,t.jsxs)("button",{onClick:()=>j("dashboard"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"dashboard"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(n,{size:16}),"Dashboard"]}),(0,t.jsxs)("button",{onClick:()=>j("ofsted"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"ofsted"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(o.FileCheck,{size:16}),"Ofsted Framework"]}),(0,t.jsxs)("button",{onClick:()=>j("siams"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"siams"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(l.BookOpen,{size:16}),"SIAMS Framework"]}),(0,t.jsxs)("button",{onClick:()=>j("actions"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"actions"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(d.CheckSquare,{size:16}),"Action Plan"]}),(0,t.jsxs)("button",{onClick:()=>j("voice"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"voice"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(u.Mic,{size:16}),"Voice"]}),(0,t.jsxs)("button",{onClick:()=>j("reports"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"reports"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(h.FileSpreadsheet,{size:16}),"Reports"]}),(0,t.jsxs)("button",{onClick:()=>j("inspector"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"inspector"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(p.Search,{size:16}),"Mock Inspector"]}),(0,t.jsxs)("button",{onClick:()=>j("settings"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center gap-2 transition-colors whitespace-nowrap ${"settings"===v?"border-gray-900 text-gray-900":"border-transparent text-gray-400 hover:text-gray-600"}`,children:[(0,t.jsx)(c.Settings,{size:16}),"Settings"]})]})}),"dashboard"===v&&(0,t.jsx)(ts,{organizationId:f?.id,ofstedAssessments:R,siamsAssessments:T,actions:Object.values({...R,...T}).flatMap(e=>e?.actions||[]),evidenceCount:B.length,isChurchSchool:!0,onNavigate:e=>j(e)}),"ofsted"===v&&(0,t.jsx)(eo,{assessments:R,setAssessments:D,localEvidence:G}),"siams"===v&&(0,t.jsx)(ef,{assessments:T,setAssessments:I,localEvidence:G}),"actions"===v&&(0,t.jsx)(eR,{actions:Object.values({...R,...T}).flatMap(e=>e?.actions||[]),onUpdateAction:e=>{console.log("Action updated:",e)}}),"sef"===v&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Self-Evaluation Form"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Generate inspection-ready documentation"})]}),(0,t.jsxs)("button",{onClick:()=>L(!0),className:"px-4 py-2 bg-violet-600 text-white rounded-lg hover:bg-violet-700 flex items-center gap-2",children:[(0,t.jsx)(m.Eye,{size:18}),"New Observation"]})]}),$.length>0&&(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:[(0,t.jsxs)("h3",{className:"font-semibold text-gray-900 mb-3",children:["Recent Observations (",$.length,")"]}),(0,t.jsx)("div",{className:"space-y-2",children:$.slice(0,5).map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("span",{className:"font-medium text-gray-900",children:e.teacher}),(0,t.jsx)("span",{className:"text-gray-500 mx-2",children:"â€¢"}),(0,t.jsx)("span",{className:"text-gray-600",children:e.subject}),(0,t.jsx)("span",{className:"text-gray-500 mx-2",children:"â€¢"}),(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:e.date})]}),(0,t.jsx)("span",{className:`px-2 py-1 rounded text-xs font-medium ${"outstanding"===e.overallJudgement?"bg-green-100 text-green-700":"good"===e.overallJudgement?"bg-blue-100 text-blue-700":"requires_improvement"===e.overallJudgement?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:e.overallJudgement?.replace("_"," ")})]},s))})]}),(0,t.jsx)(eX,{schoolName:f?.name||"Your School",assessments:R,actions:Object.values({...R,...T}).flatMap(e=>e?.actions||[]),observations:$})]}),"voice"===v&&(0,t.jsx)(tl,{onSaveObservation:e=>{M(t=>[...t,e]),console.log("Voice observation saved:",e)}}),"reports"===v&&(0,t.jsx)(th,{schoolData:{name:f?.name||"Your School",academicYear:"2024-2025",isChurchSchool:!0},ofstedAssessments:R,siamsAssessments:T,actions:Object.values({...R,...T}).flatMap(e=>e?.actions||[]),evidenceMatches:B}),"inspector"===v&&(0,t.jsx)(tc,{schoolData:{name:f?.name||"Your School",phase:"Primary"},ofstedAssessments:R,actions:Object.values({...R,...T}).flatMap(e=>e?.actions||[]),evidenceCount:B.length}),"settings"===v&&(0,t.jsx)(eO,{})]}),(0,t.jsx)(e5,{isOpen:q,onClose:()=>L(!1),onSave:e=>{M(t=>[...t,e]),console.log("Observation saved:",e)},currentUser:{id:e?.uid||"",name:e?.displayName||e?.email||""}}),z&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,t.jsx)("div",{className:"max-w-2xl w-full",children:(0,t.jsx)(e9,{onScanComplete:e=>{H(e),console.log("Local scan complete:",e.length,"files")},onAnalysisComplete:e=>{console.log("Evidence analysis complete:",e),W(e.allMatches||[]),V(e.matchesByArea||{})},onClose:()=>F(!1)})})}),(0,t.jsx)(eG,{context:{schoolName:f?.name,currentView:v,topic:"ofsted"===v?"ofsted framework inspection":"siams"===v?"siams church school inspection":"actions"===v?"school improvement actions":void 0}})]})}e.s(["default",()=>tg],34702)}]);