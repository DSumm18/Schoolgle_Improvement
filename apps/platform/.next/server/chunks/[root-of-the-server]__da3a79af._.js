module.exports=[18622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},93695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},77962,e=>{"use strict";var t=e.i(47909),r=e.i(74017),n=e.i(96250),a=e.i(59756),o=e.i(61916),s=e.i(14444),i=e.i(10680),l=e.i(69741),p=e.i(16795),c=e.i(87718),u=e.i(95169),d=e.i(32084),h=e.i(66012),m=e.i(70101),v=e.i(26937),g=e.i(10372),x=e.i(93695);e.i(52474);var f=e.i(5232),R=e.i(89171);async function y(e){try{let{messages:t,persona:r,schoolContext:n}=await e.json(),a=process.env.OPENROUTER_API_KEY||process.env.OPENAI_API_KEY,o=process.env.OPENROUTER_API_KEY?"https://openrouter.ai/api/v1":"https://api.openai.com/v1",s={lead:"Lead Inspector - probing overall effectiveness and leadership",curriculum:"Curriculum Deep Diver - examining subject implementation",safeguarding:"Safeguarding Lead - assessing child protection systems",send:"SEND Specialist - evaluating inclusive practice",eyfs:"EYFS Expert - focusing on early years provision"},i=`You are an Ofsted inspector (${s[r]||s.lead}) conducting a mock inspection.

Your role:
- Ask probing, realistic questions like a real inspector
- Follow up on responses to dig deeper
- Be professional but direct
- Challenge vague answers
- Acknowledge good responses briefly but move on
- Focus on evidence and impact, not just intent

School context: ${JSON.stringify(n)}

Keep responses concise (2-4 sentences). After hearing a response, either:
1. Ask a follow-up question to probe deeper
2. Move to a new topic area
3. Thank them and conclude

Never break character. Never explain you're AI.`;if(a){let e=await fetch(`${o}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,...process.env.OPENROUTER_API_KEY&&{"HTTP-Referer":"https://schoolgle.co.uk","X-Title":"Schoolgle Mock Inspector Chat"}},body:JSON.stringify({model:process.env.OPENROUTER_API_KEY?"openai/gpt-4o":"gpt-4o",messages:[{role:"system",content:i},...t.map(e=>({role:"inspector"===e.role?"assistant":"user",content:e.content}))],temperature:.8,max_tokens:200})});if(e.ok){let t=await e.json();return R.NextResponse.json({response:t.choices[0]?.message?.content})}}let l=["Thank you. Can you tell me more about how you measure the impact of that? What evidence would show me it's working?","Interesting. And specifically for your disadvantaged pupils - how do you ensure they're making the same progress as their peers?","I see. Let's move on to another area. How do your middle leaders drive improvement in their subjects? What accountability is there?","That's helpful context. Now, thinking about behaviour - how consistent is the application of your policy across all staff?","OK. Finally, tell me about professional development here. How do you know the training you provide improves teaching?"],p=Math.min(Math.floor(t.length/2),l.length-1);return R.NextResponse.json({response:l[p]})}catch(e){return console.error("Mock inspector chat error:",e),R.NextResponse.json({error:e.message},{status:500})}}e.s(["POST",()=>y],89861);var w=e.i(89861);let E=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/mock-inspector/chat/route",pathname:"/api/mock-inspector/chat",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/platform/src/app/api/mock-inspector/chat/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:b,workUnitAsyncStorage:k,serverHooks:A}=E;function C(){return(0,n.patchFetch)({workAsyncStorage:b,workUnitAsyncStorage:k})}async function N(e,t,n){E.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let R="/api/mock-inspector/chat/route";R=R.replace(/\/index$/,"")||"/";let y=await E.prepare(e,t,{srcPage:R,multiZoneDraftMode:!1});if(!y)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:w,params:b,nextConfig:k,parsedUrl:A,isDraftMode:C,prerenderManifest:N,routerServerContext:T,isOnDemandRevalidate:O,revalidateOnlyGenerated:P,resolvedPathname:_,clientReferenceManifest:S,serverActionsManifest:j}=y,I=(0,l.normalizeAppPath)(R),q=!!(N.dynamicRoutes[I]||N.routes[_]),M=async()=>((null==T?void 0:T.render404)?await T.render404(e,t,A,!1):t.end("This page could not be found"),null);if(q&&!C){let e=!!N.routes[_],t=N.dynamicRoutes[I];if(t&&!1===t.fallback&&!e){if(k.experimental.adapterPath)return await M();throw new x.NoFallbackError}}let H=null;!q||E.isDev||C||(H="/index"===(H=_)?"/":H);let U=!0===E.isDev||!q,D=q&&!U;j&&S&&(0,s.setReferenceManifestsSingleton)({page:R,clientReferenceManifest:S,serverActionsManifest:j,serverModuleMap:(0,i.createServerModuleMap)({serverActionsManifest:j})});let K=e.method||"GET",$=(0,o.getTracer)(),F=$.getActiveScopeSpan(),L={params:b,prerenderManifest:N,renderOpts:{experimental:{authInterrupts:!!k.experimental.authInterrupts},cacheComponents:!!k.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:k.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>E.onRequestError(e,t,n,T)},sharedContext:{buildId:w}},Y=new p.NodeNextRequest(e),B=new p.NodeNextResponse(t),W=c.NextRequestAdapter.fromNodeNextRequest(Y,(0,c.signalFromNodeResponse)(t));try{let s=async e=>E.handle(W,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=$.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${K} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${K} ${R}`)}),i=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var o,l;let p=async({previousCacheEntry:r})=>{try{if(!i&&O&&P&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let o=await s(a);e.fetchMetrics=L.renderOpts.fetchMetrics;let l=L.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let p=L.renderOpts.collectedTags;if(!q)return await (0,h.sendResponse)(Y,B,o,L.renderOpts.pendingWaitUntil),null;{let e=await o.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(o.headers);p&&(t[g.NEXT_CACHE_TAGS_HEADER]=p),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,n=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:f.CachedRouteKind.APP_ROUTE,status:o.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await E.onRequestError(e,t,{routerKind:"App Router",routePath:R,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:O})},T),t}},c=await E.handleResponse({req:e,nextConfig:k,cacheKey:H,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:N,isRoutePPREnabled:!1,isOnDemandRevalidate:O,revalidateOnlyGenerated:P,responseGenerator:p,waitUntil:n.waitUntil,isMinimalMode:i});if(!q)return null;if((null==c||null==(o=c.value)?void 0:o.kind)!==f.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});i||t.setHeader("x-nextjs-cache",O?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,m.fromNodeOutgoingHttpHeaders)(c.value.headers);return i&&q||u.delete(g.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,v.getCacheControlHeader)(c.cacheControl)),await (0,h.sendResponse)(Y,B,new Response(c.value.body,{headers:u,status:c.value.status||200})),null};F?await l(F):await $.withPropagatedContext(e.headers,()=>$.trace(u.BaseServerSpan.handleRequest,{spanName:`${K} ${R}`,kind:o.SpanKind.SERVER,attributes:{"http.method":K,"http.target":e.url}},l))}catch(t){if(t instanceof x.NoFallbackError||await E.onRequestError(e,t,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:D,isOnDemandRevalidate:O})}),q)throw t;return await (0,h.sendResponse)(Y,B,new Response(null,{status:500})),null}}e.s(["handler",()=>N,"patchFetch",()=>C,"routeModule",()=>E,"serverHooks",()=>A,"workAsyncStorage",()=>b,"workUnitAsyncStorage",()=>k],77962)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__da3a79af._.js.map